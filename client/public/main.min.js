function trace(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.log(t,e)}function traceAndAlert(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];alert(t),console.log(t,e)}var AssetAdapter=function(){function t(){}var e=(__define,t);return p=e.prototype,p.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}var s=t;if(t.prototype&&(s=new t),s instanceof egret.DisplayObject||s instanceof egret.Texture)e.call(i,s,t);else if("string"==typeof t)if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE);else e.call(i,s,t)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["egret.gui.IAssetAdapter"]);var Config=function(){function t(){}var e=(__define,t);return p=e.prototype,t.IsHide=!1,t.System="Windows",t.StageWidth=640,t.StageHeight=800,t.MinStageHeight=585,t.MinStageY=1,t.IsBgTouch=!1,t}();egret.registerClass(Config,"Config");var EgretSDKMgr=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.Init=function(){var t={};t.egretAppId=90052,t.version=2,t.debug=!0;var e=this;nest.core.startup(t,function(t){0==t.result&&e.checkLogin()})},p.checkLogin=function(){trace("正在检查是否已登录..."),0!=data.GameData.playerGuid&&location.reload();var t={};nest.user.checkLogin(t,this.onCheckLoginCallback.bind(this))},p.onCheckLoginCallback=function(t){if(t.token)this.onLoginCallback(t);else{trace("\n正在登录...");var e={};nest.user.login(e,this.onLoginCallback.bind(this))}},p.onLoginCallback=function(t){0==t.result?this.getUserInfo(t,this.onGetUserInfoCallback):trace("登陆失败...")},p.getUserInfo=function(t,e){e.call(this,t)},p.onGetUserInfoCallback=function(t){this.dispatchEvent(new egret.Event(enums.NativeEvent.NATIVEEVENT_GETINITINFO,!1,!1,t))},e._instance=null,e}(egret.EventDispatcher);egret.registerClass(EgretSDKMgr,"EgretSDKMgr");var EntityMgr=function(){function t(){}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),t._instance=null,t}();egret.registerClass(EntityMgr,"EntityMgr");var controller;!function(t){var e;!function(t){var e=function(){function e(){this.FromId=-1,this.Type=t.Types.Types_Error,this.List=[],this.AllArr=[],this.OneArr=[],this.SingleArr=[],this.DoubleArr=[],this.TripleArr=[],this.QuadrupleArr=[]}var i=(__define,e);return p=i.prototype,p.PlaySound=function(){var e,i="",n="_mp3";switch(this.Type){case t.Types.Types_Error:return;case t.Types.Types_Signal:i="woman_",e=this.SingleArr[0];break;case t.Types.Types_Double:i="woman_dui",e=this.DoubleArr[0];break;case t.Types.Types_Three:i="woman_sange";break;case t.Types.Types_Three_Signal:i="woman_sandaiyi";break;case t.Types.Types_Three_Double:i="woman_sandaiyidui";break;case t.Types.Types_Four_Signal:i="woman_sidaier";break;case t.Types.Types_Four_Double:i="woman_sidailiangdui";break;case t.Types.Types_ThreeN:i="woman_feiji";break;case t.Types.Types_ThreeN_Signal:i="woman_feiji";break;case t.Types.Types_ThreeN_Double:i="woman_feiji";break;case t.Types.Types_List:i="woman_shunzi";break;case t.Types.Types_DoubleN:i="woman_liandui";break;case t.Types.Types_Bomb:i="woman_zhadan",this.List.length<3&&(i="woman_wangzha"),SoundMgr.Instance.PlayEffect("bomb_mp3",!0)}var s;s=null==e?i+n:i+e+n,SoundMgr.Instance.PlayEffect(s)},p.HasBigTo=function(t){var e,i=this.List.length,n=0;for(n=0;i>n;n++)if(e=this.List[n],e%100>=t)return!0;return!1},p.HasBomb=function(){return this.getCountOfNum(98)>0&&this.getCountOfNum(99)>0?!0:this.QuadrupleArr.length>0?!0:!1},p.getSingleValueExceptNum=function(t){var e,i=this.AllArr.length,n=t.length,s=[],r=0,a=0,h=!1;for(r=0;i>r;r++){for(e=this.OneArr[r],h=!1,a=0;n>a;a++)e%100==t[a]%100&&(h=!0);0==h&&s.push(e)}return s},p.getDoubleValueExceptNum=function(t){var e,i=this.DoubleArr.concat(this.TripleArr),n=i.length,s=t.length,r=[],a=0,h=0,l=!1;for(a=0;n>a;a++){for(e=i[a],l=!1,h=0;s>h;h++)e%100==t[h]%100&&(l=!0);0==l&&r.push(e)}return r},p.getValueByNum=function(t,e,i){void 0===i&&(i=!1);var n,s=this.List.length,r=0,a=[];for(r=0;s>r;r++)if(n=this.List[r],0==i){if(n%100==t%100&&(a.push(n),e--,0>=e))break}else if(n==t){a.push(n);break}return a},p.ContainList=function(t){if(null==t||null==t.List||t.List.length<1)return!1;var e=t.List,i=this.List.length,n=e.length,s=0,r=0,a=!1;for(r=0;n>r;r++){for(a=!1,s=0;i>s;s++)e[r]==this.List[s]&&(a=!0);if(0==a)return!1}return!0},p.getCountOfNum=function(t){t%=100;var e=this.AllArr.length,i=0,n=0;for(i=0;e>i;i++)this.AllArr[i]==t&&n++;return n},e}();t.CardListData=e,egret.registerClass(e,"controller.game.CardListData")}(e=t.game||(t.game={}))}(controller||(controller={}));var controller;!function(t){var e;!function(t){var e=function(){function e(){}var i=(__define,e);return p=i.prototype,p.IsBiger=function(e,i){if(null==i)return trace("Compare-IsBiger> 没有桌面牌"),!0;if(e.Type!=i.Type&&e.Type!=t.Types.Types_Bomb)return trace("Compare-IsBiger> 类型出错"),!1;switch(e.Type){case t.Types.Types_Signal:return this.compareSigle(e,i);case t.Types.Types_Double:return this.compareDouble(e,i);case t.Types.Types_Three:case t.Types.Types_Three_Signal:case t.Types.Types_Three_Double:return this.compareThree(e,i);case t.Types.Types_Four_Double:case t.Types.Types_Four_Signal:return this.compareFour(e,i);case t.Types.Types_ThreeN:case t.Types.Types_ThreeN_Signal:case t.Types.Types_ThreeN_Double:return this.compareThreeN(e,i);case t.Types.Types_List:return this.compareList(e,i);case t.Types.Types_DoubleN:return this.compareDoubleN(e,i);case t.Types.Types_Bomb:return this.compareBomb(e,i)}},p.compareBomb=function(e,i){if(i.Type!=t.Types.Types_Bomb)return!0;var n,s,r=e.QuadrupleArr.length,a=i.QuadrupleArr.length;return 0==r?!0:0==a?(trace("Compare-IsBiger> 不能大过王炸"),!1):(n=e.QuadrupleArr[0],s=i.QuadrupleArr[0],n>s?!0:!1)},p.compareDoubleN=function(t,e){var i,n,s=t.DoubleArr.length,r=e.DoubleArr.length;return s!=r?(trace("Compare-IsBiger> 连对数量不匹配"),!1):(i=t.DoubleArr[0],n=e.DoubleArr[0],i>n?!0:!1)},p.compareList=function(t,e){var i,n,s=t.SingleArr.length,r=e.SingleArr.length;return s!=r?(trace("Compare-IsBiger> 顺子数量不匹配"),!1):(i=t.SingleArr[0],n=e.SingleArr[0],i>n?!0:!1)},p.compareThreeN=function(t,e){var i,n,s=t.TripleArr.length,r=e.TripleArr.length;return s!=r?(trace("Compare-IsBiger> 飞机数量不匹配"),!1):(i=t.TripleArr[0],n=e.TripleArr[0],i>n?!0:!1)},p.compareFour=function(t,e){var i,n;return i=t.QuadrupleArr[0],n=e.QuadrupleArr[0],i>n?!0:!1},p.compareThree=function(t,e){var i,n;return i=t.TripleArr[0],n=e.TripleArr[0],i>n?!0:!1},p.compareDouble=function(t,e){var i,n;return i=t.DoubleArr[0],n=e.DoubleArr[0],i>n?!0:!1},p.compareSigle=function(t,e){var i,n;return i=t.SingleArr[0],n=e.SingleArr[0],i>n?!0:!1},e}();t.Compare=e,egret.registerClass(e,"controller.game.Compare")}(e=t.game||(t.game={}))}(controller||(controller={}));var controller;!function(t){var e;!function(e){var i=function(){function i(){this._types=new e.Types,this._types=new e.Types}var n=(__define,i);return p=n.prototype,p.GetPrompt=function(e,i,n,s,r,a){if(null==i)return this.getbest(e,n,s,r);var h=this.getMinListByType(e,i.Type,i);if(null!=h&&e.List.length-h.List.length>2&&a)if(h.Type==t.game.Types.Types_Signal){if(h.SingleArr[0]>14)return null}else if(h.Type==t.game.Types.Types_Double){if(h.DoubleArr[0]>14)return null}else if(h.Type==t.game.Types.Types_Bomb)return null;return h},p.GetPromptContain=function(t,e){if(0==t.ContainList(e))return null;var i=[103,104,105,106,107,108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List);return!(null!=n&&0!=n.ContainList(e)||(i=[104,105,106,107,108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108,109,110,111,112,113],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[105,106,107,108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108,109,110,111,112],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[106,107,108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[107,108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108,109,110,111],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108,109,110],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[108,109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108,109],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[109,110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107,108],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[110,111,112,113,114],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[109,110,111,112,113],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[108,109,110,111,112],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[107,108,109,110,111],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[106,107,108,109,110],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[105,106,107,108,109],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[104,105,106,107,108],n=this.getContainList(t,this._types.GetType(i),e.List),null!=n&&0!=n.ContainList(e)||(i=[103,104,105,106,107],!(n=this.getContainList(t,this._types.GetType(i),e.List))))))))))))))))))))))),null==n||0==n.ContainList(e)?null:n},p.getContainList=function(t,e,i){var n=t.OneArr,s=n.length;if(5>s)return null;var r=0,a=0;e&&(r=e.SingleArr[0],a=e.SingleArr.length);var h=0,l=0,o=0,_=0;for(h=0;s>h;h++)if(o=n[h],!(r>o)&&e){for(l=0;a>l;l++){var d=o+l,u=t.getCountOfNum(d);if(1>u||u>3)break;l==a-1&&(_=d)}if(0!=_)break}if(0==_)return null;var c,p=[],g=i.length;for(h=0;a>h;h++){var y=_-h,T=!1;for(l=0;g>l;l++)i[l]%100==y&&(y=i[l],T=!0);c=t.getValueByNum(y,1,T),p=p.concat(c)}var m=this._types.GetType(p);return m},p.getbest=function(t,i,n,s){var r=[e.Types.Types_ThreeN_Signal,e.Types.Types_ThreeN_Double,e.Types.Types_ThreeN,e.Types.Types_DoubleN,e.Types.Types_List,e.Types.Types_Three_Signal,e.Types.Types_Three_Double,e.Types.Types_Three,e.Types.Types_Double,e.Types.Types_Signal,e.Types.Types_Bomb];s?1==i?r=[e.Types.Types_ThreeN_Signal,e.Types.Types_ThreeN_Double,e.Types.Types_ThreeN,e.Types.Types_DoubleN,e.Types.Types_List,e.Types.Types_Three_Signal,e.Types.Types_Three_Double,e.Types.Types_Three,e.Types.Types_Double,e.Types.Types_Bomb,e.Types.Types_Signal]:2==i&&(r=[e.Types.Types_ThreeN_Signal,e.Types.Types_ThreeN_Double,e.Types.Types_ThreeN,e.Types.Types_DoubleN,e.Types.Types_List,e.Types.Types_Three_Signal,e.Types.Types_Three_Double,e.Types.Types_Three,e.Types.Types_Signal,e.Types.Types_Bomb,e.Types.Types_Double]):1==n?r=[e.Types.Types_Signal,e.Types.Types_ThreeN_Signal,e.Types.Types_ThreeN_Double,e.Types.Types_ThreeN,e.Types.Types_DoubleN,e.Types.Types_List,e.Types.Types_Three_Signal,e.Types.Types_Three_Double,e.Types.Types_Three,e.Types.Types_Double,e.Types.Types_Bomb]:2==i&&(r=[e.Types.Types_Double,e.Types.Types_ThreeN_Signal,e.Types.Types_ThreeN_Double,e.Types.Types_ThreeN,e.Types.Types_DoubleN,e.Types.Types_List,e.Types.Types_Three_Signal,e.Types.Types_Three_Double,e.Types.Types_Three,e.Types.Types_Signal,e.Types.Types_Bomb]);var a=0,h=r.length,l=0;for(a=0;h>a;a++){l=r[a];var o=this.getMinListByType(t,l);if(null!=o)return o}return null},p.getMinListByType=function(t,i,n){switch(i){case e.Types.Types_Signal:var s=null;return null==n&&(s=this.getSigleMaxEM(t)),s?s:this.getSigle(t,n);case e.Types.Types_Double:return this.getDouble(t,n);case e.Types.Types_Three:return this.getThree(t,n);case e.Types.Types_Three_Signal:return this.getThree_Signal(t,n);case e.Types.Types_Three_Double:return this.getThree_Double(t,n);case e.Types.Types_Four_Double:return this.getBomb(t,n);case e.Types.Types_Four_Signal:return this.getBomb(t,n);case e.Types.Types_ThreeN:return this.getThreeN(t,n);case e.Types.Types_ThreeN_Signal:return this.getThreeN_Signal(t,n);case e.Types.Types_ThreeN_Double:return this.getThreeN_Double(t,n);case e.Types.Types_List:return this.getList(t,n);case e.Types.Types_DoubleN:return this.getDoubleN(t,n);case e.Types.Types_Bomb:return this.getBomb(t,n)}},p.getBomb=function(t,e){var i=t.QuadrupleArr,n=t.getCountOfNum(99),s=t.getCountOfNum(98),r=i.length;if(1>r&&(1>n||1>s)||e&&2==e.AllArr.length)return null;var a=0;e&&(a=e.QuadrupleArr[0]);var h=0,l=0;for(h=0;r>h&&(l=i[h],!(l>a));h++)l=0;if(l>0){var o=t.getValueByNum(l,4),_=this._types.GetType(o);return _}if(n>0&&s>0){var d=t.getValueByNum(98,1),u=t.getValueByNum(99,1),c=d.concat(u),_=this._types.GetType(c);return _}return null},p.getDoubleN=function(t,e){var i=t.DoubleArr,n=i.length;if(3>n)return null!=e?this.getBomb(t):null;var s=0,r=0,a=10;e&&(s=e.DoubleArr[0],r=e.DoubleArr.length);var h=0,l=0,o=0,_=0,d=0;for(h=0;n>h;h++)if(o=i[h],!(s>=o))if(e){for(l=0;r>l;l++){var u=o+l,c=t.getCountOfNum(u);if(2>c||c>3)break;l==r-1&&(_=u)}if(0!=_)break}else{for(l=0;a>l;l++){var u=o+l,c=t.getCountOfNum(u);if(2>c||c>3)break;r++,r>2&&r>d&&(d=r,_=u)}r=h>=n-1?d:0}if(0==_)return null!=e?this.getBomb(t):null;var p,g=[];for(h=0;r>h;h++)p=t.getValueByNum(_-h,2),g=g.concat(p);var y=this._types.GetType(g);return y},p.getList=function(t,e){var i=t.OneArr,n=i.length;if(5>n)return null!=e?this.getBomb(t):null;var s=0,r=0,a=12;e&&(s=e.SingleArr[0],r=e.SingleArr.length);var h=0,l=0,o=0,_=0,d=0;for(h=0;n>h;h++)if(o=i[h],!(s>=o))if(e){for(l=0;r>l;l++){var u=o+l,c=t.getCountOfNum(u);if(1>c||c>3)break;l==r-1&&(_=u)}if(0!=_)break}else{for(l=0;a>l;l++){var u=o+l,c=t.getCountOfNum(u);if(1>c||c>3)break;r++,r>4&&r>d&&(d=r,_=u)}r=h>=n-1?d:0}if(0==_)return null!=e?this.getBomb(t):null;var p,g=[];for(h=0;r>h;h++)p=t.getValueByNum(_-h,1),g=g.concat(p);var y=this._types.GetType(g);return y},p.getThreeN_Signal=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c;if(!(t.SingleArr.length>1))return null!=e?this.getBomb(t):null;u=t.SingleArr[0],c=t.SingleArr[1];var p,g=t.getValueByNum(u,2),y=t.getValueByNum(c,2),T=[];for(a=0;r>a;a++)p=t.getValueByNum(o-a,3),T=T.concat(p);T=T.concat(g),T=T.concat(y);var m=this._types.GetType(T);return m},p.getThreeN_Double=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c;if(!(t.DoubleArr.length>1))return null!=e?this.getBomb(t):null;u=t.DoubleArr[0],c=t.DoubleArr[1];var p,g=t.getValueByNum(u,2),y=t.getValueByNum(c,2),T=[];for(a=0;r>a;a++)p=t.getValueByNum(o-a,3),T=T.concat(p);T=T.concat(g),T=T.concat(y);var m=this._types.GetType(T);return m},p.getThreeN=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c=[];for(a=0;r>a;a++)u=t.getValueByNum(o-a,3),c=c.concat(u);var p=this._types.GetType(c);return p},p.getThree_Double=function(t,e){var i=t.TripleArr,n=i.length;if(1>n)return null!=e?this.getBomb(t):null;var s=0;e&&(s=e.TripleArr[0]);var r=0,a=0;for(r=0;n>r&&(a=i[r],!(a>s));r++)a=0;if(0==a)return null!=e?this.getBomb(t):null;var h;if(!(t.DoubleArr.length>0))return null!=e?this.getBomb(t):null;h=t.DoubleArr[0];var l=t.getValueByNum(h,2),o=t.getValueByNum(a,3),_=o.concat(l),d=this._types.GetType(_);return d},p.getThree_Signal=function(t,e){var i=t.TripleArr,n=i.length;if(1>n)return null!=e?this.getBomb(t):null;var s=0;e&&(s=e.TripleArr[0]);var r=0,a=0;for(r=0;n>r&&(a=i[r],!(a>s));r++)a=0;if(0==a)return null!=e?this.getBomb(t):null;var h;if(t.SingleArr.length>0)h=t.SingleArr[0];else{if(!(t.DoubleArr.length>0))return null!=e?this.getBomb(t):null;h=t.DoubleArr[0]}var l=t.getValueByNum(h,1),o=t.getValueByNum(a,3),_=o.concat(l),d=this._types.GetType(_);return d},p.getThree=function(t,e){var i=t.TripleArr,n=i.length;if(1>n)return null!=e?this.getBomb(t):null;var s=0;e&&(s=e.TripleArr[0]);var r=0,a=0;for(r=0;n>r&&(a=i[r],!(a>s));r++)a=0;if(0==a)return null!=e?this.getBomb(t):null;var h=t.getValueByNum(a,3),l=this._types.GetType(h);return l},p.getDouble=function(t,e,i){var n=t.DoubleArr;i&&(n=t.TripleArr);var s=n.length;if(1>s)return null!=e?this.getBomb(t):null;var r=0;e&&(r=e.DoubleArr[0]);var a=0,h=0;for(a=0;s>a&&(h=n[a],!(h>r));a++)h=0;if(0==h)return null!=e?this.getBomb(t):null;var l=t.getValueByNum(h,2),o=this._types.GetType(l);return o},p.getSigle=function(t,e,i){var n=t.SingleArr;i&&(n=t.AllArr);var s=n.length;if(1>s)return null!=e?this.getBomb(t):null;var r=0;e&&(r=e.SingleArr[0]);var a=0,h=0;for(a=0;s>a&&(h=n[a],!(h>r));a++)h=0;if(0==h)return null!=e?this.getBomb(t):null;if(98==h&&t.getCountOfNum(99)>0||99==h&&t.getCountOfNum(98)>0)return this.getBomb(t,null);var l=t.getValueByNum(h,1),o=this._types.GetType(l);return o},p.getSigleMaxEM=function(t){if(t.DoubleArr.length>0||t.TripleArr.length>0||t.QuadrupleArr.length>0||t.HasBomb())return null;var e=t.SingleArr,i=e.length;if(1>i)return null;var n=0,s=0,r=0;for(s=0;i>s;s++)r=e[s],r>n&&(n=r);if(0==r)return null;if(r>14)return null;var a=t.getValueByNum(r,1),h=this._types.GetType(a);return h},i}();e.Prompt=i,egret.registerClass(i,"controller.game.Prompt")}(e=t.game||(t.game={}))}(controller||(controller={}));var controller;!function(t){var e;!function(t){var e=function(){function e(){this._types=new t.Types,this._types=new t.Types}var i=(__define,e);return p=i.prototype,p.GetPrompt=function(t,e){return this.getMinListByType(t,e.Type,e)},p.getMinListByType=function(e,i,n){switch(i){case t.Types.Types_Signal:return this.getSigle(e,n);case t.Types.Types_Double:return this.getDouble(e,n);case t.Types.Types_Three:return this.getThree(e,n);case t.Types.Types_Three_Signal:return this.getThree_Signal(e,n);case t.Types.Types_Three_Double:return this.getThree_Double(e,n);case t.Types.Types_Four_Double:return this.getBomb(e,n);case t.Types.Types_Four_Signal:return this.getBomb(e,n);case t.Types.Types_ThreeN:return this.getThreeN(e,n);case t.Types.Types_ThreeN_Signal:return this.getThreeN_Signal(e,n);case t.Types.Types_ThreeN_Double:return this.getThreeN_Double(e,n);case t.Types.Types_List:return this.getList(e,n);case t.Types.Types_DoubleN:return this.getDoubleN(e,n);case t.Types.Types_Bomb:return this.getBomb(e,n)}},p.getBomb=function(t,e){var i=t.QuadrupleArr,n=t.getCountOfNum(99),s=t.getCountOfNum(98),r=i.length;if(1>r&&(1>n||1>s)||e&&2==e.AllArr.length)return null;var a=0;e&&(a=e.QuadrupleArr[0]);var h=0,l=0;for(h=0;r>h&&(l=i[h],!(l>a));h++)l=0;if(l>0){var o=t.getValueByNum(l,4),_=this._types.GetType(o);return _}if(n>0&&s>0){var d=t.getValueByNum(98,1),u=t.getValueByNum(99,1),c=d.concat(u),_=this._types.GetType(c);return _}return null},p.getDoubleN=function(t,e){var i=t.DoubleArr,n=i.length;if(3>n)return null!=e?this.getBomb(t):null;var s=0,r=0,a=10;e&&(s=e.DoubleArr[0],r=e.DoubleArr.length);var h=0,l=0,o=0,_=0,d=0;for(h=0;n>h;h++)if(o=i[h],!(s>=o))if(e){for(l=0;r>l;l++){var u=o+l,c=t.getCountOfNum(u);if(2>c)break;l==r-1&&(_=u)}if(0!=_)break}else{for(l=0;a>l;l++){var u=o+l,c=t.getCountOfNum(u);if(2>c)break;r++,r>2&&r>d&&(d=r,_=u)}r=h>=n-1?d:0}if(0==_)return null!=e?this.getBomb(t):null;var p,g=[];for(h=0;r>h;h++)p=t.getValueByNum(_-h,2),g=g.concat(p);var y=this._types.GetType(g);return y},p.getList=function(t,e){var i=t.OneArr,n=i.length;if(5>n)return null!=e?this.getBomb(t):null;var s=0,r=0,a=12;e&&(s=e.SingleArr[0],r=e.SingleArr.length);var h=0,l=0,o=0,_=0,d=0;for(h=0;n>h;h++)if(o=i[h],!(s>=o))if(e){for(l=0;r>l;l++){var u=o+l,c=t.getCountOfNum(u);if(1>c)break;l==r-1&&(_=u)}if(0!=_)break}else{for(l=0;a>l;l++){var u=o+l,c=t.getCountOfNum(u);if(1>c)break;r++,r>4&&r>d&&(d=r,_=u)}r=h>=n-1?d:0}if(0==_)return null!=e?this.getBomb(t):null;var p,g=[];for(h=0;r>h;h++)p=t.getValueByNum(_-h,1),g=g.concat(p);var y=this._types.GetType(g);return y},p.getThreeN_Signal=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c=[];for(a=0;r>a;a++)u=t.getValueByNum(o-a,3),c=c.concat(u);var p=t.getSingleValueExceptNum(c);if(p.length<r)return null!=e?this.getBomb(t):null;var g=p.slice(0,r);c=c.concat(g);var y=this._types.GetType(c);return y},p.getThreeN_Double=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c=[];for(a=0;r>a;a++)u=t.getValueByNum(o-a,3),c=c.concat(u);var p=t.getDoubleValueExceptNum(c);if(p.length<r)return null!=e?this.getBomb(t):null;var g=p.slice(0,r);c=c.concat(g);var y=this._types.GetType(c);return y},p.getThreeN=function(t,e){var i=t.TripleArr,n=i.length;if(2>n)return null!=e?this.getBomb(t):null;var s=0,r=2;if(e&&(s=e.TripleArr[0],r=e.TripleArr.length),r>n)return null!=e?this.getBomb(t):null;var a=0,h=0,l=0,o=0;for(a=0;n>a;a++)if(l=i[a],!(s>=l)){for(h=0;r>h;h++){var _=l+h,d=t.getCountOfNum(_);if(3>d)break;h==r-1&&(o=_)}if(0!=o)break}if(0==o)return null!=e?this.getBomb(t):null;var u,c=[];for(a=0;r>a;a++)u=t.getValueByNum(o-a,3),c=c.concat(u);var p=this._types.GetType(c);return p},p.getThree_Double=function(t,e){for(var i=t.OneArr,n=[],s=0;s<i.length;s++)t.getCountOfNum(i[s])>2&&n.push(i[s]);var r=n.length;if(1>r)return null!=e?this.getBomb(t):null;var a=0;e&&(a=e.TripleArr[0]);var s=0,h=0;for(s=0;r>s&&(h=n[s],!(h>a));s++)h=0;if(0==h)return null!=e?this.getBomb(t):null;var l=t.getValueByNum(h,3),o=t.getDoubleValueExceptNum(l);if(o.length<1)return null!=e?this.getBomb(t):null;var _=o.slice(0,1);l=l.concat(_);var d=this._types.GetType(l);return d},p.getThree_Signal=function(t,e){for(var i=t.OneArr,n=[],s=0;s<i.length;s++)t.getCountOfNum(i[s])>2&&n.push(i[s]);var r=n.length;if(1>r)return null!=e?this.getBomb(t):null;var a=0;e&&(a=e.TripleArr[0]);var s=0,h=0;for(s=0;r>s&&(h=n[s],!(h>a));s++)h=0;if(0==h)return null!=e?this.getBomb(t):null;var l=t.getValueByNum(h,3),o=t.getSingleValueExceptNum(l);if(o.length<1)return null!=e?this.getBomb(t):null;var _=o.slice(0,1);l=l.concat(_);var d=this._types.GetType(l);return d},p.getThree=function(t,e){for(var i=t.OneArr,n=[],s=0;s<i.length;s++)t.getCountOfNum(i[s])>2&&n.push(i[s]);var r=n.length;if(1>r)return null!=e?this.getBomb(t):null;var a=0;e&&(a=e.TripleArr[0]);var s=0,h=0;for(s=0;r>s&&(h=n[s],!(h>a));s++)h=0;if(0==h)return null!=e?this.getBomb(t):null;var l=t.getValueByNum(h,3),o=this._types.GetType(l);return o},p.getDouble=function(t,e){for(var i=t.OneArr,n=[],s=0;s<i.length;s++)t.getCountOfNum(i[s])>1&&n.push(i[s]);var r=n.length;if(1>r)return null!=e?this.getBomb(t):null;var a=0;e&&(a=e.DoubleArr[0]);var s=0,h=0;for(s=0;r>s&&(h=n[s],!(h>a));s++)h=0;if(0==h)return null!=e?this.getBomb(t):null;var l=t.getValueByNum(h,2),o=this._types.GetType(l);return o},p.getSigle=function(t,e){var i=t.OneArr,n=i.length;if(1>n)return null!=e?this.getBomb(t):null;var s=0;e&&(s=e.SingleArr[0]);var r=0,a=0;for(r=0;n>r&&(a=i[r],!(a>s));r++)a=0;if(0==a)return null!=e?this.getBomb(t):null;var h=t.getValueByNum(a,1),l=this._types.GetType(h);return l},e}();t.Prompt2=e,egret.registerClass(e,"controller.game.Prompt2")}(e=t.game||(t.game={}))}(controller||(controller={}));var controller;!function(t){var e;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,p.GetCardRandom=function(){var e=null,i=[],n=[],s=[],r=[];e=t.CardList.concat(),Math.random()>.5&&(r=this.doBombArr(e),trace("SendCard-GetCardRandom> 有炸弹")),ArrayTools.RandomSort(e);var a=Math.floor(3*Math.random());return this.addplaylist(e,r,i,0==a),this.addplaylist(e,r,n,1==a),this.addplaylist(e,r,s,2==a),[i,n,s,e]},p.addplaylist=function(t,e,i,n){if(n&&e.length>0)for(;e.length>0;)i.push(e.pop());for(;i.length<17;)i.push(t.pop());ArrayTools.RandomSort(i)},p.doBombArr=function(t){{var e=this.getBombArr(),i=0,n=t.length,s=0,r=e.length;4*Math.floor(48*Math.random()/3)}for(i=n-1;i>=0;i--)for(s=0;r>s;s++)if(t[i]==e[s]){t.splice(i,1);break}return e},p.getBombArr=function(){var e=t.ValueList.length,i=Math.floor(Math.random()*e),n=t.ValueList[i],s=[100+n,200+n,300+n,400+n];return s},t.CardList=[103,104,105,106,107,108,109,110,111,112,113,114,120,203,204,205,206,207,208,209,210,211,212,213,214,220,303,304,305,306,307,308,309,310,311,312,313,314,320,403,404,405,406,407,408,409,410,411,412,413,414,420,998,999],t.ValueList=[3,4,5,6,7,8,9,10,11,12,13,14,20],t}();t.SendCard=e,egret.registerClass(e,"controller.game.SendCard")}(e=t.game||(t.game={}))}(controller||(controller={}));var controller;!function(t){var e;!function(t){var e=function(){function e(){this._cardsAll=[],this._singleArr=[],this._doubleArr=[],this._tripleArr=[],this._quadrupleArr=[]}var i=(__define,e);return p=i.prototype,p.GetType=function(i){if(null==i||i.length<1)return new t.CardListData;this._cardsAll=[],this._singleArr=[],this._doubleArr=[],this._tripleArr=[],this._quadrupleArr=[];var n=0,s=i.length,r=new t.CardListData;for(n=0;s>n;n++)this._cardsAll.push(i[n]%100);this._cardsAll.sort(function(t,e){return t-e}),this.divid();var a=this._cardsAll.length,h=this._singleArr.length,l=this._doubleArr.length,o=this._tripleArr.length,_=this._quadrupleArr.length;r.List=i,r.AllArr=this._cardsAll,r.SingleArr=this._singleArr,r.DoubleArr=this._doubleArr,r.TripleArr=this._tripleArr,r.QuadrupleArr=this._quadrupleArr,r.OneArr=this._singleArr.concat(this._doubleArr).concat(this._tripleArr).concat(this._quadrupleArr),ArrayTools.Sort(r.OneArr);var d=!0,u=!0,c=!0,p=-1,g=0;if(1==a)return trace("Types-GetType> 一张"),r.Type=e.Types_Signal,r;if(2==a&&1==l)return trace("Types-GetType> 一对"),r.Type=e.Types_Double,r;if(3==a&&1==o)return trace("Types-GetType> 三张"),r.Type=e.Types_Three,r;if(4==a&&1==o)return trace("Types-GetType> 三带一"),r.Type=e.Types_Three_Signal,r;if(5==a&&1==o&&1==l)return trace("Types-GetType> 三代一对"),r.Type=e.Types_Three_Double,r;if(6==a&&1==_&&2==h)return trace("Types-GetType> 四带二"),r.Type=e.Types_Four_Signal,r;if(6==a&&1==_&&1==l)return trace("Types-GetType> 四带二"),r.Type=e.Types_Four_Signal,r;if(8==a&&1==_&&2==l)return trace("Types-GetType> 四带两对"),r.Type=e.Types_Four_Double,r;if(o>1&&0==_){for(d=!0,p=-1,n=0;o>n;n++)g=this._tripleArr[n],-1==p?p=g:g==p+1?p=g:d=!1;if(d){if(0==h&&0==l&&0==_)return trace("Types-GetType> 飞机"),r.Type=e.Types_ThreeN,r;if(o==l&&0==h&&0==_)return trace("Types-GetType> 飞机带对子"),r.Type=e.Types_ThreeN_Double,r;if(o==h&&0==l&&0==_||o==h+2*l&&0==_)return trace("Types-GetType> 飞机带单牌"),r.Type=e.Types_ThreeN_Signal,r}}if(0==l&&0==o&&0==_&&h>4){for(u=!0,p=-1,n=0;h>n;n++)g=this._singleArr[n],-1==p?p=g:g==p+1?p=g:u=!1;if(u)return trace("Types-GetType> 顺子"),r.Type=e.Types_List,r}if(l>2&&0==o&&0==_&&0==h){for(c=!0,p=-1,n=0;l>n;n++)g=this._doubleArr[n],-1==p?p=g:g==p+1?p=g:c=!1;if(c)return trace("Types-GetType> 连对"),r.Type=e.Types_DoubleN,r}return 4==a&&1==_?(trace("Types-GetType> 炸弹"),r.Type=e.Types_Bomb,r):2==a&&2==h&&this._singleArr[0]>50&&this._singleArr[1]>50?(trace("Types-GetType> 王炸"),r.Type=e.Types_Bomb,r):(r.Type=e.Types_Error,r)},p.divid=function(){{var t=0;this._cardsAll.length}for(t=0;t<this._cardsAll.length;t++){var e=this._cardsAll[t],i=this.NumberOf(e);switch(i){case 1:this._singleArr.push(e);break;case 2:this._doubleArr.push(e),t+=1;break;case 3:this._tripleArr.push(e),t+=2;break;case 4:this._quadrupleArr.push(e),t+=3}}},p.NumberOf=function(t){var e=t,i=0,n=0,s=this._cardsAll.length;for(n=0;s>n;n++){var r=this._cardsAll[n];r%100==e&&(i+=1)}return i},e.Types_Error=0,e.Types_Signal=1,e.Types_Double=2,e.Types_Three=3,e.Types_Three_Signal=4,e.Types_Three_Double=5,e.Types_Four_Signal=6,e.Types_Four_Double=7,e.Types_ThreeN=8,e.Types_ThreeN_Signal=9,e.Types_ThreeN_Double=10,e.Types_List=11,e.Types_DoubleN=12,e.Types_Bomb=13,e}();t.Types=e,egret.registerClass(e,"controller.game.Types")}(e=t.game||(t.game={}))}(controller||(controller={}));var LayerMgr=function(){function t(){}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),p.Init=function(e){t.Scene=new egret.Sprite,t.Window=new egret.Sprite,t.TopUI=new egret.Sprite,t.MinTop=new egret.Sprite,t.TopWindow=new egret.Sprite,t.SysTip=new egret.Sprite,e.addChild(t.Scene),e.addChild(t.Window),e.addChild(t.TopWindow),e.addChild(t.TopUI),e.addChild(t.MinTop),e.addChild(t.SysTip)},t.Scene=null,t.Window=null,t.TopUI=null,t.MinTop=null,t.TopWindow=null,t.SysTip=null,t._instance=null,t}();egret.registerClass(LayerMgr,"LayerMgr");var LoadMgr=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.Init=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.Load("preload")},p.Load=function(t){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(t)},p.onResourceLoadComplete=function(t){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),"preload"==t.groupName?this.dispatchEvent(new egret.Event(e.LOADOVER_PRELOAD)):"lobby"==t.groupName&&egret.setTimeout(function(){this.dispatchEvent(new egret.Event(e.LOADOVER_LOBBY))},this,200)},p.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},p.onResourceProgress=function(t){this.ItemsLoaded=t.itemsLoaded,this.ItemsTotal=t.itemsTotal,this.dispatchEvent(new egret.Event(e.LOAD_PROGRESS))},e.LOADOVER_PRELOAD="LOADOVER_PRELOAD",e.LOADOVER_LOBBY="LOADOVER_LOBBY",e.LOAD_PROGRESS="LOAD_PROGRESS",e._instance=null,e}(egret.EventDispatcher);egret.registerClass(LoadMgr,"LoadMgr");var LocalMgr=function(){function t(){this._localData=null,this._localData=new data.LocalData}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance
}),p.LoadData=function(){if(null!=egret.localStorage){var e=egret.localStorage.getItem(t.DATANAME),i=JSON.parse(e);this._localData.InitThis(i)}},p.SetData=function(e,i){if(null!=egret.localStorage){this._localData[e]=i;var n=this._localData.Clone(),s=JSON.stringify(n);egret.localStorage.setItem(t.DATANAME,s)}},p.GetData=function(t){return this._localData[t]},t.SoundBG_Volume="SoundBG_Volume",t.SoundMusic_Volume="SoundMusic_Volume",t.RecordObj="RecordObj",t.DATANAME="at20151230_doudizhu",t._instance=null,t}();egret.registerClass(LocalMgr,"LocalMgr");var NativeMgr=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.JS2Native=function(t){var e=JSON.stringify(t),i=window.js2native(e);return i},p.Native2JS=function(t){var e=JSON.parse(t);if(trace("native->js",t),null==e)return trace("Json解析失败"+t),null;switch(trace("native->js",t),e.type){case"getInitInfo":this.dispatchEvent(new egret.Event(enums.NativeEvent.NATIVEEVENT_GETINITINFO,!1,!1,e.value));break;case"stopsound":SoundMgr.Instance.StopSound();break;case"min":e.value&&e.value.reslt&&SceneMgr.Instance.GetCurrentScene()instanceof scene.GameScene&&SceneMgr.Instance.GetCurrentScene().ResetMin();break;case"max":e.value&&e.value.reslt&&SceneMgr.Instance.GetCurrentScene()instanceof scene.GameScene&&SceneMgr.Instance.GetCurrentScene().ResetMin();break;case"isTouchBG":var i={},n="";return i.type="isTouchBG",i.value=Config.IsBgTouch,n=JSON.stringify(i);case"disConnect":NetMgr.Instance.Exit(),SceneMgr.Instance.GetCurrentScene()instanceof scene.GameScene&&SceneMgr.Instance.GetCurrentScene().ReStart();break;case"connect":NetMgr.Instance.Connect()}return"{'js':'null'}"},p.MinWindow=function(){var t={};t.type="min",data.GameData.IsInNative||SceneMgr.Instance.GetCurrentScene()instanceof scene.GameScene&&SceneMgr.Instance.GetCurrentScene().ResetMin();var e=this.JS2Native(t);if(null!=e){var i=JSON.parse(e);if(i&&i.value){var n=JSON.parse(i.value);n.reslt&&SceneMgr.Instance.GetCurrentScene().ResetMin()}}},p.MaxWindow=function(){var t={};t.type="max",data.GameData.IsInNative||SceneMgr.Instance.GetCurrentScene()instanceof scene.GameScene&&SceneMgr.Instance.GetCurrentScene().ResetMin();var e=this.JS2Native(t);if(trace("native->js:"+e),null!=e){var i=JSON.parse(e);if(i&&i.value){var n=JSON.parse(i.value);n.reslt&&SceneMgr.Instance.GetCurrentScene().ResetMin()}}},p.ExitWindow=function(){var t={};t.type="exit";var e={};e.integral=data.GameData.integral,e.money=data.GameData.money;var i=JSON.stringify(e);t.value=i,NetMgr.Instance.Exit();var n=this.JS2Native(t);if(null!=n){var s=JSON.parse(n);if(s&&s.value){var e=JSON.parse(s.value);e.reslt}}},p.GetInitInfo=function(){},p.waitPlayer=function(){var t={};t.type="waitPlayer";var e={};e.groupid=data.GameData.groupid;var i=JSON.stringify(e);t.value=i;var n=this.JS2Native(t);if(null!=n){var s=JSON.parse(n);if(s&&s.value)var e=JSON.parse(s.value)}},e._instance=null,e}(egret.EventDispatcher);egret.registerClass(NativeMgr,"NativeMgr");var NetMgr=function(t){function e(){t.call(this),this._socketBase=null,this._concecttime=0,this._timer=new egret.Timer(6e3),this._socketBase=new net.SocketBase,this._socketBase.addEventListener(net.SocketBase.Event_Open,this.onSocketOpen,this),this._socketBase.addEventListener(net.SocketBase.Event_Close,this.onSocketClose,this),this._socketBase.addEventListener(net.SocketBase.Event_Error,this.onSocketError,this),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.onTimer=function(){this.SendMsg(enums.NetEnum.NET_C2S_PING)},i(p,"IsConnect",function(){return data.GameData.IsRobot_Offline?!0:this._socketBase.IsConnect}),p.onSocketOpen=function(){this.dispatchEvent(new egret.Event(enums.NetEvent.NETEVENT_CONNECT)),("网络已断开,正在重连"==windowui.SysTipsInst.Instance.getText()||"网络已断开,正在重连"==windowui.SysTipsInst.Instance.getText())&&windowui.SysTipsInst.Instance.Hide(),this._concecttime>0&&Main.reconnect(),this._timer.start(),this._concecttime++},p.onSocketClose=function(){this.dispatchEvent(new egret.Event(enums.NetEvent.NETEVENT_CLOSE)),data.GameData.IsRobot_Offline||(this.showDisTips(),this._concecttime>=e.RENETTIME||egret.setTimeout(function(){this.Connect()},this,15e3))},p.showDisTips=function(){return windowui.ActivityOverInst.Instance.IsActOver?(windowui.SysTipsInst.Instance.Hide(),void(this._concecttime=e.RENETTIME)):(data.GameData.flag==data.GameData.GameFlag_Activity&&this._concecttime>0&&(windowui.SysTipsInst.Instance.Hide(),this._concecttime=e.RENETTIME,windowui.SysTipsInst.Instance.Show("没有活动资格,无法进入活动",function(){NativeMgr.Instance.ExitWindow()},this,!0,"退出游戏")),data.GameData.IsActivityKick?(windowui.SysTipsInst.Instance.Hide(),this._concecttime=e.RENETTIME,void windowui.SysTipsInst.Instance.Show("您的比赛积分不足,无法继续游戏,欢迎下次再次挑战",function(){NativeMgr.Instance.ExitWindow()},this,!0,"退出游戏")):(this._concecttime++,void windowui.SysTipsInst.Instance.Show("网络已断开,正在重连",function(){},this)))},p.onSocketError=function(){trace("NetMgr::onSocketError->"),this.dispatchEvent(new egret.Event(enums.NetEvent.NETEVENT_ERROR)),data.GameData.IsRobot_Offline||this.showDisTips()},i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.Connect=function(){data.GameData.IsRobot_Offline||this._socketBase.connet(data.GameData.SERVER_URL)},p.SendMsg=function(t,e){if(void 0===e&&(e=null),data.GameData.IsRobot_Offline&&t!=enums.NetEnum.NET_C2S_PING){var i={};i.type=enums.NetEnum.NET_C2S_PING,i.value=e;var n=JSON.stringify(i);return RobotGameMgr.Instance.SendMsg(t,e)}null==e&&(e={}),null==e.playerGuid&&(e.playerGuid=data.GameData.playerGuid);var i={};i.type=t,i.value=e;var n=JSON.stringify(i);this._socketBase.sendDataByString(n)},p.OnMessage=function(t){var e=JSON.parse(t),i="";switch(e.type){case null:return;case enums.NetEnum.NET_C2S_PING:return void(i=enums.NetEvent.NETEVENT_PING);case enums.NetEnum.NET_CSC_LOGIN:if(i=enums.NetEvent.NETEVENT_LOGINSUCESS,data.GameData.playerGuid=e.value,data.GameData.money=e.money,this._concecttime>1&&null!=SceneMgr.Instance.GetCurrentScene())return void this.SendMsg(enums.NetEnum.CLIENT_2_CENTER_LOGIN_OK);break;case enums.NetEnum.GAME_2_CLIENT_INIT_ROOM:i=enums.NetEvent.NETEVENT_ROOMIN;break;case enums.NetEnum.GAME_2_CLIENT_OTHER_ENTER_ROOM:i=enums.NetEvent.NETEVENT_OTHERPLAYERIN;break;case enums.NetEnum.GAME_2_CLIENT_SENDCARD:i=enums.NetEvent.NETEVENT_SENDCARD;break;case enums.NetEnum.GAME_2_CLIENT_TURNCALLLAND:i=enums.NetEvent.NETEVENT_TURNCALLLAND;break;case enums.NetEnum.GAME_2_CLIENT_CALLLANDOWNER:i=enums.NetEvent.NETEVENT_OTHERCALLLAND;break;case enums.NetEnum.GAME_2_CLIENT_CALLLANDOVER:i=enums.NetEvent.NETEVENT_CALLLANDOVER;break;case enums.NetEnum.GAME_2_CLIENT_TURNPLAY:i=enums.NetEvent.NETEVENT_TURNPALY;break;case enums.NetEnum.GAME_2_CLIENT_SHOWPLAY:i=enums.NetEvent.NETEVENT_SHOWPALY;break;case enums.NetEnum.GAME_2_CLIENT_GAMEOVER:i=enums.NetEvent.NETEVENT_GAMEOVER;break;case enums.NetEnum.GAME_2_CLIENT_SENDCHAT:i=enums.NetEvent.NETEVENT_SENDCHAT;break;case enums.NetEnum.GAME_2_CLIENT_RREADY:i=enums.NetEvent.NETEVENT_READY;break;case enums.NetEnum.GAME_2_CLIENT_PLAYEROUT:i=enums.NetEvent.NETEVENT_PLAYEROUT;break;case enums.NetEnum.GAME_2_CLIENT_AUTO:i=enums.NetEvent.NETEVENT_AUTO;break;case enums.NetEnum.GATE_2_CLIENT_ACTIVITY_ONLINE:i=enums.NetEvent.NETEVENT_ACTIVITYONLINE;break;case enums.NetEnum.GAME_2_CLIENT_WAIT_ACTIVITY_END:i=enums.NetEvent.NETEVENT_WAITACTIVITYEND;break;case enums.NetEnum.CENTER_2_CLIENT_LOGIN_LOBBY:i=enums.NetEvent.NETEVENT_LOBBYIN;break;case enums.NetEnum.CENTER_2_CLIENT_ADD_FREE_MONEY:i=enums.NetEvent.NETEVENT_ADDFREEMONEY}this.dispatchEvent(new egret.Event(i,!1,!1,e))},p.Exit=function(){this._socketBase.Close()},e._instance=null,e.RENETTIME=100,e}(egret.EventDispatcher);egret.registerClass(NetMgr,"NetMgr");var RobotGameMgr=function(){function t(){this._card=null,this._type=null,this._compare=null,this._prompt=null,this._gameState=0,this._lastPlayer=null,this._lanScore=0,this._pointMax=3,this._playerPoint=0,this._tablelistdata=null,this._playerList=[],this._landOwner=null,this._landMaxScore=0,this._TimeCount=1,this._lanownList=[],this._timeoutList=[]}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),p.SendMsg=function(t,e){void 0===e&&(e=null);var i={};switch(t){case enums.NetEnum.CLIENT_2_GAME_REQ_EXIT:i.type=enums.NetEnum.CENTER_2_CLIENT_LOGIN_LOBBY,i.value={};var n=JSON.stringify(i);this.GameOver(),data.GameData.IsRobot_Offline=!1,NetMgr.Instance.OnMessage(n);break;case enums.NetEnum.NET_CSC_LOGIN:i.type=enums.NetEnum.NET_CSC_LOGIN,i.value=998;var n=JSON.stringify(i);NetMgr.Instance.OnMessage(n);break;case enums.NetEnum.CLIENT_2_GAME_READY:for(var s in this._playerList)0==this._playerList[s].IsRobot&&(this._playerList[s].IsReady=!0);3==this._playerList.length&&this.checkAllReady()&&this.Start();break;case enums.NetEnum.CLIENT_2_CENTER_LOGIN_OK:i.type=enums.NetEnum.GAME_2_CLIENT_INIT_ROOM,i.value={},this._playerList=[];var r=new data.Player;r.userid=data.GameData.userid,r.avatar=data.GameData.avatar,r.playerGuid=data.GameData.playerGuid,r.nickname=data.GameData.nickname,r.money=0,r.integral=data.GameData.integral,r.TableId=0,r.IsReady=!1,r.IsRobot=!1,r.ShowCardNum=17;var a=new data.Player;a.avatar="http://uc.9ria.com/data/avatar/000/06/11/49_avatar_middle.jpg",a.nickname="机器人1",a.money=0,a.integral=0,a.IsReady=!0,a.TableId=1,a.IsRobot=!0,a.ShowCardNum=17;var h=new data.Player;h.avatar="http://uc.9ria.com/data/avatar/000/06/11/49_avatar_middle.jpg",h.nickname="机器人2",h.money=0,h.integral=0,h.IsReady=!0,h.TableId=2,h.IsRobot=!0,h.ShowCardNum=17,this._playerList=[r,a,h],3==this._playerList.length&&this.checkAllReady()&&this.Start();var l=[r,a,h];i.value.playerlist=l,i.value.gamestate=0,i.value=JSON.stringify(i.value);var n=JSON.stringify(i);NetMgr.Instance.OnMessage(n);break;case enums.NetEnum.CLIENT_2_GAME_CALLLANDOWNER:i.type=enums.NetEnum.GAME_2_CLIENT_CALLLANDOWNER;var o=this._playerList[this._playerPoint],_=e,e={};e.score=_.score,e.tableid=o.TableId,i.value=JSON.stringify(e);var n=JSON.stringify(i);NetMgr.Instance.OnMessage(n);var d=this.CallLandOwners(_.score,this._playerPoint);d?this._timeoutList.push(egret.setTimeout(function(){this.BeginPlay(!0)},this,500)):this.beginCallOwner();break;case enums.NetEnum.CLIENT_2_GAME_SHOWCARD:var u=!1,c=e.cardlist;i.type=enums.NetEnum.GAME_2_CLIENT_SHOWPLAY;var o=this._playerList[this._playerPoint];if(u=null==c||c.length<=0?this.Pass(this._playerPoint):this.ShowCard(c,this._playerPoint),0==u||0==this._gameState)return;var e={};e.tableid=o.TableId,e.cardlist=c,e.cardnum=o.CardNum,e.timecount=this._TimeCount,e.isnew=null==this._tablelistdata,i.value=JSON.stringify(e);var n=JSON.stringify(i);NetMgr.Instance.OnMessage(n),this.BeginPlay(!1);break;case enums.NetEnum.CLIENT_2_GAME_SENDCHAT:i.type=enums.NetEnum.GAME_2_CLIENT_SENDCHAT,i.value={},i.value.msg=e}},p.checkAllReady=function(){for(var t in this._playerList)if(0==this._playerList[t].IsReady)return!1;return!0},p.init=function(){},p.Start=function(){this._gameState=1,this._pointMax=this._playerList.length,this._playerPoint=0,this._card=new controller.game.SendCard,this._type=new controller.game.Types,this._compare=new controller.game.Compare,this._prompt=new controller.game.Prompt;var t=this._card.GetCardRandom();this._playerList[0].CardArr=t[0],this._playerList[1].CardArr=t[1],this._playerList[2].CardArr=t[2],this._lanownList=t[3];var e={},i={};e.type=enums.NetEnum.GAME_2_CLIENT_SENDCARD,i.cardlist=t[0],e.value=JSON.stringify(i),NetMgr.Instance.OnMessage(JSON.stringify(e)),this._timeoutList.push(egret.setTimeout(this.beginCallOwner,this,4e3))},p.beginCallOwner=function(){var t={},e=this._playerList[this._playerPoint];if(null!=e)if(0==e.IsRobot){t.type=enums.NetEnum.GAME_2_CLIENT_TURNCALLLAND;var i={};i.tableid=this._playerPoint,i.cardnum1=this._playerList[0].CardNum,i.cardnum2=this._playerList[1].CardNum,i.cardnum3=this._playerList[2].CardNum,t.value=JSON.stringify(i);var n=JSON.stringify(t);NetMgr.Instance.OnMessage(n)}else this._timeoutList.push(egret.setTimeout(function(){t.type=enums.NetEnum.GAME_2_CLIENT_CALLLANDOWNER;var e={};e.tableid=this._playerPoint,e.score=this._landMaxScore+Math.ceil(Math.random()*(3-this._landMaxScore));var i=this.CallLandOwners(e.score,this._playerPoint);t.value=JSON.stringify(e),NetMgr.Instance.OnMessage(JSON.stringify(t)),i?this._timeoutList.push(egret.setTimeout(function(){this.BeginPlay(!0)},this,500)):this.beginCallOwner()},this,1e3+2e3*Math.random()))},p.BeginPlay=function(t){var e={},i=this._playerList[this._playerPoint];if(null!=i){if(t){e.type=enums.NetEnum.GAME_2_CLIENT_CALLLANDOVER;var n={};n.landtableid=this._playerPoint,n.cardlist=this._lanownList,n.landscore=this._landMaxScore,e.value=JSON.stringify(n);var s=JSON.stringify(e);NetMgr.Instance.OnMessage(s)}if(0==i.IsRobot){e.type=enums.NetEnum.GAME_2_CLIENT_TURNPLAY;var n={};n.tableid=this._playerPoint,n.isnew=null==this._tablelistdata,n.cardnum=i.CardNum,n.cardnum1=this._playerList[0].CardNum,n.cardnum2=this._playerList[1].CardNum,n.cardnum3=this._playerList[2].CardNum,e.value=JSON.stringify(n);var s=JSON.stringify(e);NetMgr.Instance.OnMessage(s)}else{e.type=enums.NetEnum.GAME_2_CLIENT_TURNPLAY;var n={};n.tableid=this._playerPoint,n.isnew=null==this._tablelistdata,n.cardnum=i.CardNum,n.cardnum1=this._playerList[0].CardNum,n.cardnum2=this._playerList[1].CardNum,n.cardnum3=this._playerList[2].CardNum,e.value=JSON.stringify(n);var s=JSON.stringify(e);NetMgr.Instance.OnMessage(s),this._timeoutList.push(egret.setTimeout(function(){e.type=enums.NetEnum.GAME_2_CLIENT_SHOWPLAY;var t={},i=this.prompCard(),n=[],s=this._playerList[this._playerPoint];if(i&&i.Type!=controller.game.Types.Types_Error?(this.ShowCard(i.List,this._playerPoint),n=i.List):this.Pass(this._playerPoint),0!=this._gameState){t.tableid=s.TableId,t.cardlist=n,t.timecount=this._TimeCount,t.cardnum=s.CardNum,t.isnew=null==this._tablelistdata,e.value=JSON.stringify(t);var r=JSON.stringify(e);NetMgr.Instance.OnMessage(r),this.BeginPlay(!1)}},this,1e3+2e3*Math.random()))}}},p.GetPlayerById=function(t){return this._playerList[t]},p.GetDizhuCard3=function(){return this._lanownList},p.ShowCard=function(t,e){if(null==this._landOwner)return trace("RobotGameMgr-ShowCard> 没有产生地主,先叫分"),!1;if(this._playerPoint!=e)return trace("RobotGameMgr-ShowCard> 没有轮到该玩家"),!1;var i=this._type.GetType(t);if(i.Type==controller.game.Types.Types_Error)return trace("RobotGameMgr-ShowCard> 出牌不符合规则"),!1;var n=this._compare.IsBiger(i,this._tablelistdata);if(!n)return trace("RobotGameMgr-ShowCard> 出牌大不过桌面牌"),!1;i.Type==controller.game.Types.Types_Bomb&&this._TimeCount++;var s=this._playerList[this._playerPoint];if(s.removeCards(t),this._lastPlayer=s,s.CardNum<=0){for(var r=this.getEnemy(s),a=!0,h=0;h<r.length;h++)r[h].CardNum>0&&(a=!1);a&&this._TimeCount++,s.CardArr=t;var l={};l.type=enums.NetEnum.GAME_2_CLIENT_GAMEOVER;var o={};o.wintableid=s.TableId,o.islandwin=s.IsLandOwner,o.timecount=this._TimeCount,o.tablelist_0=this._playerList[0].CardArr,o.tablelist_1=this._playerList[1].CardArr,o.tablelist_2=this._playerList[2].CardArr,l.value=JSON.stringify(o);var _=JSON.stringify(l);return NetMgr.Instance.OnMessage(_),void this.GameOver()}return trace("RobotGameMgr-ShowCard> 出牌成功"),this._playerPoint++,this._playerPoint>=this._pointMax&&(this._playerPoint=0),this._tablelistdata=i,this._tablelistdata.FromId=e,!0},p.getEnemy=function(t){var e=this._playerList.length,i=0,n=[];for(i=0;e>i;i++)this._playerList[i].userid!=t.userid&&this._playerList[i].IsLandOwner!=t.IsLandOwner&&n.push(this._playerList[i]);return n},p.GameOver=function(){for(this._gameState=0,this._pointMax=3,this._playerPoint=0,this._tablelistdata=null,this._landOwner=null,this._landMaxScore=0,this._TimeCount=1,this._lanownList=[];this._timeoutList.length>0;)egret.clearTimeout(this._timeoutList.pop());var t=this._playerList[0];t.userid=data.GameData.userid,t.avatar=data.GameData.avatar,t.playerGuid=data.GameData.playerGuid,t.nickname=data.GameData.nickname,t.money=0,t.integral=data.GameData.integral,t.TableId=0,t.IsReady=!1,t.IsRobot=!1,t.IsLandOwner=!1,t.CardArr=[],t.ShowCardNum=17;var e=this._playerList[1];e.avatar="http://uc.9ria.com/data/avatar/000/06/11/49_avatar_middle.jpg",e.nickname="机器人1",e.money=0,e.integral=0,e.IsReady=!0,e.TableId=1,e.IsRobot=!0,e.IsLandOwner=!1,e.CardArr=[],e.ShowCardNum=17;var i=this._playerList[2];i.avatar="http://uc.9ria.com/data/avatar/000/06/11/49_avatar_middle.jpg",i.nickname="机器人2",i.money=0,i.integral=0,i.IsReady=!0,i.TableId=2,i.IsRobot=!0,i.IsLandOwner=!1,i.CardArr=[],i.ShowCardNum=17,this._playerList=[t,e,i]},p.prompCard=function(){var t=this._playerList[this._playerPoint],e=this._type.GetType(t.CardArr),i=this._playerList.length,n=null,s=0,r=0,a=0;for(a=0;i>a;a++){var h=this._playerList[a];h!=t&&((a==this._playerPoint+1||this._playerPoint==i-1&&0==a)&&(n=h),h.IsLandOwner==t.IsLandOwner?s=h.CardNum:r=h.CardNum)}var l=!1;this._lastPlayer&&this._lastPlayer.IsLandOwner==t.IsLandOwner&&(l=!0);var o=this._prompt.GetPrompt(e,this._tablelistdata,r,s,n.IsLandOwner==t.IsLandOwner,l);return o},p.Pass=function(t){return null==this._landOwner?(trace("RobotGameMgr-Pass> 没有产生地主"),!1):this._playerPoint!=t?(trace("RobotGameMgr-Pass> 没有轮到该玩家"),!1):(trace("RobotGameMgr-Pass> 玩家pass,id:",t),this._playerPoint++,this._playerPoint>=this._pointMax&&(this._playerPoint=0),this._tablelistdata&&this._playerPoint==this._tablelistdata.FromId&&(trace("RobotGameMgr-Pass> 一轮结束 玩家可以重新出牌:",t),this._tablelistdata=null),!0)},p.CallLandOwners=function(t,e){if(this._playerPoint!=e)return trace("RobotGameMgr-CallLandOwners> 没有轮到该玩家"),!1;if(null!=this._landOwner)return trace("RobotGameMgr-CallLandOwners> 已经有地主了"),!1;var i=this._playerList[e];if(i.LandOwnerScore=t,3==t)return this._landMaxScore=t,this._landOwner=i,i.IsLandOwner=!0,i.CardArr=i.CardArr.concat(this._lanownList),trace("RobotGameMgr-CallLandOwners> 玩家"+e+"  3分直接搞定地主"),this._lanScore=t,!0;if(t>0&&t<=this._landMaxScore)return trace("RobotGameMgr-CallLandOwners> 不能叫"+this._landMaxScore+"分及以下"),!1;if(t>0&&t>this._landMaxScore&&(this._landMaxScore=t),this._playerPoint>=this._pointMax-1){this._playerPoint=0;for(var n in this._playerList){var s=this._playerList[n];if(s.LandOwnerScore==this._landMaxScore)return this._landOwner=s,s.IsLandOwner=!0,s.CardArr=s.CardArr.concat(this._lanownList),this._lanScore=t,this._playerPoint=n,trace("RobotGameMgr-CallLandOwners> 玩家"+e+"叫了"+t+"分,玩家"+s.TableId+"最高分为地主"),!0}}return this._playerPoint++,trace("RobotGameMgr-CallLandOwners> 玩家"+e+"叫了"+t+"分"),!1},p.GetLanOwner=function(){return this._landOwner},t.TurnTime=25e3,t._instance=null,t}();egret.registerClass(RobotGameMgr,"RobotGameMgr");var scene;!function(t){var e=function(t){function e(){t.call(this),this.height=Config.StageHeight,this.width=Config.StageWidth}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Release=function(){this.parent&&this.parent.removeChild(this),LayerMgr.Scene.removeChildren(),LayerMgr.Window.removeChildren(),LayerMgr.TopUI.removeChildren(),LayerMgr.MinTop.removeChildren(),LayerMgr.TopWindow.removeChildren(),LayerMgr.SysTip.removeChildren()},p.ResetMin=function(){},p.Init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},e}(egret.Sprite);t.SceneBase=e,egret.registerClass(e,"scene.SceneBase",["IRelease","IInit"])}(scene||(scene={}));var GameScene=scene.GameScene,SceneMgr=function(){function t(){this._lobbySceneProxy=null,this._gameSceneProxy=null,this._currentScene=null,this._currentProxy=null,this._gameSceneProxy=new sceneproxy.GameSceneProxy,this._lobbySceneProxy=new sceneproxy.LobbySceneProxy}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),p.GetCurrentProxy=function(){return this._currentProxy},p.GetCurrentScene=function(){return this._currentScene},p.ShowScene=function(t){null==this._currentScene?(this._currentScene=new t,LayerMgr.Scene.addChild(this._currentScene)):(this._currentScene.Release(),this._currentScene=new t,LayerMgr.Scene.addChild(this._currentScene)),this._currentProxy&&this._currentProxy.Release(),this._currentScene instanceof scene.GameScene?this._currentProxy=this._gameSceneProxy:this._currentScene instanceof scene.LobbyScene&&(this._currentProxy=this._lobbySceneProxy);var e=this._currentScene;this._currentScene.Init(),e==this._currentScene&&this._currentProxy.Init(this._currentScene)},t._instance=null,t}();egret.registerClass(SceneMgr,"SceneMgr");var sceneproxy;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,p.Init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},p.Release=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},t}();t.SceneProxyBase=e,egret.registerClass(e,"sceneproxy.SceneProxyBase",["IInit","IRelease"])}(sceneproxy||(sceneproxy={}));var sceneproxy;!function(t){var e=function(t){function e(){t.call(this),this._recordObj={},this._playerList=[],this._tableCardList=[],this._landList=[],this._myPlayer=null,this._scene=null,this._landscore=0,this._timecount=1,this._gamestate=0,this._lastSendCardPlayer=null}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(t){this._scene=t,NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_ROOMIN,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_OTHERPLAYERIN,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_SENDCARD,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_TURNCALLLAND,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_OTHERCALLLAND,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_CALLLANDOVER,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_TURNPALY,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_SHOWPALY,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_GAMEOVER,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_SENDCHAT,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_READY,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_PLAYEROUT,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_AUTO,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_ACTIVITYONLINE,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_WAITACTIVITYEND,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_LOBBYIN,this.onNetMsg,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_ADDFREEMONEY,this.onNetMsg,this),NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_CENTER_LOGIN_OK)},p.Release=function(){this._recordObj={},this._playerList=[],this._tableCardList=[],this._landList=[],this._myPlayer=null,this._scene=null,this._landscore=0,this._timecount=1,this._gamestate=0,this._lastSendCardPlayer=null,NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_ROOMIN,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_OTHERPLAYERIN,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_SENDCARD,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_TURNCALLLAND,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_OTHERCALLLAND,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_CALLLANDOVER,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_TURNPALY,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_SHOWPALY,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_GAMEOVER,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_SENDCHAT,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_READY,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_PLAYEROUT,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_AUTO,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_ACTIVITYONLINE,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_WAITACTIVITYEND,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_LOBBYIN,this.onNetMsg,this),NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_ADDFREEMONEY,this.onNetMsg,this)},p.onNetMsg=function(t){switch(console.info(t.data),t.type){case enums.NetEvent.NETEVENT_ADDFREEMONEY:var i=JSON.parse(t.data.value);windowui.SysTipsInst.Instance.Show("金币输光了,系统免费赠送您"+i.addmoney+"金币,继续玩耍吧!",function(){windowui.SysTipsInst.Instance.Hide()},this,!0),data.GameData.money=i.nowmoney,this._scene.AddFreeMoney();break;case enums.NetEvent.NETEVENT_LOBBYIN:SceneMgr.Instance.ShowScene(scene.LobbyScene);break;case enums.NetEvent.NETEVENT_ROOMIN:this._gamestate=0;for(var n in this._playerList){var s=this._playerList[n];this._scene.PlayerOut(s,s==this._myPlayer),this._playerList[n]=null}var i=JSON.parse(t.data.value),r=i.playerlist,a=i.gamestate,h=i.playerpoint,l=(i.actetime,i.lastsend);this._landscore=i.landscore,this._tableCardList=i.tablelist,this._timecount=i.timecount,this._landList=i.landlist;for(var n in r){var o=r[n],s=this._playerList[o.TableId];s?s.Reset(o):(s=new data.Player(o),this._playerList[s.TableId]=s),s.playerGuid==data.GameData.playerGuid&&(this._myPlayer=s,this._myPlayer.LocalTableId=3,data.GameData.IsAuto=!1,this._scene.SetAuto(this._myPlayer.LocalTableId,!1))}for(var n in this._playerList){var _=this._playerList[n];_&&(_.LocalTableId=this.getLocalTableId(_.TableId,this._myPlayer.TableId))}var d=this.getPlayerByTableId(h);switch(a){case 0:this._myPlayer.CardArr=[],this._myPlayer.IsReady=!1,this._scene.RoomIn(this._playerList);break;case 1:this._scene.RoomIn(this._playerList),this._scene.ReNet(this._landList,this.getLandPlayer(),this._myPlayer,this._landscore+"x1",this._playerList),this._scene.TurnCallLand(d,d==this._myPlayer,this._landscore,3e4);break;case 2:this._scene.RoomIn(this._playerList),this._scene.ReNet(this._landList,this.getLandPlayer(),this._myPlayer,this._landscore+"x1",this._playerList),this._scene.TurnCallLand(d,d==this._myPlayer,this._landscore,3e4);break;case 3:this._scene.RoomIn(this._playerList),this._scene.ReNet(this._landList,this.getLandPlayer(),this._myPlayer,this._landscore+"x1",this._playerList);var u=this.getPlayerByTableId(l);this._scene.TurnPlay(d,d==this._myPlayer,!1,this._tableCardList,3e4,!1,u)}this._gamestate=a;break;case enums.NetEvent.NETEVENT_OTHERPLAYERIN:if(0!=this._gamestate)return;var c=t.data.value,s=null;for(var n in this._playerList){var _=this._playerList[n];_&&_.TableId==c.TableId&&(_.Reset(c),s=_)}null==s&&(s=new data.Player(t.data.value),this._playerList[s.TableId]=s),s.LocalTableId=this.getLocalTableId(s.TableId,this._myPlayer.TableId),this._scene.PlayerIn(s);break;case enums.NetEvent.NETEVENT_PLAYEROUT:if(0!=this._gamestate)return;var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid);s&&s!=this._myPlayer&&(this._playerList[s.TableId]=null,this._scene.PlayerOut(s,s==this._myPlayer));break;case enums.NetEvent.NETEVENT_READY:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid);s.IsReady=!0,this._scene.SetReady(s.LocalTableId,!0,s==this._myPlayer);break;case enums.NetEvent.NETEVENT_AUTO:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid),p=s==this._myPlayer;s.IsAuto=i.isauto,this._scene.SetAuto(s.LocalTableId,i.isauto),p&&(data.GameData.IsAuto=i.isauto);break;case enums.NetEvent.NETEVENT_SENDCARD:this._gamestate=1;var i=JSON.parse(t.data.value);this._myPlayer.CardArr=i.cardlist,this._scene.SendCard(this._myPlayer);for(var n in this._playerList){var _=this._playerList[n];_&&(_.IsLandOwner=!1)}break;case enums.NetEvent.NETEVENT_TURNCALLLAND:this._gamestate=2;var i=JSON.parse(t.data.value),g=i.cardnum1,y=i.cardnum2,T=i.cardnum3,m=this.getPlayerByTableId(0),f=this.getPlayerByTableId(1),E=this.getPlayerByTableId(2);m&&(m.ShowCardNum=g),f&&(f.ShowCardNum=y),E&&(E.ShowCardNum=T);var s=this.getPlayerByTableId(i.tableid);this._scene.TurnCallLand(s,s==this._myPlayer,this._landscore,e.Delay_CallLand);break;case enums.NetEvent.NETEVENT_OTHERCALLLAND:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid);i.score>this._landscore&&(this._landscore=i.score),this._scene.ShowCallLand(i.score,s.LocalTableId),0==i.score?SoundMgr.Instance.PlayEffect("woman_bujiao_mp3"):1==i.score?SoundMgr.Instance.PlayEffect("woman_jiaodizhu_mp3"):2==i.score?SoundMgr.Instance.PlayEffect("woman_qiangdizhu2_mp3"):3==i.score&&SoundMgr.Instance.PlayEffect("woman_qiangdizhu3_mp3");break;case enums.NetEvent.NETEVENT_CALLLANDOVER:this._gamestate=3;var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.landtableid);this._landList=i.cardlist,this._landscore=i.landscore;var v=this._landscore+"x1";for(var n in this._playerList){var _=this._playerList[n];_&&(_.IsLandOwner=!1)}s.IsLandOwner=!0,s==this._myPlayer&&this._myPlayer.AddCards(i.cardlist),s.ShowCardNum=20,this._scene.CallLandOver(s,i.cardlist,this._myPlayer,v);break;case enums.NetEvent.NETEVENT_TURNPALY:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid),S=i.isnew,g=i.cardnum1,y=i.cardnum2,T=i.cardnum3,m=this.getPlayerByTableId(0),f=this.getPlayerByTableId(1),E=this.getPlayerByTableId(2),C=!1;m.ShowCardNum=g,f.ShowCardNum=y,E.ShowCardNum=T,S&&(this._tableCardList=[],this._lastSendCardPlayer=null,s==this._myPlayer&&(C=!0,m!=s&&m.ShowCardNum>1&&(C=!1),f!=s&&f.ShowCardNum>1&&(C=!1),E!=s&&E.ShowCardNum>1&&(C=!1))),this._scene.TurnPlay(s,s==this._myPlayer,S,this._tableCardList,e.Delay_ShowCard,!1);break;case enums.NetEvent.NETEVENT_SHOWPALY:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid),x=i.cardlist,b=1;this._timecount=i.timecount;var v=this._landscore+"x"+this._timecount;if(s.ShowCardNum=i.cardnum,s.removeCards(x),null==this._tableCardList||0==this._tableCardList.length){var N=this.getPlayerEnemy(s);N&&(b=N.LocalTableId)}else this._lastSendCardPlayer&&(b=this._lastSendCardPlayer.LocalTableId);null!=x&&x.length>0&&(this._tableCardList=x,this._lastSendCardPlayer=s),this._scene.ShowPlay(s,x,s==this._myPlayer,v,b),SoundMgr.Instance.PlayEffect(null!=x&&x.length>0?"card_down_mp3":"woman_buyao"+s.LocalTableId+"_mp3");break;case enums.NetEvent.NETEVENT_GAMEOVER:this._gamestate=0;var i=JSON.parse(t.data.value),w=this.getPlayerByTableId(i.wintableid),L=i.islandwin,I=i.isactover,A=i.rank,R=i.maxMoney,P=i.actmoney;this._timecount=i.timecount;var v=this._landscore+"x"+this._timecount,M=i.tablelist_0,O=i.tablelist_1,G=i.tablelist_2,m=this.getPlayerByTableId(0),f=this.getPlayerByTableId(1),E=this.getPlayerByTableId(2);this.setResoulScore(m,L),this.setResoulScore(f,L),this.setResoulScore(E,L),m&&(m.CardArr=M,m.ShowCardNum=M.length,m.IsReady=!1,this._scene.SetAuto(m.LocalTableId,!1)),f&&(f.CardArr=O,f.ShowCardNum=O.length,f.IsReady=!1,this._scene.SetAuto(f.LocalTableId,!1)),E&&(E.CardArr=G,E.ShowCardNum=G.length,E.IsReady=!1,this._scene.SetAuto(E.LocalTableId,!1)),data.GameData.IsAuto=!1;var B=this.getPlayerByLocalTableId(1),D=this.getPlayerByLocalTableId(2),V=this.getPlayerByLocalTableId(3),H=this._myPlayer.IsLandOwner==L;0>=P&&data.GameData.flag==data.GameData.GameFlag_Activity&&(data.GameData.IsActivityKick=!0),this._scene.GameOver(H,B,D,V,L,v,I,A,R,P,w),this._landscore=0,this._timecount=1,SoundMgr.Instance.PlayEffect(H?"Win_mp3":"Lose_mp3");break;case enums.NetEvent.NETEVENT_SENDCHAT:var i=JSON.parse(t.data.value),s=this.getPlayerByTableId(i.tableid);this._scene.PlayChat(s.LocalTableId,i.chatStr);var k=windowui.ChatInst.WordList,F=0;for(F=0;F<k.length;F++)i.chatStr==k[F];break;case enums.NetEvent.NETEVENT_WAITACTIVITYEND:windowui.SysTipsInst.Instance.Show("比赛结束时间已到,等待所有玩家结束游戏",function(){NativeMgr.Instance.ExitWindow()
},this,!0,"提前退出");break;case enums.NetEvent.NETEVENT_ACTIVITYONLINE:var i=JSON.parse(t.data.value),U=i.enterCount,W=i.leftCount,Y=i.flag,z=i.nickname;Y>0?this._scene.PlayHouseRunning("玩家 "+z+" 加入活动,本次活动共有"+U+"人参与,竞争越来越激烈,各位玩家加油!"):0>Y&&this._scene.PlayHouseRunning("经过激烈争夺,本次活动已淘汰"+(U-W)+"人,还剩"+W+"人,各位玩家请再接再厉!")}},p.setResoulScore=function(t,e){if(null==t)return 0;var i=1;t.IsLandOwner!=e&&(i=-1),i=i*this._timecount*this._landscore,t.IsLandOwner&&(i*=2),t.ResoultScore=i,data.GameData.flag!=data.GameData.GameFlag_Activity&&(t.integral+=i,t.money+=i,t==this._myPlayer&&(data.GameData.integral=t.integral,data.GameData.money=t.money,this._scene.AddFreeMoney()))},p.getLocalTableId=function(t,e){var i=-1,n=t-e;return 1==n||-2==n?i=2:-1==n||2==n?i=1:0==n&&(i=3),i},p.getPlayerEnemy=function(t){var e=0,i=null;for(var n in this._playerList)null!=this._playerList[n]&&this._playerList[n]!=t&&this._playerList[n].IsLandOwner!=t.IsLandOwner&&this._playerList[n].LocalTableId>e&&(e=this._playerList[n].LocalTableId,i=this._playerList[n]);return i},p.getLandPlayer=function(){for(var t in this._playerList)if(this._playerList[t]&&this._playerList[t].IsLandOwner)return this._playerList[t];return null},p.getPlayerByTableId=function(t){for(var e in this._playerList)if(this._playerList[e]&&this._playerList[e].TableId==t)return this._playerList[e];return null},p.getPlayerByLocalTableId=function(t){for(var e in this._playerList)if(this._playerList[e]&&this._playerList[e].LocalTableId==t)return this._playerList[e];return null},p.GetMainPlayer=function(){return this._myPlayer},p.GetRecordObj=function(){if(this._playerList[0]&&this._playerList[1]&&this._playerList[2]){var t=LocalMgr.Instance.GetData(LocalMgr.RecordObj),e=[];e.push(this._playerList[0].userid),e.push(this._playerList[1].userid),e.push(this._playerList[2].userid),e.sort();var i=e[0]+e[1]+e[2],n=t[i];return n instanceof Array?((null==this._recordObj.playerlist||this._recordObj.playerlist[0]!=this._playerList[0]||this._recordObj.playerlist[1]!=this._playerList[1]||this._recordObj.playerlist[2]!=this._playerList[2])&&(this._recordObj.playerlist=[],this._recordObj.scorelist=[],this._recordObj.playerlist.push(this._playerList[0]),this._recordObj.playerlist.push(this._playerList[1]),this._recordObj.playerlist.push(this._playerList[2])),this._recordObj.scorelist=t[i],this._recordObj):[]}return[]},e.Delay_ReadyKick=3e4,e.Delay_SendCardAni=6e3,e.Delay_CallLand=1e4,e.Delay_ShowCard=25e3,e}(t.SceneProxyBase);t.GameSceneProxy=e,egret.registerClass(e,"sceneproxy.GameSceneProxy")}(sceneproxy||(sceneproxy={}));var sceneproxy;!function(t){var e=function(t){function e(){t.call(this),this._scene=null}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(t){this._scene=t,NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_ADDFREEMONEY,this.onNetMsg,this),SoundMgr.Instance.PlaySound("bg_lobby_mp3")},p.onNetMsg=function(t){switch(t.type){case enums.NetEvent.NETEVENT_ADDFREEMONEY:var e=JSON.parse(t.data.value);windowui.SysTipsInst.Instance.Show("金币输光了,系统免费赠送您"+e.addmoney+"金币,继续玩耍吧!",function(){windowui.SysTipsInst.Instance.Hide()},this,!0),data.GameData.money=e.nowmoney,this._scene.AddFreeMoney()}},e}(t.SceneProxyBase);t.LobbySceneProxy=e,egret.registerClass(e,"sceneproxy.LobbySceneProxy")}(sceneproxy||(sceneproxy={}));var SoundMgr=function(){function t(){this._effStopSoundNum=0,this._curSound=null,this._curEffect=null,this._soundVolume=0,this._effectVolume=.5,this._soundDic={},this._soundVolume=LocalMgr.Instance.GetData(LocalMgr.SoundBG_Volume),this._effectVolume=LocalMgr.Instance.GetData(LocalMgr.SoundMusic_Volume)}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==this._instance&&(this._instance=new t),Config.IsHide&&(this._instance.SetSoundVolume(0),this._instance.SetEffectVolume(0)),this._instance}),e(p,"SoundVolume",function(){return this._soundVolume}),e(p,"EffectVolume",function(){return this._effectVolume}),p.SetVolume=function(t){this.SetSoundVolume(t),this.SetEffectVolume(t)},p.SetSoundVolume=function(t){.05>t&&(t=0);try{this._soundVolume=t,this._curSound&&(this._curSound.channel.volume=t),LocalMgr.Instance.SetData(LocalMgr.SoundBG_Volume,t)}catch(e){trace("[ERROR]->soundMgr->SetSoundVolume")}},p.SetEffectVolume=function(t){.05>t&&(t=0),this._effectVolume=t,LocalMgr.Instance.SetData(LocalMgr.SoundMusic_Volume,t)},e(p,"SoundName",function(){return this._curSound.name}),p.PlaySound=function(t,e){if(void 0===e&&(e=0),!Config.IsHide){var i=this.getSound(t,e);if(null!=i)try{this._curSound&&(this._curSound.channel.volume=0,this._curSound.channel.stop()),this._curSound=i,this._curSound.channel.volume=this._soundVolume}catch(n){trace("[ERROR]->soundMgr->PlaySound")}}},p.StopSound=function(){try{this._curSound&&this._curSound.channel.stop()}catch(t){trace("[ERROR]->soundMgr->StopSound")}},p.PlayEffect=function(t,e){if(void 0===e&&(e=!1),!(Config.IsHide||this._effectVolume<=0))try{var i=this.getSound(t,1);if(null==i)return;i.channel.volume=this._effectVolume}catch(n){trace("[ERROR]->soundMgr->PlayEffect")}},p.getSound=function(t,e){var i=RES.getRes(t);if(null==i)return null;var n={};try{var s=i.play(0,e)}catch(r){return console.error(this._curSound+r),null}return n.channel=s,n.sound=i,n.name=t,n},t._instance=null,t}();egret.registerClass(SoundMgr,"SoundMgr");var CardListData=controller.game.CardListData,TestGameScene=scene.TestGameScene,Player=egret.sys.Player,TestGameMgr=function(){function t(){this._testGameScene=null,this._card=null,this._type=null,this._compare=null,this._prompt=null,this._lastPlayer=null,this._pointMax=3,this._playerPoint=0,this._nowcardlistdata=null,this._playerList=[],this._landOwner=null,this._landMaxScore=0,this._lanownList=[],this._static=0,this.init()}var e=__define,i=t;return p=i.prototype,e(t,"Instance",function(){return null==t._instance&&(t._instance=new t),t._instance}),p.init=function(){var t=new data.Player,e=new data.Player,i=new data.Player;t.TableId=0,e.TableId=1,i.TableId=2,this._playerList.push(t),this._playerList.push(e),this._playerList.push(i),this._pointMax=this._playerList.length,this._playerPoint=0,this._card=new controller.game.SendCard,this._type=new controller.game.Types,this._compare=new controller.game.Compare,this._prompt=new controller.game.Prompt},p.Start=function(t){this._testGameScene=t;var e=this._card.GetCardRandom();this._playerList[0].CardArr=e[0],this._playerList[1].CardArr=e[1],this._playerList[2].CardArr=e[2],this._lanownList=e[3]},p.GetPlayerById=function(t){return this._playerList[t]},p.GetDizhuCard3=function(){return this._lanownList},p.ShowCard=function(t,e){if(null==this._landOwner)return traceAndAlert("TestGameMgr-ShowCard> 没有产生地主,先叫分"),!1;if(this._playerPoint!=e)return traceAndAlert("TestGameMgr-ShowCard> 没有轮到该玩家"),!1;var i=this._type.GetType(t);if(i.Type==controller.game.Types.Types_Error)return traceAndAlert("TestGameMgr-ShowCard> 出牌不符合规则"),!1;var n=this._compare.IsBiger(i,this._nowcardlistdata);if(!n)return traceAndAlert("TestGameMgr-ShowCard> 出牌大不过桌面牌"),!1;var s=this._playerList[this._playerPoint];return this._lastPlayer=s,s.removeCards(t),trace("TestGameMgr-ShowCard> 出牌成功"),this._playerPoint++,this._playerPoint>=this._pointMax&&(this._playerPoint=0),this._nowcardlistdata=i,this._nowcardlistdata.FromId=e,this._nowcardlistdata.PlaySound(),this.prompCard(),!0},p.prompCard=function(){var t=this._playerList[this._playerPoint],e=this._type.GetType(t.CardArr),i=this._playerList.length,n=null,s=0,r=0,a=0;for(a=0;i>a;a++){var h=this._playerList[a];h!=t&&((a==this._playerPoint+1||this._playerPoint==i-1&&0==a)&&(n=h),h.IsLandOwner==t.IsLandOwner?s=h.CardNum:r=h.CardNum)}var l=!1;this._lastPlayer&&this._lastPlayer.IsLandOwner==t.IsLandOwner&&(l=!0);var o=this._prompt.GetPrompt(e,this._nowcardlistdata,r,s,n.IsLandOwner==t.IsLandOwner,l);this._testGameScene&&this._testGameScene.PrompCard(this._playerPoint,o)},p.Pass=function(t){return null==this._landOwner?(traceAndAlert("TestGameMgr-Pass> 没有产生地主"),!1):this._playerPoint!=t?(traceAndAlert("TestGameMgr-Pass> 没有轮到该玩家"),!1):(traceAndAlert("TestGameMgr-Pass> 玩家pass,id:",t),this._playerPoint++,this._playerPoint>=this._pointMax&&(this._playerPoint=0),this._playerPoint==this._nowcardlistdata.FromId&&(traceAndAlert("TestGameMgr-Pass> 一轮结束 玩家可以重新出牌:",t),this._nowcardlistdata=null),this.prompCard(),!0)},p.CallLandOwners=function(t,e){if(this._playerPoint!=e)return traceAndAlert("TestGameMgr-CallLandOwners> 没有轮到该玩家"),!1;if(null!=this._landOwner)return traceAndAlert("TestGameMgr-CallLandOwners> 已经有地主了"),!1;var i=this._playerList[e];if(i.LandOwnerScore=t,3==t)return this._landMaxScore=t,this._landOwner=i,i.IsLandOwner=!0,i.CardArr=i.CardArr.concat(this._lanownList),traceAndAlert("TestGameMgr-CallLandOwners> 3分直接搞定地主"),!0;if(t>0&&t<=this._landMaxScore)return traceAndAlert("TestGameMgr-CallLandOwners> 不能叫"+this._landMaxScore+"分及以下"),!1;if(t>0&&t>this._landMaxScore&&(this._landMaxScore=t),this._playerPoint++,this._playerPoint>=this._pointMax){this._playerPoint=0;for(var n in this._playerList){var s=this._playerList[n];if(s.LandOwnerScore==this._landMaxScore)return this._landOwner=s,s.IsLandOwner=!0,s.CardArr=s.CardArr.concat(this._lanownList),traceAndAlert("TestGameMgr-CallLandOwners> 玩家"+s.TableId+"为地主"),!0}}return traceAndAlert("TestGameMgr-CallLandOwners> 玩家"+e+"叫了"+t+"分"),!1},p.GetLanOwner=function(){return this._landOwner},t._instance=null,t}();egret.registerClass(TestGameMgr,"TestGameMgr");var data;!function(t){var e=function(){function t(t){void 0===t&&(t=null),this.userid="",this.nickname="",this.avatar="",this.integral=0,this.money=0,this.playerGuid=0,this.ResoultScore=0,this.TableId=0,this.LocalTableId=0,this.IsReady=!1,this.IsAuto=!1,this.ShowCardNum=0,this.CardArr=[],this.LandOwnerScore=0,this.IsLandOwner=!1,this.IsRobot=!1;for(var e in t)void 0!=this[e]&&(this[e]=t[e])}var e=__define,i=t;return p=i.prototype,p.Reset=function(t){void 0===t&&(t=null);for(var e in t)void 0!=this[e]&&(this[e]=t[e])},e(p,"CardNum",function(){return this.CardArr.length}),p.removeCards=function(t){if(null!=t){var e=0,i=0,n=t.length;for(e=0;n>e;e++)for(i=this.CardArr.length-1;i>=0;i--)if(this.CardArr[i]==t[e]){this.CardArr.splice(i,1);break}}},p.AddCards=function(t){if(null!=t)for(var e in t)this.CardArr.push(t[e])},t}();t.Player=e,egret.registerClass(e,"data.Player")}(data||(data={}));var data;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);return p=i.prototype,e}(t.Player);t.MainPlayer=e,egret.registerClass(e,"data.MainPlayer")}(data||(data={}));var data;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,t.IsRobot_Offline=!1,t.IsInNative=!1,t.IsDebug=!0,t.IsPrompt=!0,t.IsActivityKick=!1,t.SERVER_IP="http://dmhd123.f3322.net:8000/getGateServer",t.SERVER_URL="127.0.0.1:8001",t.GameFlag_offline=0,t.GameFlag_Rapid=1,t.GameFlag_Activity=2,t.GameFlag_Group=3,t.GameFlag_Challenge="challenge",t.GameFlag_Defender="defender",t.token="",t.flag=0,t.userid="",t.groupid="",t.nickname="",t.avatar="",t.integral=0,t.money=0,t.playerGuid=0,t.IsAuto=!1,t}();t.GameData=e,egret.registerClass(e,"data.GameData")}(data||(data={}));var data;!function(t){var e=function(){function t(){this.SoundBG_Volume=1,this.SoundMusic_Volume=1,this.RecordObj={}}var e=(__define,t);return p=e.prototype,p.InitThis=function(t){for(var e in t)this.hasOwnProperty(e)&&(this[e]=t[e])},p.Clone=function(){var t={};return t.SoundBG_Volume=this.SoundBG_Volume,t.SoundMusic_Volume=this.SoundMusic_Volume,t.RecordObj=this.RecordObj,t},t}();t.LocalData=e,egret.registerClass(e,"data.LocalData")}(data||(data={}));var enums;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,t.NATIVEEVENT_GETINITINFO="NATIVEEVENT_GETINITINFO",t}();t.NativeEvent=e,egret.registerClass(e,"enums.NativeEvent")}(enums||(enums={}));var enums;!function(t){!function(t){t[t.NET_C2S_PING=4]="NET_C2S_PING",t[t.NET_CSC_LOGIN=5]="NET_CSC_LOGIN",t[t.NET_CSC_LOGIN_DEBUG=18]="NET_CSC_LOGIN_DEBUG",t[t.CLIENT_2_CENTER_LOGIN_OK=51]="CLIENT_2_CENTER_LOGIN_OK",t[t.CLIENT_2_CENTER_REQ_BATTLE=52]="CLIENT_2_CENTER_REQ_BATTLE",t[t.CLIENT_2_GAME_SENDCHAT=112]="CLIENT_2_GAME_SENDCHAT",t[t.CLIENT_2_GAME_READY=113]="CLIENT_2_GAME_READY",t[t.CLIENT_2_GAME_CALLLANDOWNER=114]="CLIENT_2_GAME_CALLLANDOWNER",t[t.CLIENT_2_GAME_SHOWCARD=115]="CLIENT_2_GAME_SHOWCARD",t[t.CLIENT_2_GAME_AUTO=116]="CLIENT_2_GAME_AUTO",t[t.GAME_CENTER_2_GAME_GAMERESULT=118]="GAME_CENTER_2_GAME_GAMERESULT",t[t.CLIENT_2_GAME_REQ_EXIT=120]="CLIENT_2_GAME_REQ_EXIT",t[t.CENTER_2_CLIENT_LOGIN_LOBBY=171]="CENTER_2_CLIENT_LOGIN_LOBBY",t[t.GAME_2_CLIENT_INIT_ROOM=172]="GAME_2_CLIENT_INIT_ROOM",t[t.GAME_2_CLIENT_OTHER_ENTER_ROOM=173]="GAME_2_CLIENT_OTHER_ENTER_ROOM",t[t.GAME_2_CLIENT_PLAYEROUT=174]="GAME_2_CLIENT_PLAYEROUT",t[t.GAME_2_CLIENT_SENDCHAT=175]="GAME_2_CLIENT_SENDCHAT",t[t.GAME_2_CLIENT_RREADY=176]="GAME_2_CLIENT_RREADY",t[t.GAME_2_CLIENT_SENDCARD=177]="GAME_2_CLIENT_SENDCARD",t[t.GAME_2_CLIENT_CALLLANDOWNER=178]="GAME_2_CLIENT_CALLLANDOWNER",t[t.GAME_2_CLIENT_TURNCALLLAND=179]="GAME_2_CLIENT_TURNCALLLAND",t[t.GAME_2_CLIENT_CALLLANDOVER=180]="GAME_2_CLIENT_CALLLANDOVER",t[t.GAME_2_CLIENT_TURNPLAY=181]="GAME_2_CLIENT_TURNPLAY",t[t.GAME_2_CLIENT_SHOWPLAY=182]="GAME_2_CLIENT_SHOWPLAY",t[t.GAME_2_CLIENT_AUTO=183]="GAME_2_CLIENT_AUTO",t[t.GAME_2_CLIENT_GAMEOVER=184]="GAME_2_CLIENT_GAMEOVER",t[t.GAME_2_CLIENT_WAIT_ACTIVITY_END=185]="GAME_2_CLIENT_WAIT_ACTIVITY_END",t[t.GATE_2_CLIENT_ACTIVITY_ONLINE=186]="GATE_2_CLIENT_ACTIVITY_ONLINE",t[t.CENTER_2_CLIENT_ADD_FREE_MONEY=187]="CENTER_2_CLIENT_ADD_FREE_MONEY"}(t.NetEnum||(t.NetEnum={}));t.NetEnum}(enums||(enums={}));var enums;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,t.NETEVENT_CONNECT="NETEVENT_CONNECT",t.NETEVENT_CLOSE="NETEVENT_CLOSE",t.NETEVENT_ERROR="NETEVENT_ERROR",t.NETEVENT_PING="NETEVENT_PING",t.NETEVENT_LOGINSUCESS="NETEVENT_LOGINSUCESS",t.NETEVENT_ROOMIN="NETEVENT_ROOMIN",t.NETEVENT_OTHERPLAYERIN="NETEVENT_PLAYERIN",t.NETEVENT_SENDCARD="NETEVENT_SENDCARD",t.NETEVENT_TURNCALLLAND="NETEVENT_TURNCALLLAND",t.NETEVENT_OTHERCALLLAND="NETEVENT_OTHERCALLLAND",t.NETEVENT_CALLLANDOVER="NETEVENT_CALLLANDOVER",t.NETEVENT_TURNPALY="NETEVENT_TURNPALY",t.NETEVENT_SHOWPALY="NETEVENT_SHOWPALY",t.NETEVENT_GAMEOVER="NETEVENT_GAMEOVER",t.NETEVENT_SENDCHAT="NETEVENT_SENDCHAT",t.NETEVENT_READY="NETEVENT_READY",t.NETEVENT_PLAYEROUT="NETEVENT_PLAYEROUT",t.NETEVENT_AUTO="NETEVENT_AUTO",t.NETEVENT_ACTIVITYONLINE="NETEVENT_ACTIVITYONLINE",t.NETEVENT_WAITACTIVITYEND="NETEVENT_WAITACTIVITYEND",t.NETEVENT_LOBBYIN="NETEVENT_LOBBYIN",t.NETEVENT_ADDFREEMONEY="NETEVENT_ADDFREEMONEY",t}();t.NetEvent=e,egret.registerClass(e,"enums.NetEvent")}(enums||(enums={}));var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,e.reconnect=function(){e.instance.preloadover(null)},p.onAddToStage=function(){Config.StageWidth=this.stage.stageWidth,Config.StageHeight=this.stage.stageHeight,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,LayerMgr.Instance.Init(this),this.setos(),windowui.LoadingInst.Instance.Show(),windowui.LoadingInst.Instance.SetText("正在打开游戏"),LoadMgr.Instance.Init(),LoadMgr.Instance.addEventListener(LoadMgr.LOADOVER_PRELOAD,this.preloadover,this),LoadMgr.Instance.addEventListener(LoadMgr.LOADOVER_LOBBY,this.createScene,this),this.stage.addEventListener(egret.Event.RESIZE,this.resizefun,this),e.instance=this},p.setos=function(){var t=navigator.userAgent;t.indexOf("Android")>-1||t.indexOf("Linux")>-1?Config.System="Android":t.indexOf("iPhone")>-1?Config.System="iPhone":t.indexOf("Windows Phone")>-1?Config.System="Windows Phone":t.indexOf("Windows")>-1&&(Config.System="Windows")},p.resizefun=function(t){void 0===t&&(t=null);var e=this.stage.stageWidth,i=this.stage.stageHeight;trace("Main-resizefun->",e,i)},p.preloadover=function(){if(LoadMgr.Instance.removeEventListener(LoadMgr.LOADOVER_PRELOAD,this.preloadover,this),windowui.LoadingInst.Instance.setSkin(),windowui.LoadingInst.Instance.SetText("正在获取身份信息"),data.GameData.IsDebug){NativeMgr.Instance.addEventListener(enums.NativeEvent.NATIVEEVENT_GETINITINFO,this.onGetNativeInfo,this);var t=new egret.TextField;t.text="用户id:",t.textColor=16777215,t.textAlign=egret.HorizontalAlign.RIGHT,t.width=140,t.x=0,t.y=50;var i=new egret.TextField;i.type=egret.TextFieldType.INPUT,i.width=300,i.x=150,i.y=50,i.background=!0,i.textColor=16711680;var n=function(){var e={type:"getInitInfo",value:{userid:"userid"+i.text,nickName:i.text,avatar:"http://uc.9ria.com/data/avatar/000/06/11/49_avatar_middle.jpg",integral:"0"}};t.parent.removeChild(t),i.parent.removeChild(i);var n=JSON.stringify(e);NativeMgr.Instance.Native2JS(n)};i.addEventListener(egret.TextEvent.FOCUS_OUT,n,this),this.addChild(t),this.addChild(i)}else EgretSDKMgr.Instance.addEventListener(enums.NativeEvent.NATIVEEVENT_GETINITINFO,this.onGetNativeInfo,this),EgretSDKMgr.Instance.Init();e.textlog=new egret.TextField,e.textlog.touchEnabled=!1,this.addChild(e.textlog)},p.onGetNativeInfo=function(t){var e=t.data;data.GameData.IsDebug?(data.GameData.userid=e.userid,data.GameData.nickname=e.nickName,data.GameData.avatar=e.avatar):data.GameData.token=e.token,windowui.LoadingInst.Instance.SetText("正在获取服务器地址");var i=data.GameData.SERVER_IP,n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.TEXT;var s=new egret.URLRequest(i);s.method=egret.URLRequestMethod.GET,n.addEventListener(egret.Event.COMPLETE,this.onGetIpOver,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){data.GameData.IsRobot_Offline||(NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_CONNECT,this.onConnect,this),NetMgr.Instance.showDisTips(),n.load(s))},this),n.load(s)},p.onGetIpOver=function(t){var e=t.target,i=e.data.toString();return"-1"==i?(NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_CONNECT,this.onConnect,this),void NetMgr.Instance.showDisTips()):(data.GameData.SERVER_URL=i,trace("服务器地址获取成功"+i),windowui.LoadingInst.Instance.SetText("正在连接服务器"),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_CONNECT,this.onConnect,this),void NetMgr.Instance.Connect())},p.onConnect=function(){NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_CONNECT,this.onConnect,this),NetMgr.Instance.addEventListener(enums.NetEvent.NETEVENT_LOGINSUCESS,this.onLogin,this);var t={};t.time=egret.getTimer(),t.sign="sign",data.GameData.IsDebug?(t.userid=data.GameData.userid,t.nickname=data.GameData.nickname,t.avatar=data.GameData.avatar,NetMgr.Instance.SendMsg(enums.NetEnum.NET_CSC_LOGIN_DEBUG,t)):(t.token=data.GameData.token,NetMgr.Instance.SendMsg(enums.NetEnum.NET_CSC_LOGIN,t))},p.onLogin=function(t){var e=JSON.parse(t.data.value);data.GameData.playerGuid=e.guid,data.GameData.money=e.money,data.GameData.nickname=e.name,data.GameData.avatar=e.pic,NetMgr.Instance.removeEventListener(enums.NetEvent.NETEVENT_LOGINSUCESS,this.onLogin,this),LoadMgr.Instance.Load("lobby")},p.createScene=function(){LocalMgr.Instance.LoadData(),LoadMgr.Instance.removeEventListener(LoadMgr.LOADOVER_LOBBY,this.createScene,this),windowui.LoadingInst.Instance.Hide(),SceneMgr.Instance.ShowScene(scene.LobbyScene),NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_CENTER_LOGIN_OK)},e.instance=null,e.textlog=null,e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}var e=(__define,t);return p=e.prototype,p.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},p.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},p.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},p.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},p.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},p.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},p.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},p.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},p.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),s=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],s[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(s.concat(a),640))},p.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",r=0;r<t.length;r++)i=t.charCodeAt(r),s+=n.charAt(i>>>4&15)+n.charAt(15&i);return s},p.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",s=t.length,r=0;s>r;r+=3)for(var a=t.charCodeAt(r)<<16|(s>r+1?t.charCodeAt(r+1)<<8:0)|(s>r+2?t.charCodeAt(r+2):0),h=0;4>h;h++)n+=8*r+6*h>8*t.length?this.b64pad:i.charAt(a>>>6*(3-h)&63);return n},p.rstr2any=function(t,e){var i,n,s,r,a,h=e.length,l=Array(Math.ceil(t.length/2));for(i=0;i<l.length;i++)l[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var o=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),_=Array(o);for(n=0;o>n;n++){for(a=Array(),r=0,i=0;i<l.length;i++)r=(r<<16)+l[i],s=Math.floor(r/h),r-=s*h,(a.length>0||s>0)&&(a[a.length]=s);_[n]=r,l=a}var d="";for(i=_.length-1;i>=0;i--)d+=e.charAt(_[i]);return d},p.str2rstr_utf8=function(t){for(var e,i,n="",s=-1;++s<t.length;)e=t.charCodeAt(s),i=s+1<t.length?t.charCodeAt(s+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),s++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},p.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},p.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},p.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},p.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},p.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,s=-1732584194,r=271733878,a=0;a<t.length;a+=16){var h=i,l=n,o=s,_=r;i=this.md5_ff(i,n,s,r,t[a+0],7,-680876936),r=this.md5_ff(r,i,n,s,t[a+1],12,-389564586),s=this.md5_ff(s,r,i,n,t[a+2],17,606105819),n=this.md5_ff(n,s,r,i,t[a+3],22,-1044525330),i=this.md5_ff(i,n,s,r,t[a+4],7,-176418897),r=this.md5_ff(r,i,n,s,t[a+5],12,1200080426),s=this.md5_ff(s,r,i,n,t[a+6],17,-1473231341),n=this.md5_ff(n,s,r,i,t[a+7],22,-45705983),i=this.md5_ff(i,n,s,r,t[a+8],7,1770035416),r=this.md5_ff(r,i,n,s,t[a+9],12,-1958414417),s=this.md5_ff(s,r,i,n,t[a+10],17,-42063),n=this.md5_ff(n,s,r,i,t[a+11],22,-1990404162),i=this.md5_ff(i,n,s,r,t[a+12],7,1804603682),r=this.md5_ff(r,i,n,s,t[a+13],12,-40341101),s=this.md5_ff(s,r,i,n,t[a+14],17,-1502002290),n=this.md5_ff(n,s,r,i,t[a+15],22,1236535329),i=this.md5_gg(i,n,s,r,t[a+1],5,-165796510),r=this.md5_gg(r,i,n,s,t[a+6],9,-1069501632),s=this.md5_gg(s,r,i,n,t[a+11],14,643717713),n=this.md5_gg(n,s,r,i,t[a+0],20,-373897302),i=this.md5_gg(i,n,s,r,t[a+5],5,-701558691),r=this.md5_gg(r,i,n,s,t[a+10],9,38016083),s=this.md5_gg(s,r,i,n,t[a+15],14,-660478335),n=this.md5_gg(n,s,r,i,t[a+4],20,-405537848),i=this.md5_gg(i,n,s,r,t[a+9],5,568446438),r=this.md5_gg(r,i,n,s,t[a+14],9,-1019803690),s=this.md5_gg(s,r,i,n,t[a+3],14,-187363961),n=this.md5_gg(n,s,r,i,t[a+8],20,1163531501),i=this.md5_gg(i,n,s,r,t[a+13],5,-1444681467),r=this.md5_gg(r,i,n,s,t[a+2],9,-51403784),s=this.md5_gg(s,r,i,n,t[a+7],14,1735328473),n=this.md5_gg(n,s,r,i,t[a+12],20,-1926607734),i=this.md5_hh(i,n,s,r,t[a+5],4,-378558),r=this.md5_hh(r,i,n,s,t[a+8],11,-2022574463),s=this.md5_hh(s,r,i,n,t[a+11],16,1839030562),n=this.md5_hh(n,s,r,i,t[a+14],23,-35309556),i=this.md5_hh(i,n,s,r,t[a+1],4,-1530992060),r=this.md5_hh(r,i,n,s,t[a+4],11,1272893353),s=this.md5_hh(s,r,i,n,t[a+7],16,-155497632),n=this.md5_hh(n,s,r,i,t[a+10],23,-1094730640),i=this.md5_hh(i,n,s,r,t[a+13],4,681279174),r=this.md5_hh(r,i,n,s,t[a+0],11,-358537222),s=this.md5_hh(s,r,i,n,t[a+3],16,-722521979),n=this.md5_hh(n,s,r,i,t[a+6],23,76029189),i=this.md5_hh(i,n,s,r,t[a+9],4,-640364487),r=this.md5_hh(r,i,n,s,t[a+12],11,-421815835),s=this.md5_hh(s,r,i,n,t[a+15],16,530742520),n=this.md5_hh(n,s,r,i,t[a+2],23,-995338651),i=this.md5_ii(i,n,s,r,t[a+0],6,-198630844),r=this.md5_ii(r,i,n,s,t[a+7],10,1126891415),s=this.md5_ii(s,r,i,n,t[a+14],15,-1416354905),n=this.md5_ii(n,s,r,i,t[a+5],21,-57434055),i=this.md5_ii(i,n,s,r,t[a+12],6,1700485571),r=this.md5_ii(r,i,n,s,t[a+3],10,-1894986606),s=this.md5_ii(s,r,i,n,t[a+10],15,-1051523),n=this.md5_ii(n,s,r,i,t[a+1],21,-2054922799),i=this.md5_ii(i,n,s,r,t[a+8],6,1873313359),r=this.md5_ii(r,i,n,s,t[a+15],10,-30611744),s=this.md5_ii(s,r,i,n,t[a+6],15,-1560198380),n=this.md5_ii(n,s,r,i,t[a+13],21,1309151649),i=this.md5_ii(i,n,s,r,t[a+4],6,-145523070),r=this.md5_ii(r,i,n,s,t[a+11],10,-1120210379),s=this.md5_ii(s,r,i,n,t[a+2],15,718787259),n=this.md5_ii(n,s,r,i,t[a+9],21,-343485551),i=this.safe_add(i,h),n=this.safe_add(n,l),s=this.safe_add(s,o),r=this.safe_add(r,_)}return[i,n,s,r]},p.md5_cmn=function(t,e,i,n,s,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,r)),s),i)},p.md5_ff=function(t,e,i,n,s,r,a){return this.md5_cmn(e&i|~e&n,t,e,s,r,a)},p.md5_gg=function(t,e,i,n,s,r,a){return this.md5_cmn(e&n|i&~n,t,e,s,r,a)},p.md5_hh=function(t,e,i,n,s,r,a){return this.md5_cmn(e^i^n,t,e,s,r,a)},p.md5_ii=function(t,e,i,n,s,r,a){return this.md5_cmn(i^(e|~n),t,e,s,r,a)},p.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},p.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();egret.registerClass(md5,"md5");var net;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.connet=function(t){this._socket=new egret.WebSocket,this._socket.type=egret.WebSocket.TYPE_STRING,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),this._socket.connectByUrl("ws://"+t)},i(p,"IsConnect",function(){return this._socket.connected}),p.sendDataByByte=function(){var t=new egret.ByteArray;t.writeUTF("Hello Egret WebSocket"),t.writeBoolean(!1),t.writeInt(123),t.position=0,this._socket.writeBytes(t,0,t.bytesAvailable)},p.sendDataByString=function(t){this._socket.writeUTF(t)},p.onSocketOpen=function(){this.dispatchEvent(new egret.Event(e.Event_Open))},p.onSocketClose=function(){this.dispatchEvent(new egret.Event(e.Event_Close))},p.onSocketError=function(){this.dispatchEvent(new egret.Event(e.Event_Error))},p.onReceiveMessage=function(){if(this._socket.type==egret.WebSocket.TYPE_BINARY){var t=new egret.ByteArray;this._socket.readBytes(t);var e=t.readUTF(),i=t.readBoolean(),n=t.readInt();trace("SocketBase::onSocketClose->收到数据"),trace("SocketBase::onSocketClose->readUTF : "+e),trace("SocketBase::onSocketClose->readBoolean : "+i.toString()),trace("SocketBase::onSocketClose->readInt : "+n.toString())}else if(this._socket.type==egret.WebSocket.TYPE_STRING){var s=this._socket.readUTF();trace("SocketBase::onReceiveMessage->"+s),NetMgr.Instance.OnMessage(s)}},p.Close=function(){null!=this._socket&&this._socket.close()},e.Event_Open="Event_Open",e.Event_Close="onSocketClose",e.Event_Error="onSocketError",e}(egret.EventDispatcher);t.SocketBase=e,egret.registerClass(e,"net.SocketBase")}(net||(net={}));var net;!function(t){var e=function(){function t(){}var e=(__define,t);return p=e.prototype,p.connet=function(t){this._socket=window.io.connect(t),console.info(this._socket);var e=this;this._socket.on("connect",function(){e.onConnect()}),this._socket.on("push message",function(t){e.onMsg(t)})},p.onConnect=function(){this.SendMsg({type:"sit"})},p.SendMsg=function(t){this._socket.emit("message",t)},p.onMsg=function(t){console.info(t)},t}();t.SocketIO=e,egret.registerClass(e,"net.SocketIO")}(net||(net={}));var effect;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(){try{if(this.touchChildren=!1,this.touchEnabled=!1,null==this._mc1){var t=new egret.MovieClipDataFactory(RES.getRes("effect_json"),RES.getRes("effect_png"));this._mc1=new egret.MovieClip(t.generateMovieClipData("bomb"))}this._mc1.addEventListener(egret.Event.ENTER_FRAME,this.mc1frame,this),this.addChild(this._mc1),this._mc1.gotoAndPlay(1),this._mc1.x=320,this._mc1.y=500}catch(e){this.Release()}},p.Update=function(){},p.mc1frame=function(){try{this._mc1.currentFrame==this._mc1.totalFrames&&this.Release()}catch(t){this.Release()}},p.Release=function(){this._mc1&&(this._mc1.gotoAndStop(1),this._mc1.removeEventListener(egret.Event.ENTER_FRAME,this.mc1frame,this),this._mc1.parent&&this._mc1.parent.removeChild(this._mc1))},e}(egret.Sprite);t.BombEffect=e,egret.registerClass(e,"effect.BombEffect",["IRelease","IUpdate","IInit"])}(effect||(effect={}));var effect;!function(t){var e=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(){try{if(this.touchChildren=!1,this.touchEnabled=!1,null==this._mc1){var t=new egret.MovieClipDataFactory(RES.getRes("effect_json"),RES.getRes("effect_png"));this._mc1=new egret.MovieClip(t.generateMovieClipData("plane"))}this.addChild(this._mc1),this._mc1.gotoAndPlay(1,-1),this._mc1.x=640,this._mc1.y=400}catch(e){this.Release()}},p.Update=function(){this._mc1.x-=10,this._mc1.x<-300&&this.Release()},p.Release=function(){this._mc1&&(this._mc1.gotoAndStop(1),this._mc1.parent&&this._mc1.parent.removeChild(this._mc1))},e}(egret.Sprite);t.PlaneEffect=e,egret.registerClass(e,"effect.PlaneEffect",["IRelease","IUpdate","IInit"])}(effect||(effect={}));var scene;!function(t){var e=function(e){function i(){e.call(this),this._gameoverAniProxy=null,this._chatMsgProxy=null,this._sendCardAniProxy=null,this._mycardProxy=null,this._tableCardProxy=null,this._btnProxy=null,this._uiProxy=null,this._uiSprite=null,this._btnSprite=null,this._sendSprite=null,this._cardSprite=null,this._tableSprite=null,this._effectSprite=null,this._chatSprite=null,this._effectList=null,this._type=new controller.game.Types,this._lastSendPing=0}__extends(i,e);var n=(__define,i);return p=n.prototype,p.Init=function(){var e=new egret.Bitmap(RES.getRes("bg_game_jpg"));this.addChild(e),e.touchEnabled=!1,this._effectList=[],this._uiSprite=new egret.Sprite,this.addChild(this._uiSprite),this._tableSprite=new egret.Sprite,this.addChild(this._tableSprite),this._tableSprite.touchChildren=!1,this._tableSprite.touchEnabled=!1,this._cardSprite=new egret.Sprite,this.addChild(this._cardSprite),this._sendSprite=new egret.Sprite,this.addChild(this._sendSprite),this._sendSprite.touchChildren=!1,this._sendSprite.touchEnabled=!1,this._btnSprite=new egret.Sprite,this.addChild(this._btnSprite),this._overAniSprite=new egret.Sprite,this.addChild(this._overAniSprite),this._overAniSprite.touchChildren=!1,this._overAniSprite.touchEnabled=!1,this._effectSprite=new egret.Sprite,this._effectSprite.touchChildren=!1,this._effectSprite.touchEnabled=!1,this.addChild(this._effectSprite),this._chatSprite=new egret.Sprite,this.addChild(this._chatSprite),this._chatSprite.touchChildren=!1,this._chatSprite.touchEnabled=!1,this._tableCardProxy=new t.TableCardProxy,this._tableCardProxy.Init(this._tableSprite),this._uiProxy=new t.GameUIProxy,this._uiProxy.Init(this._uiSprite),this._btnProxy=new t.GameBtnProxy,this._btnProxy.Init(this._btnSprite),this._chatMsgProxy=new t.ChatMsgProxy,this._chatMsgProxy.Init(this._chatSprite),this._sendCardAniProxy=new t.SendCardAniProxy,this._sendCardAniProxy.Init(this._sendSprite),this._mycardProxy=new t.MyCardProxy,this._mycardProxy.Init(this._cardSprite),this._gameoverAniProxy=new t.GameOverAniProxy,this._gameoverAniProxy.Init(this._overAniSprite),windowui.SysTipsInst.Instance.Show("正在进入房间"),this.addEventListener(egret.Event.ENTER_FRAME,this.Update,this),SoundMgr.Instance.PlaySound("bg_lobby_mp3")
},p.ReStart=function(){this._uiProxy.RoomIn([]),this._btnProxy.RoomIn(),this._mycardProxy.Visible=!1,this._tableCardProxy.clearAll(!0)},p.RoomIn=function(t){windowui.SysTipsInst.Instance.Hide();var e=t;this._uiProxy.RoomIn(e),this._btnProxy.RoomIn(),this._tableCardProxy.clearAll(),this._mycardProxy.Release(),this._sendCardAniProxy.Release(0)},p.AddFreeMoney=function(){this._uiProxy.RefreshPlayerInfo()},p.ReNet=function(t,e,i,n){this._tableCardProxy.ShowLandCard(t),this._sendCardAniProxy.Release(0),this._mycardProxy.SetMainPlayer(i),this._btnProxy.SetCardProxy(this._mycardProxy),this._mycardProxy.SetBtnProxy(this._btnProxy),this._uiProxy.SetTimes(n),this._btnProxy.HideAll(),this._uiProxy.SendCard(),e&&(this._uiProxy.SetPlayerLandFlag(e.LocalTableId),this._mycardProxy.SetPlayerLandFlag(e.LocalTableId)),this._uiProxy.UpdateAllCardNum()},p.PlayerIn=function(t){this._uiProxy.SetPlayerHead(t,!0)},p.PlayerOut=function(t){this._uiProxy.RemovePlayerHead(t)},p.SetAuto=function(t,e){this._btnProxy.SetPlayerAuto(t,e)},p.SetReady=function(t,e,i){i&&this._btnProxy.HideAll(),this._uiProxy.SetPlayerReady(t,e),this._chatMsgProxy.ShowTableCard(t,"准备")},p.SendCard=function(e){windowui.ResoultInst.Instance.Hide(),windowui.ActivityResoultInst.Instance.Hide(),this._uiProxy.SendCard(),this._btnProxy.HideAll(),this._sendCardAniProxy.StartAni(e,function(){this._btnProxy.State!=t.GameBtnProxy.STATE_Qiangdizhu&&this._btnProxy.State!=t.GameBtnProxy.STATE_Playing&&this._btnProxy.HideAll()},this)},p.TurnCallLand=function(t,e,i,n){e?this._btnProxy.CallLandOwner(i):this._btnProxy.HideAll(),this._uiProxy.SetPlayerTime(t,n),this._uiProxy.UpdateAllCardNum()},p.ShowCallLand=function(t,e){this._chatMsgProxy.ShowTableCard(e,t+"分")},p.CallLandOver=function(t,e,i,n){this._tableCardProxy.ShowLandCard(e),this._uiProxy.SetPlayerLandFlag(t.LocalTableId),this._mycardProxy.SetPlayerLandFlag(t.LocalTableId),this._sendCardAniProxy.Release(t.LocalTableId),this._mycardProxy.SetMainPlayer(i),this._btnProxy.SetCardProxy(this._mycardProxy),this._mycardProxy.SetBtnProxy(this._btnProxy),this._uiProxy.SetTimes(n)},p.TurnPlay=function(t,e,i,n,s,r,a){if(void 0===a&&(a=null),i&&(this._sendCardAniProxy.Release(0),this._tableCardProxy.clearAll(),this._mycardProxy.SetTableList([]),a&&this._tableCardProxy.ShowTableCard(a.LocalTableId,null)),e){this._mycardProxy.SetTableList(n),a&&this._tableCardProxy.ShowTableCard(a.LocalTableId,n),this._mycardProxy.CanShowAll=r;if(this._btnProxy.Playing(i),this._mycardProxy.SetBtnVisible(),1==t.CardNum&&t.CardNum<n.length)return NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SHOWCARD,{cardlist:[]}),void this._btnProxy.HideAll()}else this._btnProxy.HideAll();this._uiProxy.SetPlayerTime(t,s),this._uiProxy.UpdateAllCardNum()},p.ShowPlay=function(t,e,i,n){this._uiProxy.UpdateAllCardNum(),i&&this._mycardProxy.SendOver(),null!=e&&e.length>0?(this._tableCardProxy.ShowTableCard(t.LocalTableId,e),this._mycardProxy.SetTableList(e)):(this._tableCardProxy.ShowTableCard(t.LocalTableId,e),this._chatMsgProxy.ShowTableCard(t.LocalTableId,"不要")),this._uiProxy.SetTimes(n);var s=this._type.GetType(e);if(s.Type==controller.game.Types.Types_Bomb){var r=MandPool.getIns(effect.BombEffect);r.Init(),this._effectSprite.addChild(r),this._effectList.push(r)}else if(s.Type==controller.game.Types.Types_ThreeN_Double||s.Type==controller.game.Types.Types_ThreeN_Signal||s.Type==controller.game.Types.Types_ThreeN){var a=MandPool.getIns(effect.PlaneEffect);a.Init(),this._effectSprite.addChild(a),this._effectList.push(a)}s.PlaySound()},p.GameOver=function(t,e,i,n,s,r,a,h,l,o,_){this._uiProxy.SetTimes(r),this._btnProxy.HideAll(),this._uiProxy.GameOver();var d=this._type.GetType(_.CardArr);return d.PlaySound(),a?(windowui.SysTipsInst.Instance.Hide(),windowui.ActivityOverInst.Instance.InitInfo(a,h,l,o),void windowui.ActivityOverInst.Instance.Show()):data.GameData.IsActivityKick?(this.ReStart(),void windowui.SysTipsInst.Instance.Show("您的比赛积分不足,无法继续游戏,欢迎下次再次挑战",function(){NativeMgr.Instance.ExitWindow()},this,!0,"退出游戏")):(e&&this._tableCardProxy.ShowTableCard(1,e.CardArr),i&&this._tableCardProxy.ShowTableCard(2,i.CardArr),n&&(this._tableCardProxy.ShowTableCard(3,n.CardArr),this._mycardProxy.Release()),this._gameoverAniProxy.Start(e.ResoultScore,i.ResoultScore,n.ResoultScore),void egret.setTimeout(function(){data.GameData.flag==data.GameData.GameFlag_Activity?(windowui.ActivityResoultInst.Instance.InitInfo(n,e,i,s,h,l,o),windowui.ActivityResoultInst.Instance.Show()):(windowui.ResoultInst.Instance.InitInfo(n,e,i,t),windowui.ResoultInst.Instance.Show())},this,3500))},p.PlayChat=function(t,e){this._chatMsgProxy.ShowTableCard(t,e)},p.PlayHouseRunning=function(t){this._uiProxy.PushHouseRunning(t)},p.Update=function(){if(0!=NetMgr.Instance.IsConnect){{egret.getTimer()}this._uiProxy.Update();for(var t in this._effectList)if(this._effectList[t]&&this._effectList[t].Update(),null==this._effectList[t].parent){var e=this._effectList.splice(t,1);MandPool.remand(e[0])}}},p.Release=function(){this.ReStart(),this._uiProxy.Release(),this._btnProxy.Release(),this._tableCardProxy.clearAll(),this._mycardProxy.Release(),this._sendCardAniProxy.Release(0),e.prototype.Release.call(this)},i}(t.SceneBase);t.GameScene=e,egret.registerClass(e,"scene.GameScene")}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(){e.call(this),this._txt_money=null,this._txt_name=null,this._head=null,this._btn_lianwang=null,this._btn_haoyou=null,this._btn_danji=null,this._btn_jingji=null,this._setting=null,this._chong=null,this._dui=null}__extends(i,e);var n=(__define,i);return p=n.prototype,p.Init=function(){var e=new egret.Bitmap(RES.getRes("bg_lobby_jpg"));this.addChild(e),this._setting=new t.SButton("btn_setting"),this.addChild(this._setting),this._setting.x=338,this._setting.y=17,this._chong=new t.SButton("btn_chong"),this.addChild(this._chong),this._chong.x=400,this._chong.y=17,this._dui=new t.SButton("btn_dui"),this.addChild(this._dui),this._dui.x=462,this._dui.y=17,this._head=new t.PlayerHeadFrame,this.addChild(this._head),this._head.Init(data.GameData.avatar),this._head.x=2,this._head.y=2,this._head.scaleX=this._head.scaleY=.7,this._txt_name=new egret.TextField,this._txt_name.size=20,this._txt_name.textColor=15120768,this._txt_name.text=data.GameData.nickname,this.addChild(this._txt_name),this._txt_name.x=78,this._txt_name.y=12,this._txt_money=new egret.TextField,this._txt_money.size=20,this._txt_money.textColor=15120768,this._txt_money.text=""+data.GameData.money,this.addChild(this._txt_money),this._txt_money.x=105,this._txt_money.y=43,this._btn_lianwang=new t.SButton("btn_lianwang"),this.addChild(this._btn_lianwang),this._btn_lianwang.SetBitTxt("123456789人"),this._btn_lianwang.x=73,this._btn_lianwang.y=150,this._btn_haoyou=new t.SButton("btn_haoyou"),this.addChild(this._btn_haoyou),this._btn_haoyou.SetBitTxt("123456789人"),this._btn_haoyou.x=73,this._btn_haoyou.y=388,this._btn_danji=new t.SButton("btn_danji"),this.addChild(this._btn_danji),this._btn_danji.x=73,this._btn_danji.y=632,this._btn_jingji=new t.SButton("btn_jingji"),this._btn_jingji.SetBitTxt("123456789人"),this._btn_jingji.SetBitTxt("12：00开始5倍"),this.addChild(this._btn_jingji),this._btn_jingji.x=73,this._btn_jingji.y=884,this._setting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._chong.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._dui.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._btn_lianwang.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._btn_haoyou.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._btn_danji.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._btn_jingji.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},p.AddFreeMoney=function(){this._txt_money.text=""+data.GameData.money},p.onTap=function(e){e.currentTarget==this._setting?windowui.SettingInst.Instance.Show():e.currentTarget==this._chong?windowui.ChargeInst.Instance.Show():e.currentTarget==this._dui?windowui.SysTipsInst.Instance.Show("奖品兑换功能将会不定期开放,请保持关注!",function(){windowui.SysTipsInst.Instance.Hide()},null,!0):e.currentTarget==this._btn_lianwang?(data.GameData.IsRobot_Offline=!1,data.GameData.flag=data.GameData.GameFlag_Rapid,NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_CENTER_REQ_BATTLE,{flagId:data.GameData.GameFlag_Rapid}),SceneMgr.Instance.ShowScene(t.GameScene)):e.currentTarget==this._btn_haoyou?(data.GameData.IsRobot_Offline=!1,windowui.CreatRoomInst.Instance.Show()):e.currentTarget==this._btn_danji?(data.GameData.IsRobot_Offline=!0,data.GameData.flag=data.GameData.GameFlag_offline,SceneMgr.Instance.ShowScene(t.GameScene)):e.currentTarget==this._btn_jingji&&(data.GameData.IsRobot_Offline=!1,data.GameData.flag=data.GameData.GameFlag_Activity,NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_CENTER_REQ_BATTLE,{flagId:data.GameData.GameFlag_Activity}),SceneMgr.Instance.ShowScene(t.GameScene))},i}(t.SceneBase);t.LobbyScene=e,egret.registerClass(e,"scene.LobbyScene")}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this._bg_1=null,this._bg_2=null,this._bg_3=null,this._chat_1=null,this._chat_2=null,this._chat_3=null,this._txt_1=null,this._txt_2=null,this._txt_3=null,this._face_1=null,this._face_2=null,this._face_3=null,this._gameScene=null}var e=(__define,t);return p=e.prototype,p.Init=function(t){this._gameScene=t,this._gameScene.touchChildren=!1,this._gameScene.touchEnabled=!1,this._chat_1=new egret.Sprite,this._chat_2=new egret.Sprite,this._chat_3=new egret.Sprite,this._bg_1=new egret.Bitmap(RES.getRes("ui_chat_left")),this._bg_1.scale9Grid=new egret.Rectangle(95,34,200,10),this._chat_1.addChild(this._bg_1),this._bg_2=new egret.Bitmap(RES.getRes("ui_chat_right")),this._bg_2.scale9Grid=new egret.Rectangle(95,34,200,10),this._chat_2.addChild(this._bg_2),this._bg_3=new egret.Bitmap(RES.getRes("ui_chat_left")),this._bg_3.scale9Grid=new egret.Rectangle(95,34,200,10),this._chat_3.addChild(this._bg_3);var e=new egret.TextField;e.textAlign=egret.HorizontalAlign.CENTER,e.x=28,e.y=18,e.textColor=8407059,this._chat_1.addChild(e),this._txt_1=e;var e=new egret.TextField;e.textAlign=egret.HorizontalAlign.CENTER,e.x=8,e.y=18,e.textColor=8407059,this._chat_2.addChild(e),this._txt_2=e;var e=new egret.TextField;e.textAlign=egret.HorizontalAlign.CENTER,e.x=28,e.y=18,e.textColor=8407059,this._chat_3.addChild(e),this._txt_3=e,this._face_1=new egret.Sprite,this._face_2=new egret.Sprite,this._face_3=new egret.Sprite,this._gameScene.addChild(this._chat_1),this._gameScene.addChild(this._chat_2),this._gameScene.addChild(this._chat_3),this._gameScene.addChild(this._face_1),this._gameScene.addChild(this._face_2),this._gameScene.addChild(this._face_3),this._chat_1.x=150,this._chat_1.y=100,this._chat_2.x=200,this._chat_2.y=200,this._chat_3.x=220,this._chat_3.y=500,this._face_1.x=150,this._face_1.y=150,this._face_2.x=320,this._face_2.y=150,this._face_3.x=220,this._face_3.y=500,this._chat_1.visible=!1,this._chat_2.visible=!1,this._chat_3.visible=!1,this._face_1.visible=!1,this._face_2.visible=!1,this._face_3.visible=!1,this._chat_1.cacheAsBitmap=!0,this._chat_2.cacheAsBitmap=!0,this._chat_3.cacheAsBitmap=!0,this._face_1.visible=!1,this._face_2.visible=!1,this._face_3.visible=!1},p.ShowTableCard=function(t,e){e.indexOf("ani_chat_")>=0?this["initface_"+t]&&this["initface_"+t](e):this["init_"+t]&&this["init_"+t](e)},p.init_1=function(e){this._chat_1.visible=!0,egret.Tween.removeTweens(this._chat_1),this._txt_1.text=e,this._txt_1.width=320,this._txt_1.width=this._txt_1.textWidth,this._txt_1.width>280?this._txt_1.width=280:this._txt_1.width<120&&(this._txt_1.width=120),this._bg_1.width=this._txt_1.width+80,this._bg_1.height=this._txt_1.height+40,this._txt_1.x=this._bg_1.width-this._txt_1.width-20,this._chat_1.x=150,this._chat_1.y=100,this._chat_1.alpha=1,egret.Tween.get(this._chat_1).to({},t.flyTime).call(function(){this._chat_1.visible=!1},this)},p.init_2=function(e){this._chat_2.visible=!0,egret.Tween.removeTweens(this._chat_2),this._txt_2.text=e,this._txt_2.width=320,this._txt_2.width=this._txt_2.textWidth,this._txt_2.width>280?this._txt_2.width=280:this._txt_2.width<120&&(this._txt_2.width=120),this._bg_2.width=this._txt_2.width+80,this._bg_2.height=this._txt_2.height+40,this._chat_2.x=500-this._bg_2.width,this._chat_2.y=200,this._chat_2.alpha=1,egret.Tween.get(this._chat_2).to({},t.flyTime).call(function(){this._chat_2.visible=!1},this)},p.init_3=function(e){this._chat_3.visible=!0,egret.Tween.removeTweens(this._chat_3),this._txt_3.text=e,this._txt_3.width=320,this._txt_3.width=this._txt_3.textWidth,this._txt_3.width>280?this._txt_3.width=280:this._txt_3.width<120&&(this._txt_3.width=120),this._bg_3.width=this._txt_3.width+80,this._bg_3.height=this._txt_3.height+40,this._txt_3.x=this._bg_3.width-this._txt_3.width-20,this._chat_3.x=Config.StageWidth/2-this._bg_3.width/2,this._chat_3.y=500,this._chat_3.alpha=1,egret.Tween.get(this._chat_3).to({},t.flyTime).call(function(){this._chat_3.visible=!1},this)},p.initface_1=function(e){this._face_1.visible=!0,egret.Tween.removeTweens(this._face_1),this._face_1.removeChildren(),this._face_1.x=180,this._face_1.y=150,this._face_1.alpha=1;var i=new egret.MovieClipDataFactory(RES.getRes(e+"_json"),RES.getRes(e+"_png")),n=new egret.MovieClip(i.generateMovieClipData("chat"));n.name="chat_facemc1",this._face_1.addChild(n),n.play(10),egret.Tween.get(this._face_1).to({},t.flyTime).call(function(){this._face_1.visible=!1,this._face_1.removeChildren()},this)},p.initface_2=function(e){this._face_2.visible=!0,egret.Tween.removeTweens(this._face_2),this._face_2.removeChildren(),this._face_2.x=380,this._face_2.y=150,this._face_2.alpha=1;var i=new egret.MovieClipDataFactory(RES.getRes(e+"_json"),RES.getRes(e+"_png")),n=new egret.MovieClip(i.generateMovieClipData("chat"));n.name="chat_facemc1",this._face_2.addChild(n),n.play(10),egret.Tween.get(this._face_2).to({},t.flyTime).call(function(){this._face_2.visible=!1,this._face_2.removeChildren()},this)},p.initface_3=function(e){this._face_3.visible=!0,egret.Tween.removeTweens(this._face_3),this._face_3.removeChildren(),this._face_3.x=250,this._face_3.y=500,this._face_3.alpha=1;var i=new egret.MovieClipDataFactory(RES.getRes(e+"_json"),RES.getRes(e+"_png")),n=new egret.MovieClip(i.generateMovieClipData("chat"));n.name="chat_facemc1",this._face_3.addChild(n),n.play(10),egret.Tween.get(this._face_3).to({},t.flyTime).call(function(){this._face_3.visible=!1,this._face_3.removeChildren()},this)},t.flyTime=3500,t}();t.ChatMsgProxy=e,egret.registerClass(e,"scene.ChatMsgProxy")}(scene||(scene={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._bgshap=null,this.IsShow=!1,this.createBaseView()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.createBaseView=function(){this._bgshap=new egret.Shape,this._bgshap.graphics.beginFill(0,.35),this._bgshap.graphics.drawRect(0,0,Config.StageWidth,Config.StageHeight),this._bgshap.graphics.endFill(),this._bgshap.touchEnabled=!0,this.addChild(this._bgshap)},p.Show=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.IsShow=!0},p.Hide=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];this.IsShow=!1},e}(egret.Sprite);t.WindowsBase=e,egret.registerClass(e,"windowui.WindowsBase",["IWindow"])}(windowui||(windowui={}));var scene;!function(t){var e=function(){function e(){this._state=0,this._gameScene=null,this._setting=null,this._autoing=null,this._exiting=null,this._talking=null,this._prompt=null,this._ready=null,this._callNo=null,this._call1=null,this._call2=null,this._call3=null,this._sendNo=null,this._sendReset=null,this._sendPromt=null,this._sendCard=null,this._currentDownSprite=null,this._callSprite=null,this._playSprite=null,this._readySprite=null,this._touchStart=null,this._objStart=null,this._myCardProxy=null}var i=__define,n=e;return p=n.prototype,i(p,"State",function(){return this._state}),p.SetCardProxy=function(t){this._myCardProxy=t},p.Init=function(e){this._gameScene=e,this._setting=new t.SButton("btn_setting"),LayerMgr.TopUI.addChild(this._setting),this._setting.x=338,this._setting.y=17,this._autoing=new t.SButton("btn_roomauto"),LayerMgr.TopUI.addChild(this._autoing),this._autoing.x=517,this._autoing.y=17,this._exiting=new t.SButton("btn_roomout"),LayerMgr.TopUI.addChild(this._exiting),this._exiting.x=583,this._exiting.y=17,this._talking=new t.SButton("ui_chat_btn"),this._gameScene.addChild(this._talking),this._talking.x=10,this._talking.y=1055,this._prompt=new t.SButton("ui_robot"),this._gameScene.addChild(this._prompt),this._prompt.ClickScale=!1,this._prompt.x=0,this._prompt.y=632,this.setBtnSprite(),this._exiting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._autoing.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._setting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._talking.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._prompt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)},p.SetPlayerAuto=function(t,e){3==t&&(this._prompt.visible=e,this._prompt.touchEnabled=e)},p.Playing=function(t){this._state=e.STATE_Playing,this._readySprite.visible=!1,this._callSprite.visible=!1,this._playSprite.visible=!0,this._sendNo.visible=!0,this._sendCard.visible=!0,this._sendNo.touchEnabled=!0,this._sendNo.SetBit("btn_buchu"),this._sendPromt.touchEnabled=!0,this._sendPromt.SetBit("btn_tishi"),this._sendCard.touchEnabled=!1,this._sendCard.SetBit("btn_chupai"),t&&(this._sendNo.SetBit("btn_buchu_no"),this._sendNo.touchEnabled=!1)},p.PlayingShow=function(t){t?(this._sendCard.SetBit("btn_chupai"),this._sendCard.touchEnabled=!0):(this._sendCard.SetBit("btn_chupai_no"),this._sendCard.touchEnabled=!1)},p.CallLandOwner=function(t){this._state=e.STATE_Qiangdizhu,this._readySprite.visible=!1,this._callSprite.visible=!0,this._playSprite.visible=!1,this._call1.touchEnabled=!0,this._call2.touchEnabled=!0,this._call3.touchEnabled=!0,this._callNo.touchEnabled=!0,this._call1.alpha=1,this._call2.alpha=1,this._call3.alpha=1,this._callNo.alpha=1,1==t?(this._call1.touchEnabled=!1,this._call1.alpha=.3):2==t&&(this._call1.touchEnabled=!1,this._call1.alpha=.3,this._call2.touchEnabled=!1,this._call2.alpha=.3)},p.HideAll=function(){this._state=e.STATE_HideAll,this._readySprite.visible=!1,this._callSprite.visible=!1,this._playSprite.visible=!1},p.RoomIn=function(){if(this._state=e.STATE_Ready,this._readySprite.visible=!0,this._callSprite.visible=!1,this._playSprite.visible=!1,SceneMgr.Instance.GetCurrentProxy()instanceof sceneproxy.GameSceneProxy){var t=SceneMgr.Instance.GetCurrentProxy().GetMainPlayer();t&&t.IsReady&&(this._readySprite.visible=!1)}},p.setBtnSprite=function(){this._callSprite=new egret.Sprite,this._callSprite.touchChildren=!0,this._callSprite.touchEnabled=!0,this._callSprite.x=0,this._callSprite.y=550,this._playSprite=new egret.Sprite,this._playSprite.touchChildren=!0,this._playSprite.touchEnabled=!0,this._playSprite.x=0,this._playSprite.y=550,this._readySprite=new egret.Sprite,this._readySprite.touchChildren=!0,this._readySprite.touchEnabled=!0,this._readySprite.x=255,this._readySprite.y=650,this._gameScene.addChild(this._callSprite),this._gameScene.addChild(this._playSprite),this._gameScene.addChild(this._readySprite),this._readySprite.visible=!0,this._callSprite.visible=!1,this._playSprite.visible=!1,this._ready=new t.SButton("btn_zhunbei",null,""),this._readySprite.addChild(this._ready),this._ready.SetTxt(40,16777215),this._ready.x=4,this._ready.y=20,this._callNo=new t.SButton("btn_bujiao",null,""),this._callSprite.addChild(this._callNo),this._callNo.x=20,this._callNo.y=0,this._call1=new t.SButton("btn_yifen",null,""),this._callSprite.addChild(this._call1),this._call1.x=224,this._call1.y=0,this._call2=new t.SButton("btn_erfen",null,""),this._callSprite.addChild(this._call2),this._call2.x=360,this._call2.y=0,this._call3=new t.SButton("btn_sanfen",null,""),this._callSprite.addChild(this._call3),this._call3.x=495,this._call3.y=0,this._sendNo=new t.SButton("btn_buchu",null,""),this._playSprite.addChild(this._sendNo),this._sendNo.x=20,this._sendNo.y=0,this._sendReset=new t.SButton("btn_chongxuan",null,""),this._playSprite.addChild(this._sendReset),this._sendReset.x=224,this._sendReset.y=0,this._sendPromt=new t.SButton("btn_tishi",null,""),this._playSprite.addChild(this._sendPromt),this._sendPromt.x=360,this._sendPromt.y=0,this._sendCard=new t.SButton("btn_chupai",null,""),this._playSprite.addChild(this._sendCard),this._sendCard.x=495,this._sendCard.y=0,this._sendReset.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._sendCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._sendPromt.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._sendNo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._call3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._call2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._call1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._callNo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1),this._ready.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this,!1)},p.onToouchBegin=function(t){this._touchStart=new egret.Point,this._objStart=new egret.Point,this._touchStart.x=t.stageX,this._touchStart.y=t.stageY,this._objStart.x=t.currentTarget.x,this._objStart.y=t.currentTarget.y,this._currentDownSprite=t.currentTarget},p.onToouchMove=function(t){if(t.currentTarget==this._currentDownSprite){var e=t.stageX,i=t.stageY,n=e-this._touchStart.x,s=i-this._touchStart.y;t.currentTarget.x=this._objStart.x+n,t.currentTarget.y=this._objStart.y+s,t.currentTarget.x>366&&(t.currentTarget.x=366),t.currentTarget.x<0&&(t.currentTarget.x=0),t.currentTarget.y<0&&(t.currentTarget.y=0),t.currentTarget.y>Config.StageHeight-t.currentTarget.height&&(t.currentTarget.y=Config.StageHeight-t.currentTarget.height),this._currentDownSprite.touchChildren=!1}},p.onToouchEnd=function(t){if(t.currentTarget==this._currentDownSprite){var e=t.stageX,i=t.stageY,n=e-this._touchStart.x,s=i-this._touchStart.y;t.currentTarget.x=this._objStart.x+n,t.currentTarget.y=this._objStart.y+s,this._touchStart=null,this._objStart=null,t.currentTarget.x>366&&(t.currentTarget.x=366),t.currentTarget.x<0&&(t.currentTarget.x=0),t.currentTarget.y<0&&(t.currentTarget.y=0),t.currentTarget.y>Config.StageHeight-t.currentTarget.height&&(t.currentTarget.y=Config.StageHeight-t.currentTarget.height),this._currentDownSprite.touchChildren=!0,this._currentDownSprite=null}},p.onTap=function(t){if(t.currentTarget==this._setting&&windowui.SettingInst.Instance.Show(),t.currentTarget==this._autoing&&0==this._prompt.visible&&NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_AUTO,{isauto:!0}),t.currentTarget==this._prompt&&NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_AUTO,{isauto:!1}),t.currentTarget==this._exiting)NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_REQ_EXIT,{});else if(t.currentTarget==this._talking)windowui.ChatInst.Instance.Show();else if(t.currentTarget==this._ready)NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_READY,{});else if(t.currentTarget==this._sendCard){var e=this._myCardProxy.GetWillShowList();if(null==e)return void trace("牌类型出错");NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SHOWCARD,{cardlist:e})}else if(t.currentTarget==this._sendPromt){var i=this._myCardProxy.getHasBigger();if(i){{this._myCardProxy.Prompt(!1,!0)}this._myCardProxy.SetBtnVisible()}else NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SHOWCARD,{cardlist:[]})}else t.currentTarget==this._sendReset?this._myCardProxy.Reset():t.currentTarget==this._sendNo?NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SHOWCARD,{cardlist:[]}):t.currentTarget==this._call3?(NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_CALLLANDOWNER,{score:3}),this.HideAll()):t.currentTarget==this._call2?(NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_CALLLANDOWNER,{score:2}),this.HideAll()):t.currentTarget==this._call1?(NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_CALLLANDOWNER,{score:1}),this.HideAll()):t.currentTarget==this._callNo&&(NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_CALLLANDOWNER,{score:0}),this.HideAll())},p.Release=function(){this._gameScene.removeChildren(),this._gameScene=null},e.STATE_HideAll=0,e.STATE_Qiangdizhu=1,e.STATE_Playing=2,e.STATE_Ready=3,e}();t.GameBtnProxy=e,egret.registerClass(e,"scene.GameBtnProxy",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(){function t(){this._gameScene=null,this._txt1=null,this._txt2=null,this._txt3=null}var e=(__define,t);return p=e.prototype,p.Init=function(t){this._gameScene=t,this._txt1=new egret.TextField,this._txt2=new egret.TextField,this._txt3=new egret.TextField,this._txt1.size=50,this._txt2.size=50,this._txt3.size=50,this._txt1.x=150,this._txt1.y=160,this._txt2.x=435,this._txt2.y=160,this._txt3.x=380,this._txt3.y=1060,this._txt1.stroke=2,this._txt1.strokeColor=0,this._txt2.stroke=2,this._txt2.strokeColor=0,this._txt3.stroke=2,this._txt3.strokeColor=0},p.Start=function(t,e,i){this._gameScene.removeChildren(),egret.Tween.removeTweens(this._txt1),egret.Tween.removeTweens(this._txt2),egret.Tween.removeTweens(this._txt3),this._txt1.x=150,this._txt1.y=160,this._txt2.x=435,this._txt2.y=160,this._txt3.x=380,this._txt3.y=1060,0>t?(this._txt1.textColor=15427409,this._txt1.text=""+t):(this._txt1.textColor=7458924,this._txt1.text="+"+t),0>e?(this._txt2.textColor=15427409,this._txt2.text=""+e):(this._txt2.textColor=7458924,this._txt2.text="+"+e),0>i?(this._txt3.textColor=15427409,this._txt3.text=""+i):(this._txt3.textColor=7458924,this._txt3.text="+"+i),egret.Tween.get(this._txt1).to({y:0},3e3).call(function(){this._txt1.parent&&this._txt1.parent.removeChild(this._txt1)},this),egret.Tween.get(this._txt2).to({y:0},3e3).call(function(){this._txt2.parent&&this._txt2.parent.removeChild(this._txt2)},this),egret.Tween.get(this._txt3).to({y:900},3e3).call(function(){this._txt3.parent&&this._txt3.parent.removeChild(this._txt3)},this)},p.Release=function(){this._gameScene.removeChildren()},t}();t.GameOverAniProxy=e,egret.registerClass(e,"scene.GameOverAniProxy",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this._txt_money=null,this._txt_name=null,this._head=null,this._timesTxT=null,this._gameScene=null,this._playerTime=null,this._playerHead1=null,this._playerHead2=null,this._houseRunning=null,this._timeTxt=null,this._startTime=0,this._autoing=null}var i=(__define,e);return p=i.prototype,p.Init=function(e){this._gameScene=e,this._head=new t.PlayerHeadFrame,this._gameScene.addChild(this._head),this._head.Init(data.GameData.avatar),this._head.x=2,this._head.y=2,this._head.scaleX=this._head.scaleY=.7,this._txt_name=new egret.TextField,this._txt_name.size=20,this._txt_name.textColor=15120768,this._txt_name.text=data.GameData.nickname,this._gameScene.addChild(this._txt_name),this._txt_name.x=78,this._txt_name.y=12,this._txt_money=new egret.TextField,this._txt_money.size=20,this._txt_money.textColor=15120768,this._txt_money.text=""+data.GameData.money,this._gameScene.addChild(this._txt_money),this._txt_money.x=105,this._txt_money.y=43,this._timeTxt=new egret.TextField,this._timeTxt.size=35,this._timeTxt.textColor=16777215,this._timeTxt.text="00:00",this._gameScene.addChild(this._timeTxt),this._timeTxt.x=405,this._timeTxt.y=23,this._timesTxT=new egret.BitmapText,this._timesTxT.font=RES.getRes("timefont_fnt"),this._timesTxT.y=1060,this._timesTxT.text="",this._gameScene.addChild(this._timesTxT),this._timesTxT.x=Config.StageWidth-this._timesTxT.textWidth-10,this._playerHead1=new t.PlayerHead,this._playerHead2=new t.PlayerHead,this._playerTime=new t.PlayerTime,this._playerTime.Init(),this._gameScene.addChild(this._playerTime),this._playerTime.visible=!1,this._houseRunning=new t.HouseRunning,this._houseRunning.x=90,this._houseRunning.Init(),this._gameScene.addChild(this._houseRunning),this._autoing=new egret.Bitmap(RES.getRes("ui_robot")),this._autoing.y=632,this._gameScene.addChild(this._autoing),this._autoing.visible=!1},p.RefreshPlayerInfo=function(){this._txt_money.text=""+data.GameData.money},p.getPlayerHeadByLoc=function(t){return this["_playerHead"+t]},p.UpdateAllCardNum=function(){this._playerHead1&&(this._playerHead1.ShowCard=!0,this._playerHead1.UpdateCardNum()),this._playerHead2&&(this._playerHead2.ShowCard=!0,this._playerHead2.UpdateCardNum())},p.GameOver=function(){this._playerHead1&&(this._playerHead1.Ready=!1,this._playerHead1.ShowCard=!1),this._playerHead2&&(this._playerHead2.Ready=!1,this._playerHead2.ShowCard=!1),this._playerTime.visible=!1},p.RoomIn=function(t){for(var e in t)(1==t[e].LocalTableId||2==t[e].LocalTableId)&&this.SetPlayerHead(t[e],!0);this._playerHead1&&(this._playerHead1.Ready=!1,this._playerHead1.ShowCard=!1,this._playerHead1.LandFlagVisible(!1,!1)),this._playerHead2&&(this._playerHead2.Ready=!1,this._playerHead2.ShowCard=!1,this._playerHead2.LandFlagVisible(!1,!1)),this.SetTimes(""),this._playerTime.visible=!1},p.SetPlayerTime=function(t,e){this._playerTime.SetPoint(t.LocalTableId,e),this._playerTime.visible=!0},p.RemovePlayerHead=function(t){null!=t&&this["_playerHead"+t.LocalTableId]&&this["_playerHead"+t.LocalTableId].Release()},p.TurnCallLand=function(){this._playerHead1&&(this._playerHead1.ShowCard=!0),this._playerHead2&&(this._playerHead2.ShowCard=!0)},p.SetPlayerHead=function(t,e){if(void 0===e&&(e=!1),null!=t&&(this["_playerHead"+t.LocalTableId].Release(),this["_playerHead"+t.LocalTableId].Init(t),this._gameScene.addChildAt(this["_playerHead"+t.LocalTableId],0),this["_playerHead"+t.LocalTableId].Ready=t.IsReady,this["_playerHead"+t.LocalTableId].UpdateCardNum(),this["_playerHead"+t.LocalTableId].LandFlagVisible(!1,!1),1==t.LocalTableId?(this._playerHead1.x=65,this._playerHead1.y=190):2==t.LocalTableId&&(this._playerHead2.x=475,this._playerHead2.y=190),e&&3!=t.LocalTableId)){var i=this["_playerHead"+t.LocalTableId];if(i){egret.Tween.removeTweens(i);var n=i.x,s=0;1==t.LocalTableId?s=n-300:2==t.LocalTableId&&(s=n+300),i.x=s,egret.Tween.get(i).to({x:n},600)}}},p.SetPlayerLandFlag=function(t){this._playerHead1&&(this._playerHead1.IsLandOwner=!1,this._playerHead1.LandFlagVisible(!0,!1)),this._playerHead2&&(this._playerHead2.IsLandOwner=!1,this._playerHead2.LandFlagVisible(!0,!1)),this["_playerHead"+t]&&(this["_playerHead"+t].IsLandOwner=!0,this["_playerHead"+t].LandFlagVisible(!0,!0))},p.SetPlayerReady=function(t,e){this["_playerHead"+t]&&(this["_playerHead"+t].Ready=e)},p.SendCard=function(){this._playerHead1&&(this._playerHead1.Ready=!1,this._playerHead1.ShowCard=!1),this._playerHead2&&(this._playerHead2.Ready=!1,this._playerHead2.ShowCard=!1),this._startTime=egret.getTimer()},p.SetTimes=function(t){this._timesTxT.text=""!=t?t+"倍":t,this._timesTxT.x=Config.StageWidth-this._timesTxT.textWidth-10},p.PushHouseRunning=function(t){this._houseRunning.Push(t)},p.Update=function(){var t=egret.getTimer();if(this._playerTime&&this._playerTime.Update(),this._houseRunning&&this._houseRunning.Update(),this._timeTxt&&this._startTime>0){var e=t-this._startTime,i=DateTimeTool.GetMinString(e);this._timeTxt.text=i}},p.Release=function(){this._playerTime.Release(),this._playerHead1&&this._playerHead1.Release(),this._playerHead2&&this._playerHead2.Release(),this._gameScene=null,this._playerTime=null,this._playerHead1=null,this._playerHead2=null},e}();t.GameUIProxy=e,egret.registerClass(e,"scene.GameUIProxy",["IInit","IRelease","IUpdate"])}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this._btnProxy=null,this._tableList=[],this._type=null,this._prompt=null,this._prompt2=null,this._compare=null,this._lastCard=null,this._startCard=null,this._cardLayer=null,this._gameScene=null,this._player=null,this._cardVlist=null,this._ismousedown=!1,this._island=!1,this._canshowAll=!1}var i=__define,n=e;return p=n.prototype,p.Init=function(t){this._gameScene=t
},p.SetPlayerLandFlag=function(t){this._island=3==t},i(p,"CanShowAll",void 0,function(t){this._canshowAll=t}),p.SetMainPlayer=function(i){this._gameScene.removeChildren(),this._type=new controller.game.Types,this._prompt=new controller.game.Prompt,this._prompt2=new controller.game.Prompt2,this._compare=new controller.game.Compare,this._player=i,this._cardVlist=[],this._cardLayer=new egret.Sprite,this._gameScene.addChild(this._cardLayer),this._cardLayer.x=0,this._cardLayer.y=Config.StageHeight-e.DOWNGAP-2*t.Card.CARDHEIGHT-e.VERCARGAP,this._cardLayer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._cardLayer.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._cardLayer.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this._cardLayer.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.setCard()},p.SetBtnProxy=function(t){this._btnProxy=t},p.getHasBigger=function(){if(null==this._tableList||this._tableList.length<1)return!0;var t=this._cardVlist.length,e=0,i=[];for(e=0;t>e;e++){var n=this._cardVlist[e];i.push(n.Value)}var s=this._type.GetType(i),r=this._type.GetType(this._tableList),a=null;return r.Type==controller.game.Types.Types_Error?!0:(a=this._prompt.GetPrompt(s,r,0,0,!1,!1),null==a&&(a=this._prompt2.GetPrompt(s,r)),null==a?!1:!0)},p.CanAllShow=function(){var t=this.GetWillShowList();if(null!=t&&t.length>0)return!0;var e=this._cardVlist.length,i=0,n=[];for(i=0;e>i;i++){var s=this._cardVlist[i];s.Select=!1,s.Jump=!1,n.push(s.Value)}var r=this._type.GetType(n);if(r.Type!=controller.game.Types.Types_Error){for(i=0;e>i;i++){var s=this._cardVlist[i];s.Select=!1,s.Jump=!0,n.push(s.Value)}return!0}return!0},p.Reset=function(){var t=this._cardVlist.length,e=0;for(e=0;t>e;e++){var i=this._cardVlist[e];i.Select=!1,i.Jump=!1}},p.Prompt=function(t,e){if(t)return this.CanAllShow();if(!e){var i=this.GetWillShowList();if(null!=i&&i.length>0)return!0}var n=this._cardVlist.length,s=0,r=0,a=[];for(s=0;n>s;s++){var h=this._cardVlist[s];h.Select=!1,h.Jump=!1,a.push(h.Value)}var l=this._type.GetType(a),o=this._type.GetType(this._tableList),_=null;if(o.Type==controller.game.Types.Types_Error?_=this._prompt.GetPrompt(l,null,0,0,!1,!1):(_=this._prompt.GetPrompt(l,o,0,0,!1,!1),null==_&&(_=this._prompt2.GetPrompt(l,o))),null==_)return!1;var d=_.List,u=d.length;for(s=0;n>s;s++){var h=this._cardVlist[s];for(r=0;u>r;r++)if(d[r]==h.Value){h.Jump=!0;break}}return!0},p.SetTableList=function(t){this._tableList=t},p.SendOver=function(){this.setCard()},p.GetWillShowList=function(t){void 0===t&&(t=!1);var e,i=0,n=this._cardVlist.length,s=[];for(i=n-1;i>=0;i--)e=this._cardVlist[i],e.Jump&&s.push(e.Value);var r=this._type.GetType(s);return r.Type==controller.game.Types.Types_Error?this._canshowAll&&r.List.length>1&&r.SingleArr.length<1&&0==r.HasBomb()?s:0==t?null:s.length>0?s:null:s},i(p,"Visible",void 0,function(t){this._cardLayer&&(this._cardLayer.visible=t)}),p.onTouchBegin=function(t){var e=this._cardVlist.length,i=0;for(i=0;e>i;i++){var n=this._cardVlist[i];n==t.target?(n.Select=!0,this._startCard=n,this._lastCard=n):n.Select=!1}this._ismousedown=!0},p.onTouchMove=function(e){var i=e.target;if(i instanceof t.Card&&null!=this._lastCard&&i!=this._lastCard){this._lastCard=i;var n,s=this._cardVlist.length,r=0,a=0;for(r=0;s>r;r++)n=this._cardVlist[r],n.Select=1==a?!0:!1,n==i&&(a++,n.Select=!0),n==this._startCard&&(a++,n.Select=!0)}},p.onTouchEnd=function(t){if(0!=this._ismousedown){this._ismousedown=!1;var e,i=this._cardVlist.length,n=0,s=[],r=[],a=[],h=!0,l=!1,o=!1;for(n=0;i>n;n++)e=this._cardVlist[n],a.push(e.Value),e==t.target&&(e.Select=!0),1==e.Select&&(r.push(e.Value),s.push(e),0==e.Jump?h=!1:l=!0),1==e.Jump&&(o=!0);if(h){for(i=s.length,n=0;i>n;n++)e=s[n],e.Jump=!1,e.Select=!1;return void this.SetBtnVisible()}var _=this._type.GetType(a),d=this._type.GetType(r);if(d.Type==controller.game.Types.Types_Error&&0==o){var u=null;d.List.length>=5?(u=this._prompt.GetPrompt(d,null,0,0,!1,!1),u&&(u.Type==controller.game.Types.Types_List||u.List.length>3)&&(d=u)):(u=this._prompt.GetPromptContain(_,d),u&&u.Type==controller.game.Types.Types_List&&(d=u))}var c=d.List.length,p=0,g=0;for(n=0;i>n;n++)for(e=this._cardVlist[n],e.Select=!1,p=0;c>p;p++)g=d.List[p],g==e.Value&&(e.Jump=!0);this.SetBtnVisible()}},p.SetBtnVisible=function(){if(this._btnProxy.State==t.GameBtnProxy.STATE_Playing){var e=this.GetWillShowList(),i=null,n=null;if(null==e)this._btnProxy.PlayingShow(!1);else{if(null==this._tableList||this._tableList.length<1)return void this._btnProxy.PlayingShow(!0);i=this._type.GetType(this._tableList),n=this._type.GetType(e),this._btnProxy.PlayingShow(this._compare.IsBiger(n,i)?!0:!1)}}},p.setCard=function(){var i=this._cardVlist.length,n=0;for(n=0;i>n;n++){var s=this._cardVlist[n];s.Release()}this._cardVlist=[];var r=this._player.CardArr;r.sort(function(t,e){return t%100==e%100?t>e?1:-1:t%100>e%100?-1:1});var a=this.dividArr(),h=a[0],l=a[1],o=h.length,_=l.length,d=Config.StageWidth-e.LEFTGAP-e.RIGHTGAP-t.Card.CARDWIDTH,u=0,c=u+e.VERCARGAP+t.Card.CARDHEIGHT,p=d/(o-1),g=d/(_-1),y=0;p>e.HORCARGAP&&(p=e.HORCARGAP),g>e.HORCARGAP&&(g=e.HORCARGAP);var T=(Config.StageWidth-(p*(o-1)+t.Card.CARDWIDTH))/2,m=(Config.StageWidth-(g*(_-1)+t.Card.CARDWIDTH))/2,f=null;for(y=0;o>y;y++){var s=MandPool.getInsByParm(t.Card,h[y]);s.y=u,s.x=T+y*p,this._cardLayer.addChild(s),this._cardVlist.push(s),f=s}for(y=0;_>y;y++){var s=MandPool.getInsByParm(t.Card,l[y]);s.y=c,s.x=m+y*g,this._cardLayer.addChild(s),this._cardVlist.push(s),f=s}this._island&&f.addLand()},p.dividArr=function(){var t,e=[],i=[],n=(this._player.CardNum,0);for(n=0;10>n;n++)t=this._player.CardArr[n],t&&e.push(t);for(n=10;20>n;n++)t=this._player.CardArr[n],t&&i.push(t);var s;i[0]&&(s=i[0]%100);var r=e.length,a=i.length,h=0;if(s)for(n=r-1;n>=0&&s==e[n]%100;n--)h++,10>h+a&&i.unshift(e.pop());return[e,i]},p.Release=function(){this._gameScene.removeChildren()},e.LEFTGAP=17,e.RIGHTGAP=17,e.DOWNGAP=98,e.VERCARGAP=35,e.HORCARGAP=100,e}();t.MyCardProxy=e,egret.registerClass(e,"scene.MyCardProxy")}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this._sendLayer=null,this._cardLayer=null,this._player=null,this._cardVlist=null,this._gameScene=null,this._overfun=null,this._overThis=null,this._timer1=null,this._mCard1=null,this._mCard2=null,this._mCard3=null}var i=(__define,e);return p=i.prototype,p.Init=function(t){this._gameScene=t},p.StartAni=function(e,i,n){this._overfun=i,this._overThis=n,this._player=e,this._cardVlist=[],this._sendLayer=new egret.Sprite,this._cardLayer=new egret.Sprite,this._gameScene.addChild(this._cardLayer),this._cardLayer.x=0,this._cardLayer.y=Config.StageHeight-t.MyCardProxy.DOWNGAP-2*t.Card.CARDHEIGHT-t.MyCardProxy.VERCARGAP,this.sendCardAni()},p.sendCardAni=function(){this._cardLayer.addChild(this._sendLayer);var e=0;for(e=0;3>e;e++){var i=MandPool.getInsByParm(t.Card,0);this._sendLayer.addChild(i),i.x=220+10*e,i.y=-300}this._mCard1=MandPool.getInsByParm(t.Card,0),this._cardLayer.addChild(this._mCard1),this._mCard1.x=250,this._mCard1.y=-300,this._mCard2=MandPool.getInsByParm(t.Card,0),this._cardLayer.addChild(this._mCard2),this._mCard2.x=250,this._mCard2.y=-300,this._mCard3=MandPool.getInsByParm(t.Card,0),this._cardLayer.addChild(this._mCard3),this._mCard3.x=250,this._mCard3.y=-300,egret.Tween.get(this._mCard1,{loop:!0}).wait(0).to({x:0},300).to({x:250},0).wait(400),egret.Tween.get(this._mCard2,{loop:!0}).wait(200).to({x:500},300).to({x:250},0).wait(200),egret.Tween.get(this._mCard3,{loop:!0}).wait(400).to({y:0},300).to({y:370},0).wait(0),SoundMgr.Instance.PlayEffect("card_send_mp3"),this._timer1=new egret.Timer(220,17),this._timer1.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer1.start()},p.onTimer=function(){var t=this._timer1.currentCount;if(t==this._timer1.repeatCount)egret.Tween.removeTweens(this._mCard1),egret.Tween.removeTweens(this._mCard2),egret.Tween.removeTweens(this._mCard3),this.setCard(this._player.CardArr),this._timer1.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._timer1.stop(),this._timer1=null,this.showOwnerAni();else{var e=this._player.CardArr.slice(0,t);this.setCard(e)}},p.showOwnerAni=function(){this._sendLayer.removeChildren(),this._sendLayer.parent&&(this._sendLayer.parent.removeChild(this._sendLayer),this._sendLayer=null),this._mCard1.x=250,this._mCard1.y=-300,this._mCard2.x=250,this._mCard2.y=-300,this._mCard3.x=250,this._mCard3.y=-300,egret.Tween.get(this._mCard1).to({x:50},300),egret.Tween.get(this._mCard2).to({x:450},300),this._overfun.call(this._overThis)},p.setCard=function(e){var i=this._cardVlist.length,n=0;for(n=0;i>n;n++){var s=this._cardVlist[n];s.Release()}this._cardVlist=[];var r=e;r.sort(function(t,e){return t%100==e%100?t>e?1:-1:t%100>e%100?-1:1});var a=this.dividArr(e),h=a[0],l=a[1],o=h.length,_=l.length,d=Config.StageWidth-t.MyCardProxy.LEFTGAP-t.MyCardProxy.RIGHTGAP-t.Card.CARDWIDTH,u=0,c=u+t.MyCardProxy.VERCARGAP+t.Card.CARDHEIGHT,p=d/(o-1),g=d/(_-1),y=0;p>t.MyCardProxy.HORCARGAP&&(p=t.MyCardProxy.HORCARGAP),g>t.MyCardProxy.HORCARGAP&&(g=t.MyCardProxy.HORCARGAP);var T=(Config.StageWidth-(p*(o-1)+t.Card.CARDWIDTH))/2,m=(Config.StageWidth-(g*(_-1)+t.Card.CARDWIDTH))/2;for(y=0;o>y;y++){var s=MandPool.getInsByParm(t.Card,h[y]);s.y=u,s.x=T+y*p,this._cardLayer.addChild(s),this._cardVlist.push(s)}for(y=0;_>y;y++){var s=MandPool.getInsByParm(t.Card,l[y]);s.y=c,s.x=m+y*g,this._cardLayer.addChild(s),this._cardVlist.push(s)}},p.dividArr=function(t){var e,i=[],n=[],s=(this._player.CardNum,0);for(s=0;10>s;s++)e=t[s],e&&i.push(e);for(s=10;20>s;s++)e=t[s],e&&n.push(e);var r;n[0]&&n[0].Value%100;var a=i.length,h=n.length,l=0;if(r)for(s=a-1;s>=0&&r==i[s].Value%100;s--)l++,10>l+h&&n.unshift(i.pop());return[i,n]},p.Release=function(t){if(0==t)return void this._gameScene.removeChildren();var e=20,i=100;1==t?(e=40,i=-520):2==t?(e=500,i=-520):3==t&&(e=250,i=0),this._mCard3&&egret.Tween.get(this._mCard3).to({x:e,y:i},500).call(function(){this._gameScene.removeChildren()},this),this._mCard2&&egret.Tween.get(this._mCard2).to({x:e,y:i},500).call(function(){this._gameScene.removeChildren()},this),this._mCard1&&egret.Tween.get(this._mCard1).to({x:e,y:i},500).call(function(){this._gameScene.removeChildren()},this)},e}();t.SendCardAniProxy=e,egret.registerClass(e,"scene.SendCardAniProxy",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(){function e(){this._gameScene=null,this._landSprite=null,this._tableSprite_1=null,this._tableSprite_2=null,this._tableSprite_3=null}var i=(__define,e);return p=i.prototype,p.Init=function(t){this._gameScene=t,this._landSprite=new egret.Sprite,this._tableSprite_1=new egret.Sprite,this._tableSprite_2=new egret.Sprite,this._tableSprite_3=new egret.Sprite,this._gameScene.addChild(this._landSprite),this._gameScene.addChild(this._tableSprite_1),this._gameScene.addChild(this._tableSprite_2),this._gameScene.addChild(this._tableSprite_3),this._landSprite.x=230,this._landSprite.y=80,this._tableSprite_1.x=20,this._tableSprite_1.y=300,this._tableSprite_2.x=340,this._tableSprite_2.y=300,this._tableSprite_3.x=20,this._tableSprite_3.y=500},p.clearAll=function(t){void 0===t&&(t=!1),this._tableSprite_1.removeChildren(),this._tableSprite_2.removeChildren(),this._tableSprite_3.removeChildren(),t&&this._landSprite.removeChildren()},p.ShowLandCard=function(e){if(this._landSprite.removeChildren(),null!=e){var i=0,n=e.length;for(i=0;n>i;i++){var s=MandPool.getInsByParm(t.Card,e[i]);this._landSprite.addChild(s),s.scaleX=s.scaleY=.4,s.x=i%7*64,s.y=0}}},p.ShowTableCard=function(t,e){switch(t){case 1:this.init_1(e);break;case 2:this.init_2(e);break;case 3:this.init_3(e)}},p.init_1=function(i){if(this._tableSprite_1.removeChildren(),null!=i){i.reverse(),i.sort(function(t,e){return t%100>e%100?-1:1});var n=0,s=i.length;for(n=0;s>n;n++){var r=MandPool.getInsByParm(t.Card,i[n]);this._tableSprite_1.addChild(r),r.scaleX=r.scaleY=e.CardScale,r.x=n%7*35,r.y=30*Math.floor(n/7)}this._tableSprite_1.x=20,this._tableSprite_1.y=100,this._tableSprite_1.alpha=0,this._tableSprite_1.scaleX=this._tableSprite_1.scaleY=1.5,this._tableSprite_1.alpha=1,egret.Tween.get(this._tableSprite_1).to({x:20,y:300,scaleX:1,scaleY:1,alpha:1},300,egret.Ease.circIn)}},p.init_2=function(i){if(this._tableSprite_2.removeChildren(),null!=i){i.reverse(),i.sort(function(t,e){return t%100>e%100?-1:1});var n=0,s=i.length;for(n=0;s>n;n++){var r=MandPool.getInsByParm(t.Card,i[n]);this._tableSprite_2.addChild(r),r.scaleX=r.scaleY=e.CardScale,r.x=n%7*35,r.y=30*Math.floor(n/7)}this._tableSprite_2.x=500,this._tableSprite_2.y=100,this._tableSprite_2.alpha=0,this._tableSprite_2.scaleX=this._tableSprite_2.scaleY=1.5,this._tableSprite_2.alpha=1,egret.Tween.get(this._tableSprite_2).to({x:340,y:300,scaleX:1,scaleY:1,alpha:1},300,egret.Ease.circIn)}},p.init_3=function(i){if(this._tableSprite_3.removeChildren(),null!=i){i.reverse(),i.sort(function(t,e){return t%100>e%100?-1:1});var n=0,s=i.length,r=50,a=10;a>s&&(a=s);var h=(Config.StageWidth-(r*a+t.Card.CARDWIDTH*e.CardScale))/2;for(n=0;s>n;n++){var l=MandPool.getInsByParm(t.Card,i[n]);this._tableSprite_3.addChild(l),l.scaleX=l.scaleY=e.CardScale,l.x=h+n%10*r,l.y=30*Math.floor(n/10)}this._tableSprite_3.x=20,this._tableSprite_3.y=700,this._tableSprite_3.alpha=0,this._tableSprite_3.scaleX=this._tableSprite_3.scaleY=1.5,this._tableSprite_3.alpha=1,egret.Tween.get(this._tableSprite_3).to({x:20,y:500,scaleX:1,scaleY:1,alpha:1},300,egret.Ease.circIn)}},e.CardScale=.5,e}();t.TableCardProxy=e,egret.registerClass(e,"scene.TableCardProxy")}(scene||(scene={}));var render;!function(t){var e=function(t){function e(e,i,n){t.call(this),this._str1=null,this._str2=null,this._str3=null,this.touchChildren=!0,this.touchEnabled=!0,this.width=465,this.height=68,this._str1=e,this._str2=i,this._str3=n;var s=new egret.MovieClipDataFactory(RES.getRes(e+"_json"),RES.getRes(e+"_png")),r=new egret.MovieClip(s.generateMovieClipData("chat"));r.name="chat_facemc1",this.addChild(r);var s=new egret.MovieClipDataFactory(RES.getRes(i+"_json"),RES.getRes(i+"_png")),a=new egret.MovieClip(s.generateMovieClipData("chat"));a.name="chat_facemc2",this.addChild(a);var s=new egret.MovieClipDataFactory(RES.getRes(n+"_json"),RES.getRes(n+"_png")),h=new egret.MovieClip(s.generateMovieClipData("chat"));h.name="chat_facemc3",this.addChild(h),r.x=10,r.y=0,a.x=170,a.y=0,h.x=330,h.y=0,r.touchEnabled=!0,a.touchEnabled=!0,h.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this);var l=new egret.Shape;l.graphics.beginFill(0,0),l.graphics.drawRect(0,0,465,150),l.graphics.endFill(),this.addChild(l)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onTap=function(t){var e;"chat_facemc1"==t.currentTarget.name?e=this._str1:"chat_facemc2"==t.currentTarget.name?e=this._str2:"chat_facemc3"==t.currentTarget.name&&(e=this._str3),null!=e&&(NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SENDCHAT,{chatStr:e}),windowui.ChatInst.Instance.Hide())},e}(egret.Sprite);t.ChatFaceRender=e,egret.registerClass(e,"render.ChatFaceRender")}(render||(render={}));var render;!function(t){var e=function(t){function e(e){t.call(this),this._txtInput=null,this._data=null,this._data=e,this.touchChildren=!1,this.touchEnabled=!0,this.width=465,this.height=68;var i=new egret.Bitmap(RES.getRes("ui_color1"));i.width=465,i.height=68,this.addChild(i);var i=new egret.Bitmap(RES.getRes("ui_line1"));i.width=465,this.addChild(i),i.y=66,this._txtInput=new egret.TextField,this._txtInput.width=465,this._txtInput.height=35,this._txtInput.x=0,this._txtInput.y=20,this._txtInput.size=30,this._txtInput.textColor=11129325,this._txtInput.maxChars=25,this._txtInput.text=e.txt,this.addChild(this._txtInput),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onTap=function(){NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SENDCHAT,{chatStr:this._txtInput.text}),windowui.ChatInst.Instance.Hide()},e}(egret.Sprite);t.ChatWordsRender=e,egret.registerClass(e,"render.ChatWordsRender")}(render||(render={}));var LobbyTableRender=function(t){function e(){t.call(this),this.skinName="skins.scene.render.LobbyTableRenderSkin"}__extends(e,t);var i=(__define,e);return p=i.prototype,p.dataChanged=function(){this.data;this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.toggleTouchHandler,this)},p.toggleTouchHandler=function(){trace("222")},e}(egret.gui.ItemRenderer);egret.registerClass(LobbyTableRender,"LobbyTableRender");var scene;!function(t){var e=function(e){function i(){e.call(this),this._textType=null,this._textValue=null,this._backValue=null,this._cardlist0=[],this._cardlist1=[],this._cardlist2=[],this.initListData()}__extends(i,e);var n=(__define,i);return p=n.prototype,p.initListData=function(){var t=new egret.Bitmap(RES.getRes("bg_lobby_jpg"));this.addChild(t),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTab,this),TestGameMgr.Instance.Start(this),this.setCard(0),this.setCard(1),this.setCard(2),this.setDizhuCard3(),SoundMgr.Instance.PlaySound("bg_lobby_mp3")},p.PrompCard=function(t,e){if(null!=e){var i,n,s=this["_cardlist"+t],r=0,a=0,h=(e.List.length,s.length);for(a=0;h>a;a++)for(i=s[a],i.Select=!1,r=0;r<e.List.length;r++)n=e.List[r],i.Value==n&&(i.Select=!0)}},p.setCard=function(e,i){if(void 0===i&&(i=!1),i){var n=this["_cardlist"+e].length,s=0;for(s=0;n>s;s++){var r=this["_cardlist"+e][s];r.Release()}this["_cardlist"+e]=[]}var a=TestGameMgr.Instance.GetPlayerById(e),h=a.CardArr;h.sort(function(t,e){return t%100>e%100?-1:1});var l=a.CardNum,o=0;for(o=0;l>o;o++){var r=MandPool.getInsByParm(t.Card,h[o]);r.y=40*o,r.x=150*e,this.addChild(r),this["_cardlist"+e].push(r)}var _=new t.SButton("ui_card","ui_cardselect","出牌");_.name="btn_player_"+e,this.addChild(_),_.x=150*e+60,_.y=700;var _=new t.SButton("ui_card","ui_cardselect","一分");_.name="btn_call_1_"+e,this.addChild(_),_.x=150*e,_.y=800,_.scaleX=_.scaleY=.5;var _=new t.SButton("ui_card","ui_cardselect","二分");_.name="btn_call_2_"+e,this.addChild(_),_.x=150*e+30,_.y=800,_.scaleX=_.scaleY=.5;var _=new t.SButton("ui_card","ui_cardselect","三分");_.name="btn_call_3_"+e,this.addChild(_),_.x=150*e+60,_.y=800,_.scaleX=_.scaleY=.5;var _=new t.SButton("ui_card","ui_cardselect","不叫");_.name="btn_call_0_"+e,this.addChild(_),_.x=150*e,_.y=850,_.scaleX=_.scaleY=.5;var _=new t.SButton("ui_card","ui_cardselect","过");_.name="btn_pass_"+e,this.addChild(_),_.x=150*e+60,_.y=850,_.scaleX=_.scaleY=.5},p.setDizhuCard3=function(){var e=TestGameMgr.Instance.GetDizhuCard3(),i=e.length,n=0;for(n=0;i>n;n++){var s=MandPool.getInsByParm(t.Card,e[n]);s.y=40*n,s.x=450,this.addChild(s)}this._textType=new egret.TextField,this._textType.type=egret.TextFieldType.INPUT,this._textType.background=!0,this._textType.textColor=0,this._textType.text="getInitInfo",this._textType.width=500,this._textType.x=450,this._textType.y=150,this.addChild(this._textType),this._textValue=new egret.TextField,this._textValue.type=egret.TextFieldType.INPUT,this._textValue.background=!0,this._textValue.textColor=0,this._textValue.text='{"example":"example"}',this._textValue.width=500,this._textValue.x=450,this._textValue.y=200,this.addChild(this._textValue);var r=new t.SButton("ui_card","ui_cardselect","调用\n原生");r.name="btn_test_h2app",this.addChild(r),r.x=450,r.y=250,r.scaleX=r.scaleY=.7,this._backValue=new egret.TextField,this._backValue.textColor=0,this._backValue.text="",this._backValue.width=500,this._backValue.x=450,this._backValue.y=320,this.addChild(this._backValue);var a=new egret.TextField;a.textColor=0,a.text="原生调用js\n native2js(string)",a.width=500,a.x=450,a.y=380,this.addChild(a)},p.onTab=function(t){var e=t.target,i=e.name;if(0==i.indexOf("btn_player_")){var n=i.split("_")[2],s=this["_cardlist"+n],r=[];for(var a in s){var h=s[a];h.Select&&r.push(h.Value)}var l=TestGameMgr.Instance.ShowCard(r,n);if(l){var o=s.length,_=o-1;for(_=o-1;_>=0;_--){var h=s[_];h.Select&&(h.Release(),s.splice(_,1))}}trace("onTab:",n)}if(0==i.indexOf("btn_pass_"))var n=i.split("_")[2],l=TestGameMgr.Instance.Pass(n);if(0==i.indexOf("btn_call")){var d=i.split("_")[2],n=i.split("_")[3],l=TestGameMgr.Instance.CallLandOwners(d,n);if(l){var u=TestGameMgr.Instance.GetLanOwner();this.setCard(u.TableId,!0)}}if("btn_test_h2app"==i){var c=this._textType.text,p=this._textValue.text,g={};g.type=c,g.value=p,this._backValue.text="返回:"+NativeMgr.Instance.JS2Native(g).toString()}},i}(t.SceneBase);t.TestGameScene=e,egret.registerClass(e,"scene.TestGameScene")}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e){t.call(this),this._value=0,this._isselect=!1,this._isjump=!1,this._bg=null,this._mask=null,this._backbg=null,this._typeimg1=null,this._typeimg2=null,this._numimg=null,this._landimg=null,this._value=e,0==e?this.initBack():this.init()}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.addLand=function(){null==this._landimg&&(this._landimg=new egret.Bitmap(RES.getRes("ui_flag_card"))),this.addChild(this._landimg)},p.initBack=function(){this.touchEnabled=!1,this.touchChildren=!1,null==this._backbg&&(this._backbg=new egret.Bitmap(RES.getRes("ui_cardback"))),this.addChild(this._backbg)},i(p,"Value",function(){return this._value}),p.init=function(){this.touchEnabled=!0,this.touchChildren=!1,null==this._bg&&(this._bg=new egret.Bitmap(RES.getRes("ui_card"))),null==this._mask&&(this._mask=new egret.Bitmap(RES.getRes("ui_cardselect"))),this.addChild(this._bg);var t=Math.floor(this._value/100);5>t?(null==this._typeimg1&&(this._typeimg1=new egret.Bitmap(RES.getRes("ui_cardtype_"+t))),this.addChild(this._typeimg1),this._typeimg1.scaleX=this._typeimg1.scaleY=1,this._typeimg1.x=50,this._typeimg1.y=75,null==this._typeimg2&&(this._typeimg2=new egret.Bitmap(RES.getRes("ui_cardtype_"+t))),this.addChild(this._typeimg2),this._typeimg2.scaleX=this._typeimg2.scaleY=.5,this._typeimg2.x=11,this._typeimg2.y=55):9==t&&(999==this._value?(null==this._typeimg1&&(this._typeimg1=new egret.Bitmap(RES.getRes("ui_cardnum9_99_dec"))),this.addChild(this._typeimg1),this._typeimg1.x=25,this._typeimg1.y=45):998==this._value&&(null==this._typeimg1&&(this._typeimg1=new egret.Bitmap(RES.getRes("ui_cardnum9_98_dec"))),this.addChild(this._typeimg1),this._typeimg1.x=25,this._typeimg1.y=45));var e=1;2==t||4==t?e=2:9==t&&(e=9);var i=Math.floor(this._value%100);null==this._numimg&&(this._numimg=new egret.Bitmap(RES.getRes("ui_cardnum"+e+"_"+i))),this.addChild(this._numimg),this._numimg.x=16,this._numimg.y=9,this.addChild(this._mask),this._mask.visible=!1},i(p,"Select",function(){return this._isselect},function(t){return this._isselect==t?(this._mask.visible=this._isselect,void(this._isjump&&(this._mask.visible=!0))):(this._isselect=t,this._mask.visible=this._isselect,void(this._isjump&&(this._mask.visible=!0)))}),i(p,"Jump",function(){return this._isjump},function(t){return this._isjump==t?void(this._mask.visible=this._isjump):(this._isjump=t,this._isjump?this.y-=20:this.y+=20,this._mask.visible=this._isjump,void(this._isjump&&(this._isselect=!1)))}),p.Release=function(){this._landimg&&this._landimg.parent&&this._landimg.parent.removeChild(this._landimg),this._isselect=!1,this._isjump=!1,this._mask.visible=!1,this.scaleX=this.scaleY=1,this.alpha=1,this.parent&&this.parent.removeChild(this),MandPool.remand(this)},e.CARDWIDTH=135,e.CARDHEIGHT=179,e}(egret.Sprite);t.Card=e,egret.registerClass(e,"scene.Card",["IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e){t.call(this),this._bg=null,this._mask=null,this.init(e)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(t){this.touchEnabled=!1,this.touchChildren=!1,this._bg=new egret.Bitmap(RES.getRes(t)),this.addChild(this._bg),this._mask=new egret.Shape,this.addChild(this._mask),this.mask=this._mask,this.setProgress(0)},p.setProgress=function(t){if(!(t>1||0>=t)){var e=this._bg.width,i=this._bg.height,n=Math.ceil(360*t);this.DrawSector(this._mask,e/2,i/2,e/2,n,-90)}},p.DrawSector=function(t,e,i,n,s,r){void 0===e&&(e=200),void 0===i&&(i=200),void 0===n&&(n=100),void 0===s&&(s=-90),void 0===r&&(r=-90),t.graphics.clear(),t.graphics.beginFill(0),t.graphics.moveTo(e,i),s=Math.abs(s)>360?360:s;var a=Math.ceil(Math.abs(s)/45),h=s/a;h=h*Math.PI/180,r=r*Math.PI/180,t.graphics.lineTo(e+n*Math.cos(r),i+n*Math.sin(r));for(var l=1;a>=l;l++){r+=h;var o=r-h/2,_=e+n/Math.cos(h/2)*Math.cos(o),d=i+n/Math.cos(h/2)*Math.sin(o),u=e+n*Math.cos(r),c=i+n*Math.sin(r);t.graphics.curveTo(_,d,u,c)}360!=s&&t.graphics.lineTo(e,i),t.graphics.endFill()},p.Release=function(){this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);t.CircleLoading=e,egret.registerClass(e,"scene.CircleLoading",["IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){t.call(this),this._strList=null,this._txt=null,this._bgSprite=null,this._scrollRect=null}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(){this.touchChildren=!1,this.touchEnabled=!1,this.cacheAsBitmap=!0,this._strList=new Array,this._bgSprite=new egret.Shape,this.addChild(this._bgSprite),this.drawBg(),this._txt=new egret.TextField,this._txt.textColor=16776960,this._txt.y=10,this._txt.x=e.BGWidth,this._txt.size=30,this.addChild(this._txt),this._scrollRect=new egret.Rectangle(0,0,e.BGWidth,e.BGHeight),this.scrollRect=this._scrollRect},p.Push=function(t){this._strList.length>e.MaxLen&&this._strList.shift(),this._strList.push(t),this.visible=!0,1==this._strList.length&&(this._scrollRect.x=0,this._txt.text=this._strList[0],this._scrollRect.width=e.BGWidth+this._txt.textWidth,this.drawBg()),this.scrollRect=this._scrollRect},p.drawBg=function(){null!=this._scrollRect&&(this._bgSprite.graphics.clear(),this._bgSprite.graphics.beginFill(e.BGCOLOR,.4),this._bgSprite.graphics.drawRect(0,0,this._scrollRect.width+e.BGWidth,e.BGHeight),this._bgSprite.graphics.endFill())},p.Update=function(){if(!(this._strList.length<1)){if(this._scrollRect.x+=1,this.scrollRect.x>e.BGWidth+this._txt.textWidth){if(this._strList.shift(),this._strList.length<1)return void(this.visible=!1);this._scrollRect.x=0,this._txt.text=this._strList[0],this._scrollRect.width=e.BGWidth+this._txt.textWidth,this.drawBg()}this.scrollRect=this._scrollRect}},e.BGCOLOR=0,e.BGHeight=45,e.BGWidth=400,e.MaxLen=3,e}(egret.Sprite);t.HouseRunning=e,egret.registerClass(e,"scene.HouseRunning",["IInit","IUpdate"])}(scene||(scene={}));var scene;!function(t){var e=function(e){function i(){e.call(this),this._playerData=null,this._pInfo=null,this._headsp=null,this._avatarsp=null,this._backCardSp=null,this._isReady=!1,this._isAuto=!1,this._isOwner=!1,this._loc=0,this._ready_hand=null,this._landflag=null,this._cardNumTxt=null,this._init=!1}__extends(i,e);var n=__define,s=i;return p=s.prototype,p.Init=function(t){return this._init?void trace("请先执行release"):(this.touchEnabled=!1,this._loc=t.LocalTableId,this._playerData=t,this.setReady(),this.setHead(),this.setBackCard(),this.setTapInfo(),this.Ready=!0,this.ShowCard=!1,this._headsp.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._headsp.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._headsp.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),void(this._init=!0))},p.setHead=function(){this._headsp=new t.PlayerHeadFrame,this._headsp.Init(this._playerData.avatar),this.addChild(this._headsp),this._headsp.touchEnabled=!0},p.setTapInfo=function(){this._pInfo=new t.PlayerInfo,this._pInfo.Init(this._playerData),this.addChild(this._pInfo),1==this._loc?(this._pInfo.x=100,this._pInfo.y=0):2==this._loc?(this._pInfo.x=-202,this._pInfo.y=0):3==this._loc&&(this._pInfo.x=100,this._pInfo.y=-125),this._pInfo.touchChildren=!1,this._pInfo.touchEnabled=!1,this._pInfo.visible=!1},p.setReady=function(){this._ready_hand=new egret.Bitmap(RES.getRes("ui_ready_hand")),this.addChild(this._ready_hand),this._ready_hand.x=-45,this._ready_hand.y=0,this._ready_hand.visible=!1},p.setBackCard=function(){if(3!=this._loc){this._backCardSp=new egret.Sprite,this.addChild(this._backCardSp);var e=0;for(e=0;1>e;e++){var i=MandPool.getInsByParm(t.Card,0);this._backCardSp.addChild(i),i.x=0+10*e,i.y=0}this._backCardSp.scaleX=this._backCardSp.scaleY=.5,this._cardNumTxt=new egret.TextField,this._cardNumTxt.width=200,this._cardNumTxt.size=100,this._cardNumTxt.textColor=16777011,this._cardNumTxt.stroke=5,this._cardNumTxt.strokeColor=10027008,this._cardNumTxt.textAlign=egret.HorizontalAlign.CENTER,this._backCardSp.addChild(this._cardNumTxt),this._cardNumTxt.text="17",this._cardNumTxt.x=-35,this._cardNumTxt.y=50,1==this._loc?this._backCardSp.x=100:2==this._loc&&(this._backCardSp.x=-70),this._backCardSp.y=10,this._backCardSp.cacheAsBitmap=!0}},n(p,"ShowCard",void 0,function(t){this._backCardSp&&(this._backCardSp.visible=t,0==t&&(this._cardNumTxt.text=""))}),p.UpdateCardNum=function(){this._cardNumTxt&&(this._cardNumTxt.text=""+this._playerData.ShowCardNum)},p.onTouchBegin=function(){this._pInfo.visible=!0,this._pInfo.ReSet()},p.onTouchEnd=function(){this._pInfo.visible=!1},n(p,"Ready",void 0,function(t){this._isReady!=t&&(this._isReady=t,this._ready_hand.visible=this._isReady,1==this._loc?this._ready_hand.x=100:2==this._loc&&(this._ready_hand.x=-45))}),n(p,"IsLandOwner",void 0,function(t){this._isOwner=t,this._landflag&&this._landflag.parent&&this._landflag.parent.removeChild(this._landflag),this._landflag=new egret.Bitmap(this._isOwner?RES.getRes("ui_flag_landowner"):RES.getRes("ui_flag_farmer")),this.addChild(this._landflag),this._headsp&&(this._headsp.visible=!1),this._landflag.x=0,this._landflag.y=-90}),p.LandFlagVisible=function(t,e){this._landflag&&(this._landflag.visible=t),this._headsp&&(this._headsp.visible=!t),t&&(this.IsLandOwner=e)},p.Release=function(){this._headsp&&(this._headsp.removeChildren(),this._headsp.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._headsp.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._headsp.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)),this._landflag&&egret.Tween.removeTweens(this._landflag),this._playerData=null,this._pInfo=null,this._headsp=null,this._avatarsp=null,this._backCardSp=null,this._isReady=!1,this._isOwner=!1,this._isAuto=!1,this._loc=0,this._ready_hand=null,this._landflag=null,this._cardNumTxt=null,this.removeChildren(),this.parent&&this.parent.removeChild(this),this._init=!1},i}(egret.Sprite);t.PlayerHead=e,egret.registerClass(e,"scene.PlayerHead",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){t.call(this),this._headsp=null}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(t){var e=new egret.Bitmap(RES.getRes("ui_head_bg"));this._headsp=new egret.Sprite,this.addChild(this._headsp),this._headsp.addChild(e),RES.getResByUrl(t,this.getImgOver,this),this.touchChildren=!1},p.getImgOver=function(t){var e=new egret.Bitmap(t);e.width=88,e.height=88,e.x=6,e.y=6,this._headsp&&this._headsp.addChild(e)},p.Release=function(){this._headsp&&this._headsp.removeChildren(),this.removeChildren(),this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);t.PlayerHeadFrame=e,egret.registerClass(e,"scene.PlayerHeadFrame",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){t.call(this),this._scoretxt=null,this._cointxt=null,this._player=null,this._jifen="积分: ",this._jinbi="金币: "}__extends(e,t);var i=(__define,e);return p=i.prototype,p.ReSet=function(){this._scoretxt.text=this._jifen+this._player.integral,this._cointxt.text=this._jinbi+this._player.money},p.Init=function(t){data.GameData.flag==data.GameData.GameFlag_Activity&&(this._jifen="积分: ",this._jinbi="比赛积分: ");var e=new egret.Bitmap(RES.getRes("ui_info_bg"));e.scale9Grid=new egret.Rectangle(35,75,130,60),this.addChild(e),this._player=t;
var i=new egret.TextField;i.textColor=8407059,i.textAlign=egret.HorizontalAlign.LEFT,i.size=24,this.addChild(i),i.x=5,i.y=20,i.width=190,i.text=t.nickname;var n=new egret.TextField;n.textColor=8407059,n.textAlign=egret.HorizontalAlign.LEFT,n.size=24,n.x=25,n.y=70,n.width=170,n.text=this._jifen+t.integral,this._scoretxt=n;var s=new egret.TextField;s.textColor=8407059,s.textAlign=egret.HorizontalAlign.LEFT,s.size=24,s.x=25,s.y=100,s.width=170,s.text=this._jinbi+t.money,this._cointxt=s,data.GameData.flag==data.GameData.GameFlag_Activity?(s.y=70,e.height=120,this.addChild(s)):(this.addChild(n),this.addChild(s))},e}(egret.Sprite);t.PlayerInfo=e,egret.registerClass(e,"scene.PlayerInfo",["IInit"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(){t.call(this),this._contain=null,this._loc=0,this.PlayerTime=25e3,this._bg=null,this._startTime=0,this._alert=!1,this._flashTime=0,this._txt=null}__extends(e,t);var i=(__define,e);return p=i.prototype,p.Init=function(){this._contain=new egret.Sprite,this.addChild(this._contain),this._bg=new egret.Sprite,this._contain.addChild(this._bg);var t=new egret.Bitmap(RES.getRes("ui_clock"));this._bg.addChild(t),t.x=0,t.y=0,this._txt=new egret.TextField,this._txt.text="",this._txt.width=50,this._txt.textColor=16711680,this._contain.addChild(this._txt),this._txt.textAlign=egret.HorizontalAlign.CENTER,this._txt.x=12,this._txt.y=23,this._alert=!1,this._contain.visible=!0},p.SetPoint=function(t,e){1==t?(this.x=60,this.y=250):2==t?(this.x=500,this.y=250):3==t&&(this.x=147,this.y=540),this._loc=t,this.PlayerTime=e,this._startTime=egret.getTimer(),this._alert=!1,this._contain.visible=!0},p.Update=function(){var t=egret.getTimer(),i=t-this._startTime,n=i/this.PlayerTime;n>1&&(n=1);var s=Math.floor((this.PlayerTime-i)/1e3);0>s&&(s=0);var r=""+s;r!=this._txt.text&&(this._txt.text=r),3==this._loc&&(n>.5&&0==this._alert&&this.visible&&(this._alert=!0,SoundMgr.Instance.PlayEffect("alert_mp3")),this._alert&&(0>=s?this._contain.visible=!0:t-this._flashTime>e.FlashDelay&&(this._flashTime=t,this._contain.visible=!this._contain.visible)))},p.Release=function(){this.parent&&this.parent.removeChild(this)},e.FlashDelay=500,e}(egret.Sprite);t.PlayerTime=e,egret.registerClass(e,"scene.PlayerTime",["IInit","IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e,i){void 0===i&&(i=null),t.call(this),this._bg=null,this._top=null,this._topSp=null,this._mask=null,this._progress=0,this.init(e,i)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(t,e){void 0===e&&(e=null),this.touchEnabled=!1,this.touchChildren=!1,e&&(this._bg=new egret.Bitmap(RES.getRes(e)),this.addChild(this._bg)),this._top=new egret.Bitmap(RES.getRes(t)),this._topSp=new egret.Sprite,this._bg&&(this._topSp.x=(this._bg.width-this._top.width)/2,this._topSp.y=(this._bg.height-this._top.height)/2),this.addChild(this._topSp),this._topSp.addChild(this._top),this._mask=new egret.Bitmap(RES.getRes(t)),this._topSp.addChild(this._mask),this._topSp.mask=this._mask,this.setProgress(0)},p.setProgress=function(t){if(!(t>1||0>t)){this._progress=t;var e=this._top.width;this._top.x=-e+t*e}},p.GetProgress=function(){return this._progress},p.Release=function(){this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);t.ProgressBar=e,egret.registerClass(e,"scene.ProgressBar",["IRelease"])}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null),t.call(this),this._clickScale=!0,this._downSp=null,this._downimg=null,this._grayimg=null,this._txt=null,this._downScale=.9,this._offsetX=0,this._offsetY=0,this._bitTxt=null,this._downSp=new egret.Sprite,this._downimg=new egret.Bitmap(RES.getRes(e)),this._grayimg=new egret.Bitmap(RES.getRes(i)),this.addChild(this._downSp),this._downSp.addChild(this._downimg),this._downSp.addChild(this._grayimg),this._offsetX=this._downimg.width*(1-this._downScale)/2,this._offsetY=this._downimg.height*(1-this._downScale)/2,this.touchChildren=!1,this.touchEnabled=!0,this._grayimg.visible=!1;var s=RES.getRes(n);null==s&&(this._txt=new egret.TextField,this._txt.text=n,this._txt.textColor=16777215,this.addChild(this._txt),this._txt.width=this._downSp.width,this._txt.textAlign=egret.HorizontalAlign.CENTER,this._txt.x=(this._downSp.width-this._txt.width)/2,this._txt.y=(this._downSp.height-this._txt.height)/2),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.SetWidthHeight=function(t,e){this._downSp.width=t,this._downSp.height=e,this._grayimg.width=t,this._grayimg.height=e,this._txt.width=this._downSp.width,this._txt.y=(this._downSp.height-this._txt.height)/2},i(p,"ClickScale",void 0,function(t){this._clickScale=t}),p.ChangeTxt=function(t){this._txt.text=t,this._txt.x=(this._downSp.width-this._txt.width)/2,this._txt.y=(this._downSp.height-this._txt.height)/2},p.SetBitTxt=function(t){null==this._bitTxt&&(this._bitTxt=new egret.BitmapText,this._bitTxt.font=RES.getRes("timefont_fnt"),this._bitTxt.scaleX=this._bitTxt.scaleY=.5,this._downSp.addChild(this._bitTxt)),this._bitTxt.text=t,this._bitTxt.x=this._downSp.width-.5*this._bitTxt.textWidth-15,this._bitTxt.y=this._downSp.height-.5*this._bitTxt.textHeight-10},p.SetBit=function(t,e){void 0===e&&(e=null),this._downimg.texture=RES.getRes(t),this._grayimg.texture=RES.getRes(e)},p.SetTxt=function(t,e,i,n,s){void 0===t&&(t=30),void 0===e&&(e=16777215),void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=null),this._txt.size=t,this._txt.textColor=e,i&&(this._txt.width=i),this._txt.x=(this._downSp.width-this._txt.width)/2,this._txt.y=(this._downSp.height-this._txt.height)/2},p.onBegin=function(){this._clickScale&&(this._downSp.scaleX=this._downSp.scaleY=this._downScale,this._grayimg.scaleX=this._grayimg.scaleY=this._downScale,this._downSp.x+=this._offsetX,this._downSp.y+=this._offsetY,this._grayimg.x+=this._offsetX,this._grayimg.y+=this._offsetY),SoundMgr.Instance.PlayEffect("btn_click_mp3")},p.onEnd=function(){this._downSp.scaleX=this._downSp.scaleY=1,this._grayimg.scaleX=this._grayimg.scaleY=this._downScale,this._downSp.x=0,this._downSp.y=0,this._grayimg.x=0,this._grayimg.y=0},p.init=function(){},e}(egret.Sprite);t.SButton=e,egret.registerClass(e,"scene.SButton")}(scene||(scene={}));var scene;!function(t){var e=function(t){function e(e,i,n){t.call(this),this._downimg=null,this._upimg=null,this._isselect=!0,this._downimg=new egret.Bitmap(RES.getRes(i)),this._upimg=new egret.Bitmap(RES.getRes(e)),this._callback=n,this.addChild(this._downimg),this.addChild(this._upimg),this.touchChildren=!1,this.touchEnabled=!0,this._upimg.visible=!1,this._isselect=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onTap=function(){this.SetSelect(!this._isselect)},p.SetSelect=function(t){this._isselect=t,this._upimg.visible=!this._isselect,SoundMgr.Instance.PlayEffect("btn_click_mp3"),this._callback(this._isselect)},e}(egret.Sprite);t.SRadio=e,egret.registerClass(e,"scene.SRadio")}(scene||(scene={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._infoSprite=null,this._btn_continue=null,this._whowintxt=null,this._isactover=!1,this._btn_exit=null,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),i(p,"IsActOver",function(){return this._isactover}),p.createView=function(){var t=new egret.Bitmap(RES.getRes("ui_window_bg"));t.scale9Grid=new egret.Rectangle(45,135,440,20),this.addChild(t),t.height=550,t.touchEnabled=!0,t.x=55,t.y=290;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=450;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=530;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=610;var e=new egret.TextField;e.x=105,e.y=460,e.size=28,e.textColor=16777215,e.text="当前活动排名",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=105,e.y=540,e.size=28,e.textColor=16777215,e.text="当前活动积分",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=105,e.y=620,e.size=28,e.textColor=16777215,e.text="本次活动最高积分",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=67,e.y=310,e.size=28,e.width=505,e.textColor=11129325,e.text="结算",e.textAlign=egret.HorizontalAlign.CENTER,this.addChild(e),this._whowintxt=new egret.TextField,this._whowintxt.x=67,this._whowintxt.y=378,this._whowintxt.size=32,this._whowintxt.width=505,this._whowintxt.textColor=16777215,this._whowintxt.text="活动结束",this._whowintxt.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._whowintxt),this._btn_exit=new scene.SButton("btn_common3",null,"退出游戏"),this.addChild(this._btn_exit),this._btn_exit.x=78,this._btn_exit.y=700,this._btn_exit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},p.onTouchTap=function(t){t.currentTarget==this._btn_exit&&NativeMgr.Instance.ExitWindow()},p.InitInfo=function(t,e,i,n){this._isactover=t,null==this._infoSprite&&(this._infoSprite=new egret.Sprite,this.addChild(this._infoSprite)),this._infoSprite.removeChildren(),this._whowintxt.text="活动结束";var s=new egret.TextField;s.x=360,s.y=460,s.width=190,s.size=28,s.textColor=14922329,s.text="NO."+e,s.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(s);var s=new egret.TextField;s.x=360,s.y=540,s.width=190,s.size=28,s.textColor=14922329,s.text=""+n,s.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(s);var s=new egret.TextField;s.x=360,s.y=620,s.width=190,s.size=28,s.textColor=14922329,s.text=""+i,s.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(s)},p.Show=function(){t.prototype.Show.call(this),LayerMgr.Window.addChild(this)},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},e._instance=null,e}(t.WindowsBase);t.ActivityOverInst=e,egret.registerClass(e,"windowui.ActivityOverInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._infoSprite=null,this._btn_continue=null,this._whowintxt=null,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.createView=function(){var t=new egret.Bitmap(RES.getRes("ui_window_bg"));t.scale9Grid=new egret.Rectangle(45,135,440,20),this.addChild(t),t.height=800,t.touchEnabled=!0,t.x=55,t.y=140;var t=new egret.Bitmap(RES.getRes("ui_window_item1"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=505,t.height=110,t.touchEnabled=!0,t.x=67,t.y=290;var t=new egret.Bitmap(RES.getRes("ui_window_item1"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=505,t.height=110,t.touchEnabled=!0,t.x=67,t.y=410;var t=new egret.Bitmap(RES.getRes("ui_window_item1"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=505,t.height=110,t.touchEnabled=!0,t.x=67,t.y=530;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=660;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=740;var t=new egret.Bitmap(RES.getRes("ui_window_item2"));t.scale9Grid=new egret.Rectangle(14,14,3,28),this.addChild(t),t.width=505,t.touchEnabled=!0,t.x=67,t.y=820;var e=new egret.TextField;e.x=105,e.y=670,e.size=28,e.textColor=16777215,e.text="当前活动排名",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=105,e.y=750,e.size=28,e.textColor=16777215,e.text="当前活动积分",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=105,e.y=830,e.size=28,e.textColor=16777215,e.text="本次活动最高积分",e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e);var e=new egret.TextField;e.x=67,e.y=160,e.size=28,e.width=505,e.textColor=11129325,e.text="结算",e.textAlign=egret.HorizontalAlign.CENTER,this.addChild(e),this._whowintxt=new egret.TextField,this._whowintxt.x=67,this._whowintxt.y=228,this._whowintxt.size=32,this._whowintxt.width=505,this._whowintxt.textColor=16777215,this._whowintxt.text="地主胜",this._whowintxt.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._whowintxt),this._bgshap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},p.InitInfo=function(t,e,i,n,s,r,a){if(null==this._infoSprite&&(this._infoSprite=new egret.Sprite,this.addChild(this._infoSprite)),this._infoSprite.removeChildren(),t){var h=new scene.PlayerHead;h.Init(t),h.x=88,h.y=310,h.Ready=!1,h.touchEnabled=!1,h.touchChildren=!1,this._infoSprite.addChild(h);var l=new egret.TextField;l.x=203,l.y=310,l.size=28,l.textColor=16771905,l.text=t?t.nickname:"",l.textAlign=egret.HorizontalAlign.CENTER,this._infoSprite.addChild(l),t.money+t.ResoultScore<=0&&(l.textColor=11184810);var o=15427409;o=t.ResoultScore<0?15427409:7458924;var l=new egret.TextField;l.x=340,l.y=340,l.size=32,l.textColor=16771905,l.text=""+t.ResoultScore,l.width=200,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l),t.money+t.ResoultScore<=0&&(l.textColor=11184810,l.textFlow=(new egret.HtmlTextParser).parser(l.text+"<font color='0xff0000'>(已淘汰)</font>"))}if(e){var _=new scene.PlayerHead;_.Init(e),_.x=88,_.y=430,_.Ready=!1,_.touchEnabled=!1,_.touchChildren=!1,this._infoSprite.addChild(_);var l=new egret.TextField;l.x=203,l.y=430,l.size=28,l.textColor=7458924,l.text=e?e.nickname:"",l.textAlign=egret.HorizontalAlign.CENTER,this._infoSprite.addChild(l),e.money+e.ResoultScore<=0&&(l.textColor=11184810);var o=15427409;o=e.ResoultScore<0?15427409:7458924;var l=new egret.TextField;l.x=340,l.y=450,l.size=32,l.textColor=7458924,l.text=""+(e?e.ResoultScore:""),l.width=200,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l),e.money+e.ResoultScore<=0&&(l.textColor=11184810,l.textFlow=(new egret.HtmlTextParser).parser(l.text+"<font color='0xff0000'>(已淘汰)</font>"))}if(i){var d=new scene.PlayerHead;d.Init(i),d.x=88,d.y=550,d.Ready=!1,d.touchEnabled=!1,d.touchChildren=!1,this._infoSprite.addChild(d);var l=new egret.TextField;l.x=203,l.y=550,l.size=28,l.textColor=7458924,l.text=i?i.nickname:"",l.textAlign=egret.HorizontalAlign.CENTER,this._infoSprite.addChild(l),i.money+i.ResoultScore<=0&&(l.textColor=11184810);var o=15427409;o=i.ResoultScore<0?15427409:7458924;var l=new egret.TextField;l.x=340,l.y=570,l.size=32,l.textColor=7458924,l.text=""+(i?i.ResoultScore:""),l.width=200,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l),i.money+i.ResoultScore<=0&&(l.textColor=11184810,l.textFlow=(new egret.HtmlTextParser).parser(l.text+"<font color='0xff0000'>(已淘汰)</font>"))}this._whowintxt.text=n?"地主胜":"农民胜";var l=new egret.TextField;l.x=360,l.y=670,l.width=190,l.size=28,l.textColor=14922329,l.text="NO."+s,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l);var l=new egret.TextField;l.x=360,l.y=750,l.width=190,l.size=28,l.textColor=14922329,l.text=""+a,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l);var l=new egret.TextField;l.x=360,l.y=830,l.width=190,l.size=28,l.textColor=14922329,l.text=""+r,l.textAlign=egret.HorizontalAlign.RIGHT,this._infoSprite.addChild(l)},p.onTouchTap=function(t){t.currentTarget==this._bgshap?(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide()):t.currentTarget==this._btn_continue&&(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide())},p.Show=function(){t.prototype.Show.call(this),LayerMgr.Window.addChild(this),egret.setTimeout(function(){this.IsShow&&(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide())},this,1e4)},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},e._instance=null,e}(t.WindowsBase);t.ActivityResoultInst=e,egret.registerClass(e,"windowui.ActivityResoultInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._titleBitmap=null,this._btn_continue1=null,this._btn_continue2=null,this._btn_continue3=null,this._btn_continue4=null,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.createView=function(){var t=new egret.Bitmap(RES.getRes("ui_tips_bg"));t.scale9Grid=new egret.Rectangle(50,20,20,15),this.addChild(t),t.width=450,t.height=475,t.touchEnabled=!0,t.x=100,t.y=350;var t=new egret.Bitmap(RES.getRes("title_charge"));this.addChild(t),t.x=125,t.y=310,this._titleBitmap=t;var t=new egret.Bitmap(RES.getRes("ui_panel_bg"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=380,t.height=390,t.x=130,t.y=405;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=230,t.height=35,t.x=140,t.y=447;var e=new egret.TextField;e.x=150,e.y=454,e.size=24,e.textColor=16724736,e.text="100金币(1元)",e.width=200,e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e),this._btn_continue1=new scene.SButton("btn_queding",null,""),this.addChild(this._btn_continue1),this._btn_continue1.x=375,this._btn_continue1.y=435;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=230,t.height=35,t.touchEnabled=!0,t.x=140,t.y=533;var e=new egret.TextField;e.x=150,e.y=540,e.size=24,e.textColor=16724736,e.text="600金币(5元)",e.width=200,e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e),this._btn_continue2=new scene.SButton("btn_queding",null,""),this.addChild(this._btn_continue2),this._btn_continue2.x=375,this._btn_continue2.y=520;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=230,t.height=35,t.touchEnabled=!0,t.x=140,t.y=618;var e=new egret.TextField;e.x=150,e.y=625,e.size=24,e.textColor=16724736,e.text="1350金币(10元)",e.width=200,e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e),this._btn_continue3=new scene.SButton("btn_queding",null,""),this.addChild(this._btn_continue3),this._btn_continue3.x=374,this._btn_continue3.y=605;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=230,t.height=35,t.touchEnabled=!0,t.x=140,t.y=703;var e=new egret.TextField;e.x=150,e.y=710,e.size=24,e.textColor=16724736,e.text="3000金币(20元)",e.width=200,e.textAlign=egret.HorizontalAlign.LEFT,this.addChild(e),this._btn_continue4=new scene.SButton("btn_queding",null,""),this.addChild(this._btn_continue4),this._btn_continue4.x=375,this._btn_continue4.y=690,this._btn_continue1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._btn_continue2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._btn_continue3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._btn_continue4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._bgshap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},p.onTouchTap=function(t){var e=0;if(t.currentTarget==this._bgshap?this.Hide():t.currentTarget==this._btn_continue1?e=100:t.currentTarget==this._btn_continue2?e=600:t.currentTarget==this._btn_continue3?e=1350:t.currentTarget==this._btn_continue4&&(e=3e3),0!=e){var i={goodsId:""+e,goodsNumber:"1",serverId:"1",ext:"xx"};nest.iap.pay(i,function(t){trace(0==t.result?"charge sucess":-1==t.result?"charge cancel":"charge error")})}},p.Show=function(){t.prototype.Show.call(this),LayerMgr.Window.addChild(this)},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},e._instance=null,e}(t.WindowsBase);t.ChargeInst=e,egret.registerClass(e,"windowui.ChargeInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(e){function i(){e.call(this),this._tabSprite_1=null,this._tabSprite_2=null,this._tab=0,this._faceList=["ani_chat_1","ani_chat_2","ani_chat_3","ani_chat_4","ani_chat_5","ani_chat_6","ani_chat_7","ani_chat_8","ani_chat_9"],this._txtInput=null,this._btnSend=null,this.createView()}__extends(i,e);var n=__define,s=i;return p=s.prototype,n(i,"Instance",function(){return null==i._instance&&(i._instance=new i),i._instance}),p.createView=function(){this._tab=0;var e=new egret.Bitmap(RES.getRes("panel_chat"));this.addChild(e),e.touchEnabled=!0,e.x=0,e.y=455,this._txtInput=new egret.TextField,this._txtInput.type=egret.TextFieldType.INPUT,this._txtInput.width=380,this._txtInput.height=35,this._txtInput.x=5,this._txtInput.y=997,this._txtInput.size=30,this._txtInput.textColor=16777215,this._txtInput.maxChars=30,this._txtInput.text="点击输入文字",this._txtInput.type,this.addChild(this._txtInput),this._btnSend=new scene.SButton("btn_fasong"),this._btnSend.x=385,this._btnSend.y=985,this.addChild(this._btnSend),this._btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._bgshap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._txtInput.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusin,this),this.setWordUI(),this.setGifUI(),this.setTab(2);var i=this;document.onkeydown=function(e){var n=e||window.event||arguments.callee.caller.arguments[0];if(n&&13==n.keyCode){if(0==i.IsShow||null==i._txtInput||""==i._txtInput.text)return;NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SENDCHAT,{chatStr:i._txtInput.text}),t.ChatInst.Instance.Hide()}}},p.setTab=function(t){this._tab!=t&&(this._tab=t,1==this._tab?(this._tabSprite_1.visible=!0,this._tabSprite_2.visible=!1):2==this._tab&&(this._tabSprite_1.visible=!1,this._tabSprite_2.visible=!0))},p.SetWords=function(t){""!=t&&null!=t&&"点击输入文字"!=t&&(this._txtInput.text=t)},p.setWordUI=function(){var t=new egret.Sprite,e=i.WordList.length,n=0;for(n=0;e>n;n++){var s=new render.ChatWordsRender({id:n,txt:i.WordList[n]});s.y=n*s.height,t.addChild(s)}this._tabSprite_1=new egret.ScrollView(t),this._tabSprite_1.width=465,this._tabSprite_1.height=465,this._tabSprite_1.horizontalScrollPolicy="off",this._tabSprite_1.x=16,this._tabSprite_1.y=485,this.addChild(this._tabSprite_1),this._tabSprite_1.visible=!1},p.setGifUI=function(){var t=new egret.Sprite,e=this._faceList.length,i=0;for(i=0;e>i;i+=3){var n=new render.ChatFaceRender(this._faceList[i],this._faceList[i+1],this._faceList[i+2]);n.y=50*i,t.addChild(n)}this._tabSprite_2=new egret.ScrollView(t),this._tabSprite_2.width=465,this._tabSprite_2.height=465,this._tabSprite_2.horizontalScrollPolicy="off",this._tabSprite_2.x=16,this._tabSprite_2.y=510,this.addChild(this._tabSprite_2),this._tabSprite_2.visible=!1},p.onFocusin=function(){"点击输入文字"==this._txtInput.text&&(this._txtInput.text="")},p.onTouchTap=function(t){if(t.currentTarget==this._btnSend){var e=this._txtInput.text;if(""==e||null==e||"点击输入文字"==e)return void this.Hide();NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_GAME_SENDCHAT,{chatStr:e}),this.Hide()}else t.currentTarget==this._bgshap?this.Hide():t.currentTarget==this._tabBtn_1?(this.setTab(1),this._tabBtn_1.SetTxt(28,11129325),this._tabBtn_2.SetTxt(28,22145)):t.currentTarget==this._tabBtn_2&&(this.setTab(2),this._tabBtn_1.SetTxt(28,22145),this._tabBtn_2.SetTxt(28,11129325))},p.Show=function(){data.GameData.IsRobot_Offline||(e.prototype.Show.call(this),LayerMgr.Window.addChild(this),this._txtInput.text="点击输入文字")},p.Hide=function(){e.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},i.WordList=["大家好,很高兴见到各位!","快点吧,我等的花都谢了!","炸你!","和你合作真是太愉快了!","你是MM还是GG啊!"],i._instance=null,i}(t.WindowsBase);t.ChatInst=e,egret.registerClass(e,"windowui.ChatInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._iscreat=!1,this._okfun=null,this._okObj=null,this._txtInput=null,this._okBtn=null,this._btn_close=null,this._bg=null,this.touchChildren=!0,this.touchEnabled=!0}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.createView=function(){if(!this._iscreat){var t=RES.getRes("ui_tips_bg");this._bg=new egret.Bitmap(t),this._bg.scale9Grid=new egret.Rectangle(50,20,20,15),this.addChild(this._bg),this._bg.width=480,this._bg.height=250,this._bg.x=90,this._bg.y=440,this._btn_close=new scene.SButton("btn_close"),this._btn_close.x=515,this._btn_close.y=400,this.addChild(this._btn_close);var t=RES.getRes("ui_panel_txt"),e=new egret.Bitmap(t);e.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(e),e.width=400,e.height=35,e.x=130,e.y=488,this._txtInput=new egret.TextField,this._txtInput.type=egret.TextFieldType.INPUT,this._txtInput.width=390,this._txtInput.height=35,this._txtInput.x=135,this._txtInput.y=490,this._txtInput.size=30,this._txtInput.textColor=11159857,this._txtInput.maxChars=20,this._txtInput.text="请输入要创建或加入的房间名",this.addChild(this._txtInput);var t=RES.getRes("title3"),e=new egret.Bitmap(t);this.addChild(e),e.x=300,e.y=425,this._okBtn=new scene.SButton("btn_queding_no"),this._okBtn.x=260,this._okBtn.y=600,this.addChild(this._okBtn),this._okBtn.touchEnabled=!1,this._btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this._txtInput.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusin,this),this._txtInput.addEventListener(egret.TextEvent.CHANGE,this.onChange,this),this._iscreat=!0}},p.onChange=function(){"请输入要创建或加入的房间名"==this._txtInput.text||""==this._txtInput.text?(this._okBtn.SetBit("btn_queding_no"),this._okBtn.touchEnabled=!1):(this._okBtn.SetBit("btn_queding"),this._okBtn.touchEnabled=!0)},p.onFocusin=function(){"请输入要创建或加入的房间名"==this._txtInput.text&&(this._txtInput.text="")},p.Show=function(){t.prototype.Show.call(this),this.createView(),LayerMgr.TopWindow.addChild(this)},p.onTap=function(t){if(t.target==this._okBtn){if(""==this._txtInput.text||"请输入要创建或加入的房间名"==this._txtInput.text||this._txtInput.text.length>20)return this._okBtn.SetBit("btn_queding_no"),void(this._okBtn.touchEnabled=!1);data.GameData.flag=data.GameData.GameFlag_Group,NetMgr.Instance.SendMsg(enums.NetEnum.CLIENT_2_CENTER_REQ_BATTLE,{flagId:data.GameData.GameFlag_Group,groupId:this._txtInput.text}),SceneMgr.Instance.ShowScene(scene.GameScene)}else t.target==this._btn_close&&this.Hide()},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),e._instance=null,e}(t.WindowsBase);t.CreatRoomInst=e,egret.registerClass(e,"windowui.CreatRoomInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._progress=null,this._mask=new egret.Sprite,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=Config.StageHeight/2-15,this.textField.width=640,this.textField.height=100,this.textField.textAlign="center"},p.Show=function(){LoadMgr.Instance.addEventListener(LoadMgr.LOAD_PROGRESS,this.setProgress,this),LayerMgr.TopWindow.addChild(this)},p.Hide=function(){LoadMgr.Instance.removeEventListener(LoadMgr.LOAD_PROGRESS,this.setProgress,this),this.parent&&this.parent.removeChild(this)},i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.setSkin=function(){this.removeChildren();var t=new egret.Bitmap(RES.getRes("bg_loading_jpg"));this.addChild(t),this._progress=new scene.ProgressBar("ui_loading_top"),this.addChild(this._progress),this._progress.x=87,this._progress.y=969,this._progress.setProgress(0),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=974,this.textField.size=18,this.textField.width=640,this.textField.textAlign="center",this.textField.stroke=2,this.textField.strokeColor=1250067},p.onTap=function(){},p.SetText=function(t){this.textField.text=t},p.setProgress=function(){var t=LoadMgr.Instance.ItemsLoaded/LoadMgr.Instance.ItemsTotal;0>t&&(t=0),t>1&&(t=1);var e=Math.ceil(100*t);this.textField.text=e+"%",this._progress&&this._progress.setProgress(t)},e._instance=null,e}(t.WindowsBase);t.LoadingInst=e,egret.registerClass(e,"windowui.LoadingInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._titleBitmap=null,this._infoSprite=null,this._btn_continue=null,this._whowintxt=null,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.createView=function(){var t=new egret.Bitmap(RES.getRes("ui_tips_bg"));t.scale9Grid=new egret.Rectangle(50,20,20,15),this.addChild(t),t.width=450,t.height=475,t.touchEnabled=!0,t.x=100,t.y=350;var t=new egret.Bitmap(RES.getRes("title_win"));this.addChild(t),t.x=125,t.y=310,this._titleBitmap=t;var t=new egret.Bitmap(RES.getRes("ui_panel_bg"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=380,t.height=270,t.x=130,t.y=405;var t=new egret.Bitmap(RES.getRes("ui_panel_bg"));t.scale9Grid=new egret.Rectangle(16,14,8,2),this.addChild(t),t.width=380,t.height=80,t.x=130,t.y=675;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=285,t.height=35,t.x=210,t.y=447;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=285,t.height=35,t.touchEnabled=!0,t.x=210,t.y=533;var t=new egret.Bitmap(RES.getRes("ui_panel_txt"));t.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(t),t.width=285,t.height=35,t.touchEnabled=!0,t.x=210,t.y=618,this._btn_continue=new scene.SButton("btn_queding",null,""),this.addChild(this._btn_continue),this._btn_continue.x=260,this._btn_continue.y=750,this._btn_continue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._bgshap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},p.InitInfo=function(t,e,i,n){if(null==this._infoSprite&&(this._infoSprite=new egret.Sprite,this.addChild(this._infoSprite)),this._infoSprite.removeChildren(),t){var s=new scene.PlayerHeadFrame;s.Init(t.avatar),s.x=142,s.y=416,s.touchEnabled=!1,s.touchChildren=!1,s.scaleX=s.scaleY=.65,this._infoSprite.addChild(s);var r=new egret.TextField;r.x=210,r.y=415,r.size=28,r.textColor=11159086,r.text=t.nickname,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r);var a=11159086,h="";t.ResoultScore<0?(a=6723840,h="失败-"):(a=16724736,h="胜利+");var r=new egret.TextField;r.x=215,r.y=454,r.size=24,r.textColor=a,r.text=h+""+Math.abs(t.ResoultScore),r.width=140,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r)}if(e){var l=new scene.PlayerHeadFrame;l.Init(e.avatar),l.x=142,l.y=501,l.touchEnabled=!1,l.touchChildren=!1,l.scaleX=l.scaleY=.65,this._infoSprite.addChild(l);var r=new egret.TextField;r.x=210,r.y=500,r.size=28,r.textColor=11159086,r.text=e.nickname,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r);var a=11159086,h="";e.ResoultScore<0?(a=6723840,h="失败-"):(a=16724736,h="胜利+");var r=new egret.TextField;r.x=215,r.y=539,r.size=24,r.textColor=a,r.text=h+""+Math.abs(e.ResoultScore),r.width=140,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r)}if(i){var o=new scene.PlayerHeadFrame;o.Init(i.avatar),o.x=142,o.y=588,o.touchEnabled=!1,o.touchChildren=!1,o.scaleX=o.scaleY=.65,this._infoSprite.addChild(o);var r=new egret.TextField;r.x=210,r.y=590,r.size=28,r.textColor=11159086,r.text=i.nickname,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r);var a=11159086,h="";i.ResoultScore<0?(a=6723840,h="失败-"):(a=16724736,h="胜利+");
var r=new egret.TextField;r.x=215,r.y=624,r.size=24,r.textColor=a,r.text=h+""+Math.abs(i.ResoultScore),r.width=140,r.textAlign=egret.HorizontalAlign.LEFT,this._infoSprite.addChild(r)}this._titleBitmap.texture=RES.getRes(n?"title_win":"title_lose")},p.onTouchTap=function(t){t.currentTarget==this._bgshap?(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide()):t.currentTarget==this._btn_continue&&(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide())},p.Show=function(){t.prototype.Show.call(this),LayerMgr.Window.addChild(this),egret.setTimeout(function(){this.IsShow&&(SceneMgr.Instance.GetCurrentScene().ReStart(),this.Hide())},this,1e4)},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},e._instance=null,e}(t.WindowsBase);t.ResoultInst=e,egret.registerClass(e,"windowui.ResoultInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._btn_close=null,this._bg=null,this._yinxiao=null,this._yinyue=null,this.createView()}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.createView=function(){var t=RES.getRes("ui_tips_bg");this._bg=new egret.Bitmap(t),this._bg.scale9Grid=new egret.Rectangle(50,20,20,15),this.addChild(this._bg),this._bg.width=450,this._bg.height=362,this._bg.x=100,this._bg.y=418;var t=RES.getRes("title2"),e=new egret.Bitmap(t);this.addChild(e),e.x=270,e.y=395;var t=RES.getRes("ui_set_yinxiao"),e=new egret.Bitmap(t);this.addChild(e),e.x=142,e.y=495;var t=RES.getRes("ui_set_yinyue"),e=new egret.Bitmap(t);this.addChild(e),e.x=332,e.y=495,this._yinxiao=new scene.SRadio("radio_prompt_up","radio_prompt_down",function(t){SoundMgr.Instance.SetEffectVolume(t?.5:0)}),this._yinxiao.SetSelect(0!=SoundMgr.Instance.SoundVolume),this.addChild(this._yinxiao),this._yinxiao.x=231,this._yinxiao.y=497,this._yinyue=new scene.SRadio("radio_prompt_up","radio_prompt_down",function(t){SoundMgr.Instance.SetSoundVolume(t?.5:0)}),this._yinyue.SetSelect(0!=SoundMgr.Instance.EffectVolume),this.addChild(this._yinyue),this._yinyue.x=417,this._yinyue.y=497,this._btn_close=new scene.SButton("btn_close"),this._btn_close.x=495,this._btn_close.y=385,this.addChild(this._btn_close),this._btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._bgshap.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},p.onTouchTap=function(t){t.currentTarget==this._bgshap?this.Hide():t.currentTarget==this._btn_close&&this.Hide()},p.Show=function(){LayerMgr.SysTip.addChild(this)},p.Hide=function(){this.parent&&this.parent.removeChild(this)},e._instance=null,e}(t.WindowsBase);t.SettingInst=e,egret.registerClass(e,"windowui.SettingInst")}(windowui||(windowui={}));var windowui;!function(t){var e=function(t){function e(){t.call(this),this._iscreat=!1,this._okfun=null,this._okObj=null,this._txt=null,this._okBtn=null,this._bg=null,this.touchChildren=!0,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this)}__extends(e,t);var i=__define,n=e;return p=n.prototype,p.createView=function(){if(!this._iscreat){var t=RES.getRes("ui_tips_bg");this._bg=new egret.Bitmap(t),this._bg.scale9Grid=new egret.Rectangle(50,20,20,15),this.addChild(this._bg),this._bg.width=438,this._bg.height=285,this._bg.x=115,this._bg.y=440;var t=RES.getRes("ui_panel_txt"),e=new egret.Bitmap(t);e.scale9Grid=new egret.Rectangle(13,16,6,7),this.addChild(e),e.width=285,e.height=160,e.x=224,e.y=488,this._txt=new egret.TextField,this._txt.text="",this._txt.textColor=11159086,this.addChild(this._txt),this._txt.width=265,this._txt.height=143,this._txt.textAlign=egret.HorizontalAlign.LEFT,this._txt.x=235,this._txt.y=495;var t=RES.getRes("title1"),e=new egret.Bitmap(t);this.addChild(e),e.x=300,e.y=425;var t=RES.getRes("ui_role1"),e=new egret.Bitmap(t);this.addChild(e),e.x=31,e.y=470,this._okBtn=new scene.SButton("btn_queding"),this._okBtn.x=285,this._okBtn.y=650,this.addChild(this._okBtn),this._iscreat=!0}},p.Show=function(e,i,n,s,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!1),void 0===r&&(r="确定"),t.prototype.Show.call(this),this.createView(),this._txt&&(this._txt.textFlow=(new egret.HtmlTextParser).parser(e)),LayerMgr.TopWindow.addChild(this),this._okBtn.visible=s?!0:!1,this._okfun=i,this._okObj=n},p.onTap=function(t){return this._okBtn.visible&&t.target==this._okBtn?void(this._okfun&&(this._okObj?this._okfun.call(this._okObj):this._okfun())):void(0==this._okBtn.visible&&this._okfun&&(this._okObj?this._okfun.call(this._okObj):this._okfun()))},p.getText=function(){return this._txt?this._txt.text:""},p.Hide=function(){t.prototype.Hide.call(this),this.parent&&this.parent.removeChild(this)},i(e,"Instance",function(){return null==e._instance&&(e._instance=new e),e._instance}),p.setSkin=function(){},e._instance=null,e}(t.WindowsBase);t.SysTipsInst=e,egret.registerClass(e,"windowui.SysTipsInst")}(windowui||(windowui={}));var ThemeAdapter=function(){function t(){}var e=(__define,t);return p=e.prototype,p.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["egret.gui.IThemeAdapter"]);var ArrayTools=function(){function t(){}var e=(__define,t);return p=e.prototype,t.RandomSort=function(t){t.sort(function(){return Math.random()-.5})},t.Sort=function(t){t.sort(function(t,e){return t-e})},t}();egret.registerClass(ArrayTools,"ArrayTools");var DateTimeTool=function(){function t(){}var e=(__define,t);return p=e.prototype,t.GetDateString=function(t){{var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),r=e.getHours(),a=e.getMinutes();e.getSeconds()}return i+"-"+n+"-"+s+" "+r+":"+a},t.GetMinString=function(t){var e=Math.floor(t/1e3/60),i=Math.floor(t/1e3)%60,n=""+e,s=""+i;return 10>e&&(n="0"+e),10>i&&(s="0"+i),n+":"+s},t}();egret.registerClass(DateTimeTool,"DateTimeTool");var MandPool=function(){function t(){}var e=(__define,t);return p=e.prototype,t.getInsByParm=function(t,e){if(null!=t){var i=egret.getQualifiedClassName(t),n=this.s_dict[i];if(null==n&&(n=[],this.s_dict[i]=n),n.length>0){var s=0,r=n.length;for(s=r-1;s>=0;s--){var a=n[s];if(a&&a.paramflag==e)return n.splice(s,1),a}}var h=new t(e);return h.paramflag=e,h}return null},t.getIns=function(t,e){if(void 0===e&&(e=null),null!=t){var i=egret.getQualifiedClassName(t),n=this.s_dict[i];if(null==n&&(n=[],this.s_dict[i]=n),n.length>0){var s=n.pop();return s.onCheckout&&s.onCheckout(),s}var r=new t(e);return r.paramflag=e,r}return null},t.remand=function(t){if(null!=t){var e=egret.getQualifiedClassName(t),i=this.s_dict[e];null!=i&&(i.push(t),t.onRemand&&t.onRemand())}},t.getCount=function(t){var e=this.s_dict[t];return null!=e?e.length:0},t.s_dict={},t}();egret.registerClass(MandPool,"MandPool");var math;!function(t){var e=function(){function t(t,e){this._x=t,this._y=e}var e=__define,i=t;return p=i.prototype,p.clone=function(){return new t(this._x,this._y)},p.zero=function(){return this._x=0,this._y=0,this},p.isZero=function(){return 0==this._x&&0==this._y},e(p,"angle",function(){return Math.atan2(this._y,this._x)},function(t){var e=length;this._x=Math.cos(t)*e,this._y=Math.sin(t)*e}),e(p,"rotation",function(){var t=Math.atan2(this._y,this._x);return t/Math.PI*180}),e(p,"length",function(){return Math.sqrt(this.lengthSQ)},function(t){var e=this.angle;this._x=Math.cos(e)*t,this._y=Math.sin(e)*t}),e(p,"lengthSQ",function(){return this._x*this._x+this._y*this._y}),p.normalize=function(){if(0==length)return this._x=1,this;var t=length;return this._x/=t,this._y/=t,this},p.truncate=function(t){return length=Math.min(t,length),this},p.reverse=function(){return this._x=-this._x,this._y=-this._y,this},p.isNormalized=function(){return 1==length},p.dotProd=function(t){return this._x*t.x+this._y*t.y},p.crossProd=function(t){return this._x*t.y-this._y*t.x==0},t.angleBetween=function(t,e){return t.isNormalized()||(t=t.clone().normalize()),e.isNormalized()||(e=e.clone().normalize()),Math.acos(t.dotProd(e))},p.sign=function(t){return this.perp.dotProd(t)<0?-1:1},e(p,"perp",function(){return new t(-this.y,this.x)}),p.dist=function(t){return Math.sqrt(this.distSQ(t))},p.distSQ=function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},p.add=function(e){return new t(this._x+e.x,this._y+e.y)},p.subtract=function(e){return new t(this._x-e.x,this.y-e.y)},p.multiply=function(e){return new t(this._x*e,this._y*e)},p.divide=function(e){return new t(this._x/e,this._y/e)},p.equals=function(t){return this._x==t.x&&this._y==t.y},t.gravityVector=function(){return null==this._gravityVector&&(this._gravityVector=new t(0,9.8)),this._gravityVector},e(p,"x",function(){return this._x},function(t){this._x=t}),e(p,"y",function(){return this._y},function(t){this._y=t}),t._gravityVector=null,t}();t.Vector2D=e,egret.registerClass(e,"math.Vector2D")}(math||(math={}));var ViewTools=function(){function t(){}var e=(__define,t);return p=e.prototype,t.ASCLength=function(t){for(var e=t.length,i=0,n=0,s=0;e>s;s++){var r=t.charCodeAt(s);r>31&&127>r?n+=1:i+=1}return i+Math.ceil(n/2)},t.ReduceStr=function(t,e){for(var i=t.length,n=0,s=0,r=0;i>r;r++){var a=t.charCodeAt(r);a>31&&127>a?s+=1:n+=1;var h=n+Math.ceil(s/2);if(h>e)return t.slice(0,r)}return t},t.shake=function(e,i,n,s){if(void 0===i&&(i=2),void 0===n&&(n=3),void 0===s&&(s=32),!t.isShake){t.isShake=!0;var r=new egret.Point(e.x,e.y),a=[0,0],h=0,l=setInterval(function(){a[h%2]=h++%4<2?0:n,h>4*i+1&&(clearInterval(l),h=0,t.isShake=!1),e.x=a[0]+r.x},s)}},t.displayObjectMask=function(t,e,i){var n,s=i||new egret.RenderTexture,r=t.parent;if(t instanceof egret.DisplayObjectContainer);else{n=new egret.DisplayObjectContainer,e.width=t.width,e.height=t.height,n.addChild(t),n.addChild(e),e.blendMode=egret.BlendMode.ERASE;var a=t.x,h=t.y,l=e.x,o=e.y;s.drawToTexture(n,new egret.Rectangle(l,o,e.width,e.height)),s._offsetX=-a+l,s._offsetY=-h+o,r&&r.addChild(t),e.blendMode=egret.BlendMode.NORMAL,n==e.parent&&n.removeChild(e)}return s},t.isShake=!1,t}();egret.registerClass(ViewTools,"ViewTools");